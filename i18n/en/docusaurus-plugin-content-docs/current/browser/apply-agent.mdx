---
id: apply-agent
title: Application of the browser agent
description: Apply the WhaTap browser agent to your web application and start the browser monitoring.
keywords:
  - Browser Monitoring
  - Agent
---

import TR from '@site/src/components/TR';

To use the WhaTap monitoring service, after [Sign up](https://www.whatap.io/en/signup/), create a project and then apply the WhaTap browser agent to web applications.

See the following video guide.

<Youtube ko='gZ5A40G2u2A' en='z0-WMAEQo30' ja='z0-WMAEQo30' />

import Createprojectv2 from "../getting-started/_create-project-v2.mdx";

<Createprojectv2 />

import Accesskey from "../getting-started/_accesskey.mdx";

<Accesskey />

## Installing the WhaTap browser agent

Follow the instructions on the agent installation screen to apply the WhaTap browser agent code to your web application.

<ImgLang img='rum-apply-agent.png' desc='WhaTap Browser Agent Installation' />

### ![](/img/number-01.png) Data collection sampling

The WhaTap browser agent collects data based on the user session. You can set the percentage of all sessions collected from 0 to 100.

### ![](/img/number-02.png) WhaTap browser agent script

The WhaTap browser agent is provided in the form of an inline script. Add the script code provided by the installation guide to the top in the `<head>` tag of any HTML page to monitor.

Select one of the following two methods to apply the agent.

- **_Async_** (Asynchronous Load): Loads the WhaTap browser agent asynchronously in your web application. 

  - It does not affect the load performance of your web application. 

  - There may be missing data such as AJAX or errors that occurred before loading the browser agent.

- **_Sync_** (Synchronous Load): Loads the WhaTap browser agent synchronously in your web application.

  - It is recommended if you want to collect all data when loading your web application. 

  - It may affect the load performance of your web application.

## Setting the WhaTap browser agent's options {#setting-agent}

It sets the options to apply to the WhaTap browser agent. The options can be set in the Config object of the installation script. You can set the project access keys, percentage of all user sessions, resource domains to exclude from collection, and such.

```javascript title='config example' showLineNumbers
config: {
  projectAccessKey: {projec_access_key},
  pcode: {pcode},
  sampleRate: 100,
  ignoreOrigins: [ 'https://ignore-site.com/', /^(https?://)([^/]*)(ignore-site.io)(/)(.*)/i ],
}
```

### Option parameters

<Columns>
<Column className="text--left width--40">

**projectAccessKey** <span class='type'>String</span> <code className="my">required</code>

It is a project access key. You can see in the project installation guide (<Cmdname sid="side_management" className="uitext" /> &gt; <Cmdname sid="side_agentInstall" className="uitext" />). 

</Column>
<Column className="text--left">

```js showLineNumbers {2}
config: {
  projectAccessKey: {projec_access_key},
  pcode: {pcode},
  sampleRate: 100,
  proxyBaseUrl: "https://repo.whatap-browser-agent.io/rum/prod/v1/whatap-browser-agent.js"
}
```

</Column>
</Columns>

<Columns>
<Column className="text--left width--40">

**pcode** <span class='type'>Number</span> <code className="my">required</code>

It is a project access key. You can see in the project installation guide (<Cmdname sid="side_management" className="uitext" /> &gt; <Cmdname sid="side_agentInstall" className="uitext" />). 

</Column>
<Column className="text--left">

```js showLineNumbers {3}
config: {
  projectAccessKey: {projec_access_key},
  pcode: {pcode},
  sampleRate: 100,
  proxyBaseUrl: "https://repo.whatap-browser-agent.io/rum/prod/v1/whatap-browser-agent.js"
}
```

</Column>
</Columns>

<Columns>
<Column className="text--left width--40">

**sampleRate** <span class='type'>Number</span> <code className="my">required</code>

You can set the ratio of user sessions to be collected. You can set it from 0 to 100.

</Column>
<Column className="text--left">

```js showLineNumbers {4}
config: {
  projectAccessKey: {projec_access_key},
  pcode: {pcode},
  sampleRate: 100,
  proxyBaseUrl: "https://repo.whatap-browser-agent.io/rum/prod/v1/whatap-browser-agent.js"
}
```

</Column>
</Columns>

<Columns>
<Column className="text--left width--40">

**proxyBaseUrl** <span class='type'>String</span> <code className="my">required</code>

It is the agent collection data transmission URL.

</Column>
<Column className="text--left">

```js showLineNumbers {5}
config: {
  projectAccessKey: {projec_access_key},
  pcode: {pcode},
  sampleRate: 100,
  proxyBaseUrl: "https://repo.whatap-browser-agent.io/rum/prod/v1/whatap-browser-agent.js"
}
```

</Column>
</Columns>

<Columns>
<Column className="text--left width--40">

**ignorePageUrls** <span class='type'>Array\<string \| RegExp\></span> <code className="my">optional</code>

It is a list of page URLs to exclude from collection. String matching is performed using the `startsWith` method.

</Column>
<Column className="text--left">

```js showLineNumbers {6}
config: {
  projectAccessKey: {projec_access_key},
  pcode: {pcode},
  sampleRate: 100,
  proxyBaseUrl: "https://repo.whatap-browser-agent.io/rum/prod/v1/whatap-browser-agent.js"
  ignorePageUrls: ["https://test.webpage.com/", "http://localhost:2003/page1/", /^.localhost.$/i]
}
```

</Column>
</Columns>

<Columns>
<Column className="text--left width--40">

**ignoreResources** <span class='type'>Array\<string \| RegExp\></span> <code className="my">optional</code>

It is a list of resource URLs to exclude from collection. String matching is performed using the `startsWith` method.

</Column>
<Column className="text--left">

```js showLineNumbers {6}
config: {
  projectAccessKey: {projec_access_key},
  pcode: {pcode},
  sampleRate: 100,
  proxyBaseUrl: "https://repo.whatap-browser-agent.io/rum/prod/v1/whatap-browser-agent.js"
  ignoreResources: ["https://test.web.com/yard/api/flush", "http://localhost:2003/whatap-browser-agent.js",  /^.\/path1\/api.$/i]
}
```

</Column>
</Columns>

<Columns>
<Column className="text--left width--40">

**ignoreErrors** <span class='type'>Array\<string \| RegExp\></span> <code className="my">optional</code>

It is a list of browser errors to exclude from collection. String matching is performed using the `includes` method.

</Column>
<Column className="text--left">

```js showLineNumbers {6}
config: {
  projectAccessKey: {projec_access_key},
  pcode: {pcode},
  sampleRate: 100,
  proxyBaseUrl: "https://repo.whatap-browser-agent.io/rum/prod/v1/whatap-browser-agent.js"
  ignoreErrors: ["cannot read", "cors", "basic"]
}
```

</Column>
</Columns>

<Columns>
<Column className="text--left width--40">

**collectUserClick** <span class='type'>Boolean</span> <code className="my">optional</code>

Default `false`

It can collect user click events. For the method to find the collected data, see [the following](user-session-log-search#click--rapid_click).

</Column>
<Column className="text--left">

```js showLineNumbers {6}
config: {
  projectAccessKey: {projec_access_key},
  pcode: {pcode},
  sampleRate: 100,
  proxyBaseUrl: "https://repo.whatap-browser-agent.io/rum/prod/v1/whatap-browser-agent.js"
  collectUserClick: true
}
```

</Column>
</Columns>

<Columns>
<Column className="text--left width--40">

**sessionReplaySampleRate** <span class='type'>Number</span> <code className="my">optional</code>

Default `0`

It is the ratio of sessions to collect the session replay data. You can set from 0 to 100 for user sessions to collect.

For example, if `sampleRate` is set to **50** and `sessionReplaySampleRate` to **20**, 50% of all sessions are collected, and for only 20% of those sessions, the session replay data is collected.

</Column>
<Column className="text--left">

```js showLineNumbers {6}
config: {
  projectAccessKey: {projec_access_key},
  pcode: {pcode},
  sampleRate: 100,
  proxyBaseUrl: "https://repo.whatap-browser-agent.io/rum/prod/v1/whatap-browser-agent.js"
  sessionReplaySampleRate: 50
}
```

</Column>
</Columns>

<Columns>
<Column className="text--left width--40">

**sessionReplayMaskAllTexts** <span class='type'>Boolean</span> <code className="my">optional</code>

Default `true`

If you set the value to `false`, all text data is collected without masking.

</Column>
<Column className="text--left">

```js showLineNumbers {7}
config: {
  projectAccessKey: {projec_access_key},
  pcode: {pcode},
  sampleRate: 100,
  proxyBaseUrl: "https://repo.whatap-browser-agent.io/rum/prod/v1/whatap-browser-agent.js"
  sessionReplaySampleRate: 50, 
  sessionReplayMaskAllTexts: false
}
```

</Column>
</Columns>

<Columns>
<Column className="text--left width--40">

**sessionReplayMaskAllInputs** <span class='type'>Boolean</span> <code className="my">optional</code>

Default `true`

If you set the value to `false`, the data in all input fields is collected without masking.

</Column>
<Column className="text--left">

```js showLineNumbers {7}
config: {
  projectAccessKey: {projec_access_key},
  pcode: {pcode},
  sampleRate: 100,
  proxyBaseUrl: "https://repo.whatap-browser-agent.io/rum/prod/v1/whatap-browser-agent.js"
  sessionReplaySampleRate: 50, 
  sessionReplayMaskAllInputs: false
}
```

</Column>
</Columns>

<Columns>
<Column className="text--left width--40">

**sessionReplayCollectAllBrowser** <span class='type'>Boolean</span> <code className="my">optional</code>

Default `false`

The session replay data is collected even in the browsers that do not support `requestIdleCallback()`. e.g. Safari, Safari on iOS

</Column>
<Column className="text--left">

```js showLineNumbers {7}
config: {
  projectAccessKey: {projec_access_key},
  pcode: {pcode},
  sampleRate: 100,
  proxyBaseUrl: "https://repo.whatap-browser-agent.io/rum/prod/v1/whatap-browser-agent.js"
  sessionReplaySampleRate: 50, 
  sessionReplayCollectAllBrowser: true
}
```

</Column>
</Columns>

<Columns>
<Column className="text--left width--40">

**ignoreStatusZero** <span class='type'>Boolean</span> <code className="my">optional</code>

Default `false`

This option excludes data from collection when the status code of the AJAX request is `0`.

</Column>
<Column className="text--left">

```js showLineNumbers {6}
config: {
  projectAccessKey: {project_access_key},
  pcode: {pcode},
  sampleRate: 100,
  proxyBaseUrl: "https://repo.whatap-browser-agent.io/rum/prod/v1/whatap-browser-agent.js",
  ignoreStatusZero: true
}
```

</Column>
</Columns>

:::note

- For more information about the session replay, see [the following](session-replay).

- For more information about the browsers that support session replay collection, see [the following](session-replay#supportedbrowser).

:::

## Next steps

- **Collecting custom events**

  To identify the web service issues and improve user experience through browser monitoring, it provides an interface that allows developers and operators to additionally collect desired events that occur on web pages. For more information about custom events, see [the following](collect-custom-events).

- **Setting the actual user ID**

  In the browser monitoring, you can collect data by setting the user ID via the actual user's login ID or email address. You can check the user session performance and event information based on the actual login ID, and then check the browser's errors to identify problems. For more details, see [the following](set-real-user-id).

- **Configuring the session replay**

  <Cmdname sid="TTL08103" className="uitext" /> is a feature that allows to record and replay all events performed by users on the website. This feature allows you to reproduce user behaviors such as clicking, scrolling, typing, and page switching. This helps you understand exactly how users actually interact with the website. For more details, see [the following](session-replay).

- **Starting the monitoring**

  Go to [WhaTap Monitoring Service](https://service.whatap.io) and then start the browser monitoring. Select a created project and then go to <Cmdname sid="side_dashboard" className="uitext" /> &gt; <Cmdname sid="side_rumDashboard" className="uitext" />. You can see the monitoring status. For more information about <Cmdname sid="side_rumDashboard" className="uitext" />, see [the following](dashboard).
