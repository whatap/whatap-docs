**Multi-transaction** means the transaction involving a different agent or project. **Multiple Transaction Trace** is to trace calls between the application services registered in the WhaTap project. 

<InDoc product="java">

:::info

The Java agent traces multi-transactions with three HTTP header keys (`x-wtap-po`, `x-wtap-mst`, and `x-wtap-sp1`). If HTTP transactions passing through the gateway cannot be traced, check the HTTP header conditions.

:::

</InDoc>

:::note

**Enabling the multi-transaction**

To trace multiple transactions, set the `mtrace_enabled` option to `true` in <Cmdname sid="side_management" className="uitext" /> &gt; <Cmdname sid="side_agentSetting" className="uitext" />. For more information about the agent configuration, see [the following](set-agent#set-agent-service).

:::

## How to Use Multi-Transaction Trace

1. Go to <Cmdname sid="analysis" className="uitext" /> > <Cmdname sid="multi_server_transaction_trace" className="uitext" />.

2. Enter the <b>MTID</b> value checked in the <Cmdname sid="TTL06527" className="uitext" /> window into the <Cmdname sid="search_mtid_or_custid" className="uitext" /> field.

3. Select the date and project to query.

4. Click the <Cmdname sid="apply" className="uitext" /> button at the bottom of the screen.

    * The <Cmdname sid="apply" className="uitext" /> button will be disabled under the following conditions:
        * When the same filter values (MTID/CUSTID, date, selected project) as the previous search are applied.
        * When none of the filter values (MTID/CUSTID, date, selected project) are entered.

5. The right-side <Cmdname sid="BTN07120" className="uitext" /> tab displays a diagram and a table that show the call relationships between each transaction.

    :::tip
    The diagram and table areas are divided vertically, and you can adjust their ratio manually.

    - Clicking the upper arrow expands the table to full height.  
      If the diagram was previously full height, the layout resets to a 50/50 split.
    - Clicking the lower arrow expands the chart area to full height.  
      If the table was previously full height, the layout resets to a 50/50 split.
    :::

### <Cmdname sid="BTN07120" />

<Cmdname sid="BTN07120" className="uitext" /> provides users with a fast and clear view of the call relationships between transactions. You can check the individual execution time of transaction services that share the same <Cmdname sid="TTL06107" className="uitext" />. The elapsed time displayed at the top of each transaction node (<LinkImage img="number-01.png" desc="number 1"/> <Cmdname sid="time_bar" className="uitext" />) allows you to understand the call flow between transactions.

![Chart](/img/trace-mtx-chart-timebar.png)

:::tip
You can freely move, zoom in, or zoom out the chart with your mouse.

- Drag within the chart area to move the view.
- Use scroll inside the chart:
    - Vertical scroll: move up/down  
    - Horizontal scroll: move left/right
- Use `Ctrl` + vertical scroll to zoom in/out.  
  (Touchpad pinch gestures are also supported.)
:::

When you select a transaction, only the related nodes remain active, while all unrelated nodes become dimmed.  
The **Detail View** button (<LinkImage img="number-02.png" desc="number 2"/>) below the selected transaction becomes enabled, and clicking it opens the <Cmdname sid="TTL06527" className="uitext" /> window.  
There you can view the transaction’s detailed trace.  
For more information on analyzing transaction traces using the <Cmdname sid="TTL06527" className="uitext" /> window, see the [Transaction Info Documentation](trs-profile#transaction-info).

* ![확대 아이콘](/img/ic-button-zoom-in.svg) **Zoom In**: Increase zoom level  
* ![축소 아이콘](/img/ic-button-zoom-out.svg) **Zoom Out**: Decrease zoom level  
* ![화면 맞춤 아이콘](/img/ic-button-fit-to-screen.svg) **Fit to Screen**: Adjust all nodes to fit the screen  
* ![화면 초기화 아이콘](/img/ic-button-reset-zooming.svg) **Reset Zoom**: Reset zoom and position to default state  
* ![설정 아이콘](/img/ic-button-setting.svg) **Chart View Settings**: Show or hide chart elements
    * <Cmdname sid="TTL06344" className="uitext" />: Toggle application name, project information, IP, and status codes  
    * <Cmdname sid="database" className="uitext" /> / <Cmdname sid="apply_external_remote" className="uitext" />: Display database connections or external HTTP Calls as nodes in the chart

### <Cmdname sid="BTN07121" />

In the <Cmdname sid="BTN07121" className="uitext" /> tab, you can view each transaction included in the multi-transaction trace in a table format.

When you select a transaction, its corresponding **node** in the <Cmdname sid="BTN07120" className="uitext" /> diagram becomes highlighted, and related nodes are emphasized.  
Clicking the detail button in the transaction column will open the <Cmdname sid="TTL06527" className="uitext" /> window, where you can inspect the full transaction trace details.  
For more information, refer to the [Transaction Info Documentation](trs-profile#transaction-info).

* ![컬럼 아이콘](/img/ic-column.svg) <Cmdname sid="BTN06441" className="uitext" /> — Edit visible columns in the table

### Tree {#trace-multi-tx-tree}

When you select the <Cmdname sid="BTN06296" className="uitext" /> button, you can view detailed information for each transaction and its associated traces.  
This view visualizes the start time and elapsed time of each sub-transaction or trace within the overall transaction execution time, providing a tree-structured representation of the call hierarchy.

* ![필터 아이콘](/img/ico-filter.svg) <Cmdname sid="TLT06410" className="uitext" />: Select or deselect the projects displayed in the chart.

* ![한 줄 보기 아이콘](/img/ic-single-line.svg) <Cmdname sid="BTN06368" className="uitext" />: Display each execution segment’s text in a single line to simplify the tree layout.

* ![여러 줄 보기 아이콘](/img/ic-multi-line.svg) <Cmdname sid="BTN06369" className="uitext" />: Display each execution segment’s text in multiple lines (with line breaks).

* <Cmdname sid="BTN06327" className="uitext" />: Jump to the longest path.

* ![차트 아이콘](/img/ic-bar-chart.svg) <Cmdname sid="BTN06743" className="uitext" />: Display elapsed time as bar charts.

* ![시간 아이콘](/img/ic-custom-time.svg) <Cmdname sid="BTN06744" className="uitext" />: Display timestamps, gaps, and elapsed time for each segment in text form.

  * 8 seconds or more: Displayed in <span class='etrs'>red</span> as an <span class='etrs'>over-delay</span>.
  * 3 to 8 seconds: Displayed in <span class='ov5ud10'>orange</span> as a <span class='ov5ud10'>delay</span>.
  * Less than 3 seconds: Displayed in <span class='woer'>blue</span> as <span class='woer'>normal</span>.

:::note
Start time and elapsed time may differ from actual collected values because they are adjusted based on mapping logic that accounts for time discrepancies between parent transactions and their traces.
:::

* ![감추기 아이콘](/img/ic-eye-invisible.svg) <Cmdname sid="BTN06745" className="uitext" />: Hide time information.

:::note
* Selecting the trace’s ![통계 아이콘](/img/ic-static.svg) button or ![팝업 아이콘](/img/ic-popup.svg) button allows you to view detailed information such as <Cmdname sid="remote_http_call_statistics" className="uitext" />, <Cmdname sid="activestack" className="uitext" />, or <UI>SQL</UI>.

* Clicking the ![복사 아이콘](/img/ico-copy.svg) button on a SQL step copies the SQL query text.
:::