## Guide to select generation conditions and targets {#condition-guide}

For the event generation conditions and selection of event targets on metrics alerts, use the same syntaxes. For event generation conditions, use the field key as a variable. For selection of event targets, use the tag key as a variable.

### Basic syntax rules

- If you just enter a string, it is recognized as a variable. If you enclose it in single quotation marks ('') or double quotation marks (""), it is recognized as text.

  ```java title='oid == "oid"'
  1. oid: variable
  2. ==: function
  3. "oid": text
  ```

  ```java
  // In case oname is ott-1235

  // Normal cases
  onname = 'ott-1235' or onname = "ott-1235"

  // In abnormal cases, notification does not work.
  onname = ott-1235
  ```

- If you just enter a number, it is recognized as number, and if you enclose it in single quotation marks ('') or double quotation marks (""), it is recognized as text.

  ```java title='oid == 123'
  1. oid: variable
  2. ==: function
  3. 123: number
  ```

  ```java
  // In case oid is 123

  // Normal cases
  oid = 123

  // In abnormal cases, notification does not work.
  id == '123' or oid == "123"
  ```

### List of available operators {#operatortype}

|   Operator        | Usage                                     | Description                                                                                                                     |
| :---------------: | ----------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------- |
|    `==`           | operand1 `==` operand2                    | It checks whether operand1 is equal to operand2.                                                                                |
|    `!=`           | operand1 `!=` operand2                    | It checks whether operand1 and operand2 have different values.                                                                  |
|     `>`           | operand1 `>` operand2                     | Check whether the operand1 value is greater than the operand2 value.                                                            |
|    `>=`           | operand1 `>=` operand2                    | Checks whether the operand1 value is greater than or equal to the operand2 value.                                               |
|     `<`           | operand1 `<` operand2                     | Check whether the operand1 value is less than the operand2 value.                                                               |
|    `<=`           | operand1 `<=` operand2                    | Check whether the operand1 value is less than or equal to the operand2 value.                                                   |
|    `like`         | operand1 `like` operand2                  | Search with patterns whether operand1 includes operand2.                                                                        |
|    `&&`           | expression1 `&&` expression2              | Check whether expression1 and expression2 are all `true`.                                                                       |
|    `and`          | expression1 `and` expression2             | Check whether expression1 and expression2 are all `true`.<br/>The operator plays the same role as <b>\&\&</b>.                  |
| <code>\|\|</code> | expression1 <code>\|\|</code> expression2 | Check whether expression1 and expression2 are all `true`.                                                                       |
|    `or`           | expression1 `or` expression2              | Check whether expression1 and expression2 are all `true`.<br/>The operator plays the same role as <b>\|\|</b>.                  |

#### Usage of like

You can conveniently search for embedded strings via the wildcard (`*`).

- Searching for strings that start with a specific keyword

  ```java

  Key like "Value*"

  ```

- Searching for strings that end with a specific keyword

  ```java

  Key like "*Value"

  ```

- Searching for strings that include a specific keyword

  ```java

  Key like "*Value*"

  ```

- The wildcard (`*`) cannot be used in the middle of keywords.

  ```java

  // Unsupported syntax
  Key like "Va*lue"

  ```

- If you omit the wildcard (`*`) in the `like` operator, it operates as equals (`==`).

  ```java

  // The following two statements have the same result.
  Key like "Value"
  Key == "Value"

  ```

### Available functions

| Method                    | Usage                      | Description                                                                                                      |
| ------------------------- | -------------------------- | ---------------------------------------------------------------------------------------------------------------- |
| [startsWith](#startwith)  | startsWith(param1, param2) | If the value whose param1 is the key starts with param2, the result is `true`. Otherwise, the result is `false`. |
| [endsWith](#endswith)     | endsWith(param1, param2)   | If the value whose param1 is the key ends with param2, the result is `true`. Otherwise, the result is `false`.   |
| [isNull](#isnull)         | isNull(param1)             | If param1 is `null`, the value becomes `true`. Otherwise, the value becomes `false`.                             |
| [isNotNull](#isnotnull)   | isNotNull(param1)          | If param1 is not `null`, the value becomes `true`. Otherwise, the value becomes `false`.                         |
| [isEmpty](#isempty)       | isEmpty(param1)            | If param1 is `null` or `EmptyString("")`, the value becomes `true`. Otherwise, the value becomes `false`.        |
| [isNotEmpty](#isnotempty) | isNotEmpty(param1)         | If param1 is not `null` nor `EmptyString("")`, the value becomes `true`. Otherwise, the value becomes `false`.   |

#### startsWith {#startwith}

```java
startsWith(Key, "Value")
```

#### endsWith {#endswith}

```java
endsWith(Key, "Value")
```

#### isNull {#isnull}

```java
isNull(Key)
```

#### isNotNull {#isnotnull}

```java
isNotNull(Key)
```

#### isEmpty {#isempty}

```java
isEmpty(Key)
```

#### isNotEmpty {#isnotempty}

```java
isNotEmpty(Key)
```

## Level Action Guide {#level-action-guide}

1. **Priority-Based Event Triggering**

    When multiple level conditions are satisfied at the same time, only the event with the highest priority is triggered.

    ```json title="Example"
    Settings:
    - Warning: CPU > 70%
    - Critical: CPU > 90%

    Current Status: CPU 95%
    → Result: Only the Critical event is triggered (Warning is suppressed)
    ```

1. **Level Escalation**

    When a lower-level event is already in progress and the higher-level condition is met, both levels become “in progress.”

    ```json title="Example"
    Settings:
    - Warning: CPU > 70%
    - Critical: CPU > 90%

    Scenario:
    1) CPU 80% → Warning triggered (in progress)
    2) CPU 95% → Warning (in progress), Critical (in progress)
    ```

1. **Level Downgrade**

    When an in-progress higher-level event transitions to a lower level, the higher level is resolved and the lower level remains active.

    ```json title="Example"
    Settings:
    - Warning: CPU > 70%
    - Critical: CPU > 90%

    Scenario:
    1) CPU 97% → Critical triggered
    2) CPU 85% → Critical resolved, Warning remains
    3) CPU 65% → Warning resolved
    ```

1. **Behavior Flow**

    
    ```json
    - Warning: CPU > 70%
    - Critical: CPU > 90%
    
    Metric Value:  60%     →      75%      →      92%      →      85%      →      60%
    Status:          Normal           Warning          Critical          Warning            Normal
                    (start)             (start)               (hold)               (end)
                                                                Warning
                                                                   (hold)
    ```

:::note
Events in progress remain active as long as their conditions continue to be satisfied, and persist until the conditions are cleared.
:::

## Condition Setting Guide {#condition-setting-guide}

:::caution

If a metric name starts with a number or contains special characters, you must write it in the form `${metricName}`.

- Parentheses `()`, `[]`
- Operators `+`, `-`, `*`, `/`, `%`
- Delimiters `:`, `@`, `#`, `,`, `(space)`
- Other special characters `!`, `^`, `&`, `|`, `~`, ```, `=`

**Examples using `${}`:**

```dart
${cpu(xos)} > 50
${mem[0]} >= 100
${cpu-usage} > 80
${namespace:cpu} > 70
${metric name} > 60
${4xx_error} > 10
```

Can be written without `${}`: when the name contains only letters, underscores (_), or dots (.)

```dart
cpu > 80
cpu_usage > 50
CPUUtilization.Average > 0.8
```

:::

## Condition Setting Guide {#condition-setting-guide}

:::caution

If a metric name starts with a number or contains special characters, it must be written in the form `${metricName}`.

- Parentheses `()`, `[]`
- Operators `+`, `-`, `*`, `/`, `%`
- Delimiters `:`, `@`, `#`, `,`, `(space)`
- Other special characters `!`, `^`, `&`, `|`, `~`, ```, `=`

**Examples using `${}`**:

```dart
${cpu(xos)} > 50
${mem[0]} >= 100
${cpu-usage} > 80
${namespace:cpu} > 70
${metric name} > 60
${4xx_error} > 10
```

Valid without `${}`: Only English letters, underscores (`_`), and dots (`.`)

```dart
cpu > 80
cpu_usage > 50
CPUUtilization.Average > 0.8
```
:::

1. **Comparison Operators**

    ```dart title="Number Comparison"
    Greater than:        cpu > 80
    Greater or equal:    cpu >= 80
    Less than:           memory < 1000
    Less or equal:       memory <= 1000
    Equal:               status == 200
    Not equal:           error != 0
    ```

    ```dart title="String Comparison"
    status == 'OK'
    region == "us-east-1"
    ```

1. **Arithmetic Operators**

    * Basic Arithmetic

    ```dart title="Basic Arithmetic"
    Addition:      cpu + 10 >= 90
    Subtraction:   memory - 100 >= 500
    Multiplication: cpu * 2 >= 100
    Division:       disk / 1024 >= 100
    Modulo:         value % 10 == 0
    ```

    * Priority Control with Parentheses

    ```dart title="Priority Control with Parentheses"
    (cpu + memory) * 2 >= 200
    (disk - used) / total >= 0.2
    ((cpu + memory) / 2) >= 50
    ```

    * Negative Values

    ```dart title="Negative Values"
    cpu > -100
    ```

1. **Logical Operators**

    * AND (&&)

    ```dart
    cpu > 80 && memory > 1000
    ${cpu(xos)} > 50 && ${mem(xos)} > 60
    ```

    * OR (||)

    ```dart
    cpu > 90 || memory > 90
    disk < 10 || network > 1000
    ```

    * Combined Logical Expressions

    ```dart
    (cpu > 50 && memory > 50) || disk < 20
    cpu > 80 && (memory > 1000 || disk > 500)
    ```

1. **Pattern Matching Operators**

    * LIKE

    ```dart
    oname like 'prod-*'
    url like '*error*'
    message like 'WARN%'
    ```

    * NOT LIKE

    ```dart
    oname not like 'test-*'
    url not like '*debug*'
    ```

2. **Built-in Functions**

    * Null Check Functions

    ```dart
    isNull(value)             # check if null
    isNotNull(value)          # check if not null
    nvl(value, 0)             # return default if null
    isEmpty(str)              # check empty string
    isNotEmpty(str)           # check non-empty string
    ```

    * Aggregate Functions

    ```dart
    sum(cpu, memory, disk)              # sum
    avg(cpu, memory)                    # average
    max(cpu, memory, disk)              # max
    min(cpu, memory, disk)              # min
    count(value1, value2, value3)       # count
    ```

    * Math Functions

    ```dart
    round(cpu, 2)             # round (2 decimals)
    ```

    * String Functions

    ```dart
    length(str)                # length
    startsWith(str, 'prefix')  # prefix check
    endsWith(str, 'suffix')    # suffix check
    indexOf(str, 'search')     # position
    substring(str, 0, 10)      # substring
    trim(str)                  # trim space
    replace(str, 'old', 'new') # replace
    hasStr(str, 'search')      # contains
    ```

    * Conditional Functions

        **if**: returns `trueValue` if condition is true, otherwise returns `falseValue`

        ```dart title="Format"
        if(condition, trueValue, falseValue)
        ```

        ```dart title="Example"
        if(value >= 90, 'High', 'Medium') == 'High'
        ```

        **decode**: returns the result matching the given condition; if none match, returns the default value

        ```dart title="Format"
        decode(value, cond1, result1, cond2, result2, ..., condN, resultN, default)
        ```

        ```dart title="Example"
        decode(value, 1, 'Low', 2, 'Medium', 3, 'High', 'Unknown') == 'Unknown'
        ```

        **in**: returns `true` if the value matches any candidate values

        ```dart title="Format"
        in(value, v1, v2, ..., vN)
        ```

        ```dart title="Example"
        in(status, 200, 201, 204) == false
        ```

:::caution

**Notes for Writing Expressions**

* Recommended
    - Use simple variable names without `${}` (e.g., cpu, memory)
    - Use `${}` for names with special characters
    - Use parentheses for clarity in complex expressions
    - Function names must be typed exactly (case-sensitive)

* Avoid
    - Incomplete expressions (e.g., cpu >, memory &&)
    - Mismatched parentheses (e.g., (cpu > 80, cpu > 80))
    - Invalid operators (e.g., cpu >> 80, cpu >< 80)

:::