---
id: warning-notice
title: サーバー警告通知
description: サーバーイベント条件設定を通じて警告通知を送信します。
tags:
  - アラート通知
  - サーバー
  - UI
---

ホーム画面 > プロジェクト選択 > **_アラート通知_** > **_イベント設定_** 

**_サーバー_**、**_プロセス_**、**_ログファイル_**および**_ウィンドウイベント_**などのイベントポリシーを作成・修正・削除できます。イベントタイプを選択してサーバーの再起動可否、エージェントの通信トラブルの持続時間、リソース使用量などに応じてイベントを設定できます。

<ImgLang img='server-warning.png' desc='イベント設定 - サーバー'/>

-   ![指示線1](/img/number-01.png) **_+イベント追加_**

    当該イベントを追加できます。

-   ![指示線2](/img/number-02.png)**_名前_**

    該当イベントの名前を表示します

-   ![指示線3](/img/number-03.png)**_条件_**

    該当イベントの条件を表示します.

-   ![指示線4](/img/number-04.png)**_サーバー_**

    当該イベントが設定されたサーバーを表示します。    

-   ![指示線 5](/img/number-05.png) **_修整_**と **_コピー_**

    -   ![修正アイコン](/img/ico-edit.svg)ボタンを選択して、保存されているイベント設定を**_修正_**できます。 

    -   ![コピーアイコン](/img/ico-copy.svg)ボタンを選択して、他のインフラにそのイベントを**_コピー_**できます。

:::note

-   **_メトリクス_**イベントの追加は[次の文書](metric-warning-notice)を参考にしてください。

-   **_異常値探知_**イベントの追加は[次の文書](set-event-detect-anomal)を参考にしてください。

-   **_ログ_**イベントの追加は[次の文書](set-event-log)を参考にしてください。

:::

## サーバーイベントの追加{#add-server-event}

ホーム画面 > プロジェクト選択 > **_警告通知_** > **_イベント設定_** > **_サーバー_** タップ > **_+ イベント追加_** ボタン選択

特定のサーバーに関する全体的なイベントを設定できます。 

<ImgLang img='server-server-event.png' desc='イベント追加 - サーバー'/>

1.  **_イベント追加_**ウインドウが表示されると![number 1](/img/number-01.png)イベント**_タイトル_**を入力してください。

2.  ![number 2](/img/number-02.png)**_サーバー一覧_**を確認するか、検索ウィンドウでモニタリングしたいサーバーを選択してください。 

3.  ![number 3](/img/number-03.png)**_イベント発行条件_**タブでご希望の**_メトリクス_**の**_条件_**、**_レーベル_**、**_持続時間_**、**_活性化_**可否を設定してください。

    -   **_レベル_**：<span class='slow'>警告</span>または<span class='vslow'>危険</span>レベルを選択できます。

    -   **_持続時間_**：設定した**_持続時間_**以降のサーバの状態が<span class='slow'>警告</span>、<span class='vslow'>危険</span>レベルに変更されます。

    **_メトリクス_**案内は以下を参考にしてください。 

    -   **_再起動_**：サーバーの再起動時に発生するイベントです。

    -   **_未受信_**：エージェントから**_持続時間_**の間、正常なデータを受信できなかった場合に発生する通信トラブルイベントです。

    -   **_ポット_**：ポート接続不可イベントです。プロジェクト内に登録されたエージェントは、**10120ポート**を通じてお互いの状態を確認します。 **_持続時間_**間通信が行われない場合に発生するイベントです。  

    -   **_CPU、Memory、スワップ_**：CPU、Memory、SWAPメモリなどの使用量に関するイベントを設定します。 

    -   **_Steal_**：CPU Steal Timeに対するイベントを設定します。Linux系統のOSに限って設定できます。 

    -   **_Disk_**：ディスク使用量とI/O使用量、Inode使用量に基づいてイベントを設定します。

    -   **_Network_**：ネットワーク使用量に関するイベントを設定します。トラフィック量と毎秒パケットを基準に設定できます。 

4.  イベント設定を終えたら![number 4](/img/number-04.png)**_保存_**ボタンを選択してください。

:::caution

1台のサーバーに1つのイベントを割り当てることができます。

:::

<details>
<summary>サーバーイベントの基本設定</summary>

WhaTapサーバーモニタリング サービスは、エージェントのインストールと同時に、次のような基本イベント設定を提供します。 

![サーバー基本通知sc](/img/server-default-notice-setting.png)

-   **_再起動_**：活性化

-   **_ネットワークIOPS_**

    -   <span class='slow'>警告</span>：45,000 pps / 持続時間：5分
    -   <span class='vslow'>危険</span>：50,000 pps / 持続時間：5分

-   **_ネットワークBPS_**

    -   <span class='slow'>警告</span>：5000,000,000 bps / 持続時間：5分
    -   <span class='vslow'>危険</span>：7000,000,000 bps / 持続時間：5分

-   **_ディスクI/O_**

    -   <span class='slow'>警告</span>：90% / 持続時間：5分
    -   <span class='vslow'>危険</span>：95% / 持続時間：5分

-   **_ディスク使用量_**

    -   <span class='slow'>警告</span>：90% / 持続時間：5分
    -   <span class='vslow'>危険</span>：95% / 持続時間：5分

-   **_inode_**

    -   <span class='slow'>警告</span>：90% / 持続時間：5分
    -   <span class='vslow'>危険</span>：95% / 持続時間：5分

-   **_CPU_**

    -   <span class='slow'>警告</span>：70% / 持続時間：1分
    -   <span class='vslow'>危険</span>：90% / 持続時間：1分

-   **_メモリ_**

    -   <span class='slow'>警告</span>：70% / 持続時間：1分
    -   <span class='vslow'>危険</span>：90% / 持続時間：1分

-   **_steal_**

    -   <span class='slow'>警告</span>：5% / 持続時間：1分
    -   <span class='vslow'>危険</span>：10% / 持続時間：1分

-   **_スワップ_**

    -   <span class='slow'>警告</span>：50% / 持続時間：1分
    -   <span class='vslow'>危険</span>：90% / 持続時間：1分

</details>

## プロセスイベントの追加{#process-event}

ホーム画面 > プロジェクト選択 > **_警告通知_** > **_イベント設定_** > **_プロセス_** タブ > **_+ イベント追加_** ボタン選択

特定プロセスに対するイベントポリシーを設定できます。

<ImgLang img='server-process-event.png' desc='イベント追加 - プロセス'/>

1.  **_イベント追加_**ウインドウが表示されると![number 1](/img/number-01.png)イベント**_タイトル_**を入力してください。

2.  ![number 2](/img/number-02.png)**_イベント発行条件_**タブで**_サーバー一覧_**の**_選択されたエージェントがありません_**ボタンをクリックして**_サーバー一覧_**ウィンドウでサーバーを選択してください。 

    :::note

    **_プロジェクト基本ポリシー_**オプショントグル![アイコン](/img/ic-toggle-on.svg)の活性化時、プロジェクトが管理するサーバーに基本の通知ポリシーを適用します。

    :::

3.  **_プロセス_**選択ウィンドウでプロセスまたはプロセスグループを選択してください。 

    :::note

    プロセスグループの追加方法の詳細については [次の文書](server-detail-process-group.mdx)を参考にしてください。

    :::

4.  **_プロセス所有者_**を選択してください。 

    -   **_プロセス所有者_**を指定しない場合、所有者に関係なく同じ名前のすべてのプロセスにその設定が適用されます。
    -   イベント条件は、 **_プロセス所有者 _**を省略した場合でも、所有者-プロセス単位で動作します。

5.  ご希望の**_メトリクス_**の**_レベル_**、**_持続時間_**、**_活性化_**有無を設定してください。

    -   **_レベル_**：<span class='slow'>警告</span>または<span class='vslow'>危険</span>レベルを選択できます。

    -   **_持続時間_**：設定したしきい値の**_持続時間_**以降のサーバの状態が<span class='slow'>警告</span>、<span class='vslow'>危険</span>レベルに変更されます。

    **_メトリクス_**案内は以下を参考にしてください。 

    -   **_プロセス数_**：同じ名前のプロセスの数に対するイベントを設定できます。**_危険_**と**_警告_**条件の個数を指定してください。
    -   **_プロセスCPU_**：CPU使用量に応じてイベントを設定できます。
    -   **_プロセスMemory_**：メモリ使用量に応じてイベントを設定できます。

6.  イベント設定を終えたら![number 3](/img/number-03.png)**_保存_**ボタンを選択してください。

:::note

-   プロセス通知 **_条件_**を誤って設定した場合は、その通知を非活性化するか、通知 **_条件_**を再設定してください。
-   **_プロセス_** および **_プロセス所有者_**を誤って指定した場合は、その通知を非活性化して進行中の通知を解消した後に、通知 **_条件_**を再設定してください。

:::

## ログファイルおよびウィンドウイベントの追加

ホーム画面 > プロジェクト選択 > **_警告通知_** > **_イベント設定_** > **_ログファイル/ウィンドウイベント_** タブ > **_+ イベント追加_** ボタン選択

特定のログファイルとウィンドウイベント設定を管理できます。

### ログファイル{#log-file-event}

**_ログファイル_**イベントを追加するには、次を参考にして**_イベント発生条件_**を指定してください。 

<ImgLang img='server-log-file.png' desc='イベント追加 - ログファイル'/>

1.  **_イベント追加_**ウインドウが表示されると![number 1](/img/number-01.png)イベント**_タイトル_**を入力してください。

2.  ![number 2](/img/number-02.png)**_サーバー一覧_**を確認するか、検索ウィンドウでモニタリングしたいサーバーを選択してください。 

    :::note

    **_プロジェクト基本ポリシー_**オプショントグル![アイコン](/img/ic-toggle-on.svg)の活性化時、プロジェクトが管理するサーバーに基本の通知ポリシーを適用します。

    :::

3.  ![number 3](/img/number-03.png)**_イベント発行条件_**タブで**_ログの種類_**を **_ログファイル_**として選択してください。

4.  例を参考にして、**_ファイルパス_**を正規表現どおり入力してください。 

    > 例）_/var/log/mylogfile_%Y-%m-%d_%H:%M:%S.log_

5.  イベントを発生させる**_検索キーワード_**を入力してください。複数指定ができます。

6.  通知から除外する**_検出除外文字列_**を入力してください。複数指定ができます。

7.  数秒間、何回指定した**_キーワード_**検出時に通知を受けるか**_繰り返し回数_**と**_期間_**を入力してください。 

8.  イベントの**_危険度_**を選択してください。<span class='vslow'>危険</span>あるいは<span class='slow'>警告</span>レベルを選択できます。

9.  ![number 4](/img/number-04.png) **_保存_**ボタンを選択してください。

### ウィンドウイベント{#windows-event}

**_ウィンドウイベント_**を追加するには、以下を参考にして**_イベント発行条件_**を指定してください。Windows環境でのみ使用できます。

<ImgLang img='server-log-windows.png' desc='Windowsイベント追加'/>

1.  **_イベント追加_**ウインドウが表示されると![number 1](/img/number-01.png)イベント**_タイトル_**を入力してください。

2.  ![number 2](/img/number-02.png)**_サーバー一覧_**を確認するか、検索ウィンドウでモニタリングしたいサーバーを選択してください。 

    :::note

    **_プロジェクト基本ポリシー_**オプショントグル![アイコン](/img/ic-toggle-on.svg)の活性化時、プロジェクトが管理するサーバーに基本の通知ポリシーを適用します。

    :::

3.  ![number 3](/img/number-03.png)**_イベント発行条件_**タブで**_ログの種類_**を**_ウィンドウイベント_**として選択してください。

4.  次の例を参考にして**_ログ名_**を選択してください。

    <ImgLang img='server-log-windows-a-01.png' desc='ログ名'/>

5.  次の例を参考にして**_レベル_**、**_原本_**(イベントソース)、**_イベントID_**、**_検索キーワード_**を指定してください。**_検索キーワード_**は複数指定ができます。

    <ImgLang img='server-log-windows-a-02.png' desc='レベルイベントソースなど'/>

6.  通知から除外する**_検出除外文字列_**を入力してください。複数指定ができます。

7.  イベントの**_危険度_**を選択してください。<span class='vslow'>危険</span>あるいは<span class='slow'>警告</span>レベルを選択できます。

8.  ![number 4](/img/number-04.png) **_保存_**ボタンを選択してください。

#### ログファイル処理量

ログファイル処理量は、ログ行数をベースに次のように設定されています。 ログの過多発生時にWhaTapサーバーモニタリングエージェントのCPU過剰使用の防止のためです。超過量は処理しません。

-   バージョン1.3.6以前：約2秒当たり60行を処理します。 
-   バージョン1.3.7以降：約2秒当たり1000行を処理します。 

次のオプションで、2秒当たりの超過量を調整できます。

-   **Linux**

    > _/usr/whatap/infra/conf/whatap.conf_ ファイルに `log.skip.threshold=2秒当たり秒処理可能な行数`

-   **Windows**

    > _C:\\Program Files\\WhatapInfra\\whatap.conf_ ファイルに `log.skip.threshold=2秒当たり秒処理可能な行数`

## イベントの修正{#event-edit}

1.  イベントリスト右側の![修正アイコン](/img/ico-edit.svg)**_修正_**アイコンを選択してください。 

2.  **_イベント発行条件_**タブでご希望の**_メトリクス_**の**_条件_**、**_レーベル_**、**_持続時間_**、**_活性化_**可否を修正してください。

3.  イベントの修正が終わったら**_保存_**ボタンを選択してください。

:::note

-   イベント修正時、特定メトリクスに対する変更事項がある場合、当該メトリクスにかかっていた進行中のお知らせは<span class='vslow'>Disabled</span>されます。
-   修正後、条件に合ったデータが流入すると、新しい通知が発生します。
-   プロセス通知の**_タイトル_**、**_プロセス_**、**_プロセス所有者_**いずれかの値を修正する場合、その条件にかかったすべての通知は<span class='vslow'>Disabled</span>されます。

:::

## イベントの削除{#event-delete}

1.  イベントリスト右側の![修正アイコン](/img/ico-edit.svg)**_修正_**アイコンを選択してください。 

2.  修正画面の上段右側の![削除アイコン](/img/ic-delete-critical.svg)**_削除_**アイコンを選択してください。

## イベントのコピー{#event-copy}

1.  イベント一覧の右側の![コピーアイコン](/img/ico-copy.svg)**_コピー_**アイコンを選択してください。

2.  **_イベント設定のコピー_**ウィンドウが開いたら目的のプロジェクトを選択するか、下段の**_現在のプロジェクトにコピー_**を選択してください。

3.  イベントの設定をコピーするプロジェクトを指定したら、**_コピー_**ボタンを選択してください。

:::note

-   同じプロジェクト内でイベントを繰り返しコピーをすると、繰り返された分のイベントが作成されます。

-   コピーしたイベント名は形式**_(copy)_**表記が追加されます。 
    > 例）既存のイベント名**_Default_**→コピーしたイベント名**_Default(copy)_**

:::

<!-- 

* 프로젝트 간 또는 동일 프로젝트 내 이벤트 설정을 복사할 수 있습니다.

-->
