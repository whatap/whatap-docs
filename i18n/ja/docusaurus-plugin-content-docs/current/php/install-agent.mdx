---
id: install-agent
title: エージェントのインストール
description: PHP環境で動作するアプリケーションサーバーに適用できるエージェントのインストール方法を確認してください。
keywords:
  - PHP
  - PHPモニタリング
  - アプリケーション
  - アプリケーションモニタリング
  - インストール
  - エージェント
---

import DocCardList from '@theme/DocCardList';
import TR from '@site/src/components/TR';

import Agentsignupguide from "../common-items/_agent-signup-guide.mdx";

<Agentsignupguide />

<Youtube ko='JJC5JidgKlk' en='ZK2DM4yePb8' ja='ZK2DM4yePb8' />

import Createprojectv2 from "../getting-started/_create-project-v2.mdx";

<Createprojectv2 />

import Accesskeyv2 from "../getting-started/_accesskey-v2.mdx";

<Accesskeyv2 />

## エージェントダウンロード

**アクセスキー**を発行されたら、使用するOSを選択します。次に、**エージェントダウンロード**セクションでオペレーティング システムのコマンドをコピーしてエージェントをインストールしてください。

PHPエージェントのインストール方法は、**Linuxパッケージのインストール**です。インストールの手順は次のとおりです。

1. WhaTap **リポジトリ**を登録します。

2. whatap-php **Linuxパッケージ**(yum,apt-get)をインストールしてください。

3. **設定スクリプト**を実行してください。設定スクリプトのトレーサーは**PHP拡張モジュール**として登録され、エージェントは**whatap-phpサービス**として実行されます。

   ![php](https://img.whatap.io/media/images/php.png)

4. ApacheまたはPHP-FPMを**再起動**してください。

:::note

エージェントファイル構成の詳細については、PHPファイル構成を参照してください。

:::

エージェントファイルは、アプリケーションのモニタリングに必要な情報を抽出してWhaTap収集サーバーに転送するトレーサー、収集された情報をサーバーに転送するためのエージェント、トレーサーとエージェントをサーバーに動的に適用するためのインストールスクリプトファイルで構成されています。エージェントファイルの詳細な説明については、次を参照してください。

<Filetree name="whatap">

<FiletreeItem name="whatap_X.Y.Z.so" type="file">

  トレーサーとして登録されたPHP拡張モジュールとして追加され、情報を収集し、収集された情報をエージェントに送信するライブラリです。拡張モジュールはPHPバージョン(PHP API Version)とZend Thread Safe対応の可否によって判別されます。例は次のとおりです。 

  _whatap_zts_20041225.so_：PHP5.2バージョン、 Zend Thread safe enable

  _whatap_20041225.so_：PHP5.2バージョン、 Non Thread Safe 

</FiletreeItem>

<FiletreeItem name="whatap-php(whatap_php)" type="file">エージェントは、トレーサーからUDPで送信された情報を収集サーバーに転送するプログラムです。</FiletreeItem>
  
  <FiletreeItem name="whatap_php" type="file">サービスの実行ファイルです。</FiletreeItem>

<FiletreeItem name="whatap.ini" type="file">アプリケーションサーバーのデータを収集するPHP拡張モジュールの設定情報、収集サーバーのアドレスとサーバーのポート番号を入力するファイルです。</FiletreeItem>

<FiletreeItem name="template.ini" type="file">*whatap.ini* 作成時、コピーして使用するテンプレートファイルです。</FiletreeItem>

<FiletreeItem name="whatap-install-yyyymmdd.log" type="file">インストールする際のログファイルです。デフォルト保存パスは*/usr/whata/php/logs*です。日付ごとにファイルが作成されます。デフォルトで7日間のログが保存されます。</FiletreeItem>

<FiletreeItem name="whatap-boot-yyyymmdd.log" type="file">エージェントのログファイルです。デフォルト保存パスは、*/usr/whata/php/logs*です。日付ごとにファイルが作成されます。デフォルトで7日間のログが保存されます。</FiletreeItem>

<FiletreeItem name="install.sh" type="file">インストールスクリプトです。PHP拡張モジュール(*whatap.so *)をApacheまたはPHP-FPMに連携し、whatap-phpサービスをインストールします。詳細は[次の文書](agent-troubleshooting#extension-modul-manual-setting)を参照してください。</FiletreeItem>

<FiletreeItem name="WhaTap.php (sample.php)" type="file">PHPソースコードで使用するAPIリファレンスクラス(*/usr/whatap/php/lib/WhaTap.php*)およびサンプルソースファイル(*sample.php*)です。</FiletreeItem>

<FiletreeItem name="/etc/init.d" type="folder">
  
    <FiletreeItem name="whatap-php" type="file">サービスのスクリプトファイルです。</FiletreeItem>
  
  </FiletreeItem>

</Filetree>

使用するアプリケーションサーバー環境に応じてインストール方法を次のように提供します。 エージェントをインストールして適用する前に [動作環境](supported-spec)を確認してください。

<DocCardList/>
