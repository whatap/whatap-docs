[
  {
    "ver": "v2.13.0",
    "date": "2025-11-19",
    "Lists": [
      {
        "ver": "v2.13.0",
        "hash": "v2130",
        "product": "PHP Agent",
        "type": "Fixed",
        "desc": "<p><code class=\"Fixed\" type=\"0\">Fixed</code> アクティブステータス（Active Status）データの収集が正常に動作しない問題を修正しました。</p>",
        "details": "<ul><li>v2.12.0 で PHP 内部関数のフック方式を <code>zend_execute_internal</code> から <code>handler overwrite</code> 方式に変更。</li><li>この変更によりアクティブステータスのデータ収集が正常に動作しない問題が発生。</li></ul>"
      },
      {
        "ver": "v2.13.0",
        "hash": "v2130",
        "product": "PHP Agent",
        "type": "New",
        "desc": "<p><code class=\"New\" type=\"1\">New</code> Windows OS で PHP モニタリングをサポートしました。</p>",
        "details": "<ul><li><p><strong>システム要件</strong></p><ul><li>Windows Server 2016 (x64) 以上 または Windows 10 (x64) 以上</li><li>PHP 7.0 ~ 8.4 (NTS および ZTS)</li></ul></li><li><p><strong>ビルド環境</strong></p><ul><li>WhaTap PHP 拡張は Microsoft Visual C++ コンパイラを使用してビルドされ、PHP バージョンに応じて異なる Visual Studio バージョンを使用します。</li><ul><li><strong>Visual C++ 15.0</strong> (Visual Studio 2017) - PHP 7.0–7.4</li><li><strong>Visual C++ 16.0</strong> (Visual Studio 2019) - PHP 8.0–8.3</li><li><strong>Visual C++ 17.0</strong> (Visual Studio 2022) - PHP 8.4</li></ul><li>バージョン別ビルド環境<table><thead><tr><th>PHP バージョン</th><th>OS</th><th>Visual Studio</th><th>Windows SDK</th><th>PHP SDK</th></tr></thead><tbody><tr><td>7.0–7.4</td><td>Windows Server 2016 (ltsc2016)</td><td>VS 2017 (VC15)</td><td>10.0.17763.0</td><td>2.1.9–2.2.0</td></tr><tr><td>8.0–8.3</td><td>Windows Server 2019 (ltsc2019)</td><td>VS 2019 (VS16)</td><td>10.0.19041.0</td><td>2.2.0</td></tr><tr><td>8.4</td><td>Windows Server 2022 (ltsc2022)</td><td>VS 2022 (VS17)</td><td>10.0.20348.0 / 11.0.22000.0</td><td>2.4.0</td></tr></tbody></table></li><li>対応 Web サーバー<ul><li>Apache 2.4 以上</li><li>Microsoft IIS</li></ul></li></ul></li></ul>"
      },
      {
        "ver": "v2.13.0",
        "hash": "v2130",
        "product": "PHP Agent",
        "type": "New",
        "desc": "<p><code class=\"New\" type=\"1\">New</code> 遅いトランザクションの遅延区間を特定できるスタックトレース機能を追加しました（分析 > スタックで確認可能）。</p>",
        "details": "<ul>\n<li><strong>動作方式</strong>\n<ul>\n<li>設定時間（デフォルト 5 秒）以上実行されるトランザクションを自動検出。</li>\n<li>1 秒ごとに実行中の関数を記録（最大 20 回）。</li>\n<li>PHP 内部の <code>debug_gettrace()</code> 関数を使用してスタック情報を収集。</li>\n<li>ユーザー関数の呼び出し終了時にスタックを収集するため、関数実行時間が長い場合は収集間隔が一定でない場合があります。</li>\n</ul>\n<div class=\"theme-admonition theme-admonition-caution alert alert--warning\">\n<div class=\"admonition-heading\">\n<strong>注意</strong>\n</div>\n<div class=\"admonition-content\">\n<p>この機能を有効にすると、収集負荷が発生する可能性があります。</p>\n</div>\n</div></li>\n<li><strong>前提条件</strong>\n<ul>\n<li>以下の 2 つのオプションが有効である必要があります（デフォルトで有効）。\n<ul>\n<li><code>whatap.ext.hook_zend_execute_ex_enable</code></li>\n<li><code>whatap.profile_method_enabled</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><strong>設定オプション</strong>\n<ul>\n<li><code>whatap.active_stack_enabled</code>\n<ul><li>デフォルト: false</li><li>スタック収集機能を有効化</li></ul></li>\n<li><code>whatap.ext.active_stack_start_resp_time</code>\n<ul><li>デフォルト: 5000</li><li>設定応答時間を超えた場合にスタック収集を開始</li><li>デフォルト: 応答時間が 5 秒以上の場合にスタック情報を収集</li><li>最小値: 1000ms</li></ul>\n<div class=\"theme-admonition theme-admonition-caution alert alert--warning\">\n<div class=\"admonition-heading\">\n<strong>注意</strong>\n</div>\n<div class=\"admonition-content\">\n設定値を反映するには、Web サーバー（Apache または php-fpm）を再起動する必要があります。\n</div>\n</div></li>\n<li><code>whatap.ext.active_stack_interval</code>\n<ul><li>デフォルト: 1000</li><li>スタック収集間隔を設定</li><li>最初の収集後、1 秒間隔でスタックを収集</li><li>最小値: 200ms、変更単位: 200ms</li></ul>\n<div class=\"theme-admonition theme-admonition-caution alert alert--warning\">\n<div class=\"admonition-heading\">\n<strong>注意</strong>\n</div>\n<div class=\"admonition-content\">\n設定値を反映するには、Web サーバー（Apache または php-fpm）を再起動する必要があります。\n</div>\n</div></li>\n<li><code>whatap.trace_active_callstack_depth</code>\n<ul><li>デフォルト: 50</li><li>スタック収集数の制限（最大 50 行）</li></ul>\n<div class=\"theme-admonition theme-admonition-caution alert alert--warning\">\n<div class=\"admonition-heading\">\n<strong>注意</strong>\n</div>\n<div class=\"admonition-content\">\n設定値を反映するには、Web サーバー（Apache または php-fpm）を再起動する必要があります。\n</div>\n</div></li>\n<li><code>whatap.ext.active_stack_max_count</code>\n<ul><li>デフォルト: 20</li><li>スタック収集回数の制限（最大 20 回）</li></ul>\n<div class=\"theme-admonition theme-admonition-caution alert alert--warning\">\n<div class=\"admonition-heading\">\n<strong>注意</strong>\n</div>\n<div class=\"admonition-content\">\n設定値を反映するには、Web サーバー（Apache または php-fpm）を再起動する必要があります。\n</div>\n</div></li>\n</ul>"
      }      
    ]
  },  
  {
    "ver": "v2.12.0",
    "date": "2025-10-15",
    "Lists": [
      {
        "ver": "v2.12.0",
        "hash": "v2120",
        "product": "PHP Agent",
        "type": "Change",
        "desc": "<p><code class=\"Change\" type=\"0\">Change</code> PHP内部関数のフック方式を変更</p>",
        "details": "<ul>\n<li>従来の<code>zend_execute_internal</code>を使用する方式では、すべての関数を確認するため、内部関数呼び出しが多い場合にCPU負荷が発生する可能性がありました。</li>\n<li>必要なPHP内部関数のハンドラーのみを置き換える方式に変更し、特定の関数のみを選択してトランザクション情報を収集します。</li>\n<li>関連オプションを追加:</li>\n<ul>\n<li><code>whatap.ext.hook_overwrite_internal_function_enabled</code><br>デフォルト値: <code>true</code><br>必要なPHP内部関数のハンドラーを置き換える方式で、特定の関数のみを選択してトランザクション情報を収集します。<br><code>whatap.ext.hook_zend_execute_internal_enabled</code>と重複設定しないように注意してください。<br>サービスの再起動が必要です（Apache または php-fpmの再起動）。</li>\n<li><code>whatap.ext.hook_zend_execute_internal_enabled</code><br>デフォルト値: <code>false</code><br>従来方式で、<code>zend_execute_internal</code>を通じてトランザクションデータを収集します。<br>サービスの再起動が必要です（Apache または php-fpmの再起動）。</li>\n<li><code>whatap.ext.hook_zend_execute_ex_enabled</code><br>デフォルト値: <code>true</code><br>PHPユーザー関数を<code>zend_execute_ex</code>を通じてデータを収集します。<br>サービスの再起動が必要です（Apache または php-fpmの再起動）。</li>\n</ul>\n</ul>"
      }
    ]
  },  
  {
    "ver": "v2.11.2",
    "date": "2025-07-23",
    "Lists": [
      {
        "ver": "v2.11.2",
        "hash": "v2112",
        "product": "PHP Agent",
        "type": "Fixed",
        "desc": "<p><code class=\"Fixed\" type=\"0\">Fixed</code> <code>segmentation fault</code>エラーが発生する問題を修正</p>",
        "details": "<ul>\n<li><code>session_set_save_handler</code>関数を使用する際に発生していたエラーを修正</li>\n</ul>"
      }
    ]
  },  
  {
    "url": "https://whatap.github.io/whatap-docs/release-notes/php/php-2_11_1/",
    "ver": "v2.11.1",
    "date": "2025-07-09",
    "Lists": [
      {
        "ver": "v2.11.1",
        "hash": "v2111",
        "product": "PHP Agent",
        "type": "Fixed",
        "desc": "<p><code class=\"Fixed\" type=\"0\">Fixed</code> whatap-php.service の登録および実行失敗問題を修正</p>",
        "details": "<ul>\n<li>\n<p>新規インストール時、environment 値が不足していたため、接続情報（Access Key やサーバーアドレス）を認識できず、エージェントが無効化されていました。</p>\n<p>以下のコマンドで手動設定が可能です：</p>\n<div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockTitle_Ktv7\">php command</div><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\" style=\"color:#bfc7d5;background-color:#292d3e\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">1</span><span class=\"token plain\">. /usr/whatap/php/install.sh を実行</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">2</span><span class=\"token plain\">. cp /usr/lib/systemd/system/whatap-php.service /etc/systemd/system/whatap-php.service</span><br></span></code></pre></div></div></div>\n</li>\n<li>\n<p>既存のインストール環境では、アップデート時に正常にインストールされます。</p>\n</li>\n</ul>"
      }
    ]
  },
  {
    "url": "https://docs.whatap.io/release-notes/php/php-2_11_0",
    "ver": "v2.11.0",
    "date": "2025-06-18",
    "Lists": [
      {
        "ver": "v2.11.0",
        "hash": "v2110",
        "product": "PHP Agent",
        "type": "Feature",
        "desc": "<p><code class=\"Feature\" type=\"0\">Feature</code> CPU負荷の軽減</p>",
        "details": "<ul>\n<li>\n<p>監視対象の判定基準を変更し、CPU負荷を軽減</p>\n</li>\n<li>\n<p>ユーザー関数の監視を無効にすると、さらに負荷を軽減</p>\n<p><code>whatap.profile_method_enabled=false</code></p>\n</li>\n</ul>"
      },
      {
        "ver": "v2.11.0",
        "hash": "v2110",
        "product": "PHP Agent",
        "type": "New",
        "desc": "<p><code class=\"New\" type=\"1\">New</code> CLI呼び出しパラメータをURLに表示</p>",
        "details": "<ul>\n<li>\n<p>CLIで実行された際、パラメータを含めてURLとして収集</p>\n<ul>\n<li>例：php /home/www/test.php aaa bbb → /home/www/test.php aaa bbbとして表示</li>\n</ul>\n</li>\n</ul>"
      },
      {
        "ver": "v2.11.0",
        "hash": "v2110",
        "product": "PHP Agent",
        "type": "New",
        "desc": "<p><code class=\"New\" type=\"1\">New</code> fileパラメータ情報の収集</p>",
        "details": "<ul>\n<li>最大20件、各256バイトまでの一部パラメータを収集</li>\n</ul>"
      }
    ]
  },  
  {
    "url": "https://docs.whatap.io/ja/release-notes/php/php-2_10_0",
    "ver": "v2.10.0",
    "date": "2025-02-11",
    "Lists": [
      {
        "ver": "v2.10.0",
        "hash": "v2100",
        "product": "PHP Agent",
        "type": "New",
        "desc": "<p><code class=\"New\" type=\"1\">New</code> PHP Extensionで機能別に収集中止できるオプションを追加</p>",
        "details": "<ul>\n<li>\n<p><code>whatap.ext.trace_enabled</code> (デフォルト値: <code>true</code>): トランザクションの情報収集を非活性化</p>\n</li>\n<li>\n<p><code>whatap.ext.profile_enabled</code> (デフォルト値: <code>true</code>): トランザクションの基本情報収集を非活性化</p>\n</li>\n<li>\n<p><code>whatap.ext.profile_sql_enabled</code> (デフォルト値: <code>true</code>): SQLプロファイル収集を非活性化</p>\n</li>\n<li>\n<p><code>whatap.ext.profile_httpc_enabled</code> (デフォルト値: <code>true</code>): HTTP呼び出しプロファイルの収集を非活性化</p>\n</li>\n<li>\n<p><code>whatap.ext.profile_socket_enabled</code> (デフォルト値: <code>true</code>): ソケット関連プロファイル収集を非活性化</p>\n</li>\n</ul>"
      },
      {
        "ver": "v2.10.0",
        "hash": "v2100",
        "product": "PHP Agent",
        "type": "New",
        "desc": "<p><code class=\"New\" type=\"1\">New</code> 特定のURIに基づいて収集を中止するオプションを追加</p>",
        "details": "<ul>\n<li>\n<p><code>whatap.ext.ignore_uris</code>: トランザクション情報を収集しないURIを登録(コンマ区分)</p>\n<ul>\n<li>例: <code>whatap.ext.ignore_uris=/aaa/bbb.php, /ccc/ddd.php</code></li>\n</ul>\n</li>\n<li>\n<p><code>whatap.ext.ignore_profile_uris</code>: トランザクションの基本情報は収集するが、詳細プロファイル情報を収集しないURIを登録 (コンマ区分)</p>\n<ul>\n<li>例: <code>whatap.ext.ignore_profile_uris=/aaa/bbb.php, /ccc/ddd.php</code></li>\n</ul>\n</li>\n</ul>"
      },
      {
        "ver": "v2.10.0",
        "hash": "v2100",
        "product": "PHP Agent",
        "type": "New",
        "desc": "<p><code class=\"New\" type=\"1\">New</code> トランザクション追加情報を収集</p>",
        "details": "<ul>\n<li>\n<p><code>peak-memory</code>: PHP実行中peak memoryを収集</p>\n</li>\n<li>\n<p><code>elapsed-utime</code>: ユーザーCPU使用量を収集</p>\n</li>\n<li>\n<p><code>elapsed-stime</code>: システムCPU使用量を収集</p>\n</li>\n<li>\n<p><code>external-func-count</code>: ユーザー関数の実行件数</p>\n</li>\n<li>\n<p><code>prof-external-func-count</code>: WhaTapモニタリングが追跡したユーザー関数の件数</p>\n</li>\n<li>\n<p><code>internal-func-count</code>: PHP internal関数の実行件数</p>\n</li>\n<li>\n<p><code>prof-internal-func-count</code>: WhaTapモニタリングが追跡したinternal関数の件数</p>\n</li>\n</ul>"
      }
    ]
  }
]