---
id: log-process
title: ログ収集時間基準
description: ログ収集時間の基準時間について案内します。
keywords:
  - ログモニタリング
  - ログ処理
  - ログ収集時間
---

本文書は、ログモニタリングのフローの**処理**(Processing) 過程でのログ***収集時間***の基準時間について説明します。

## 収集時間の基準時間

<ImgLang img="log-timestamp.png" desc="로그 수집 시간 기준 시간 변경" />

ログ***収集時間***の基準時間が**WhaTapエージェントがログを収集した時間**から**WhaTap収集サーバーのログ処理時間**に変更されました。

一般的な状況では、変更前と大差なく、従来の方式と同様にログを検索できます。 変更後、次の場合でもユーザーによる追加の時間修正なしにログモニタリングを使用できます。

- NTP(Network Time Protocol)適用時、モニタリング対象のサーバー時間が標準時間より過去、もしくは未来時間に設定されている場合

- NTP適用なしで、2つ以上のモニタリング対象のサーバー時間が異なる場合

### タイムセレクタ照会範囲の指定

収集時間の基準時間変更により、タイムセレクタも**WhaTap収集サーバー時間**を基準に動作します。 これによって**エージェント収集時間**と**WhaTap収集サーバー時間**に差が生じ、照会範囲に含まれないログが発生することがあります。 この場合、照会範囲を広く指定することで照会できます。

### ログトレンド

***ログトレンド***推移チャートのX軸の基準は最小1分です。 ログ基準時間が変更された後も、チャートを通じた全体的な推移把握には影響しません。

### ログの検索

ログメッセージにログ生成時間を示すインデックスである`agenttime`が追加されました。 `agenttime`値を使用してエージェントの収集時間を確認してください。

:::note 

UTC(Coordinated Universal Time)基準の**WhaTap収集サーバー時間**は、ユーザーブラウザ時間に応じて変換して表記します。

> 例）日本の場合、UTC+9を基準に時間を表記します。 

:::

## 段階別基準時間

ログは、次の3つの過程を経て収集されます。 過程ごとに異なる基準時間が使用されることがあります。 

1. **ログ発生時間**

   モニタリング対象の時間、もしくはLoggingポリシーによって違いが生じることがあります。 

2. **エージェント収集時間** 

   使用中のサービス、またはエージェントがログを収集する方法とログによって違いが発生することがあります。 

   - **Application**

     設定に応じて、ログライブラリまたはログファイルからリアルタイムに近くログを収集します。

     :::note 

     ログライブラリは、Java製品に限って対応します。 

     :::

   - **Server** 

     ログファイルからリアルタイムに近くログを収集します。 

   - **AWS Log**

     AWS Resourceポリシーに従って、準リアルタイムまたは数分ごとにログを収集します。 

3. **WhaTap収集サーバー時間**

   モニタリング対象、またはログの作成方法に関係なく、収集サーバーに保存される時間を使用します。 

**WhaTapエージェント収集時間**と**WhaTap収集サーバー時間**には、大きな差があります。 モニタリング対象のサーバー時間を確認してください。 モニタリング対象のサーバー時間が過去、もしくは未来の時間に設定されている場合、エージェントの収集時間に影響します。
