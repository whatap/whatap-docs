---
id: kafka-introduction
title: KAFKAモニタリング
description: この文書は、KAFKAモニタリング商品の紹介ページです。
displayed_sidebar: featuremonitorSidebar
toc_max_heading_level: 2
keywords:
  - KAFKA
  - Feature
---

import InstallFeature from '../common-items/_import_feature-install-agent.mdx';
import AlertFeature from '../common-items/_import_feature-alert.mdx';
import TR from '@site/src/components/TR';

:::note

**Featureプロジェク**<ScrollToLink anchor='feature-project' />

WhaTapは、ユーザーが希望するソフトウェアのモニタリング支援の有無を簡単に確認し、簡単にモニタリングを開始できるように、新しく**Featureプロジェク**(<code class='Features'>Features</code>)を導入しました。 Featureプロジェクは、既存のモニタリング製品を、ユーザーがモニタリングしようとするソフトウェアに合わせてリパッケージし、最適化されたモニタリングソリューションを提供します。 WhaTapのFeatureプロジェクを通じて、サービスの安定性と性能をより効果的に管理します。 

:::

KAFKAは、リアルタイムのデータフィードを処理して安定的に保存し、送信する作業に最適化された分散型ストリーミングプラットフォームです。 KAFKAを使用して、データストリームの異常現象を追跡できます。 KAFKAは分散型システムであるため、モニタリングを通じて、各ブローカー、トピック、パーティション、プロデューサー、およびコンシューマーの状態を詳細に確認する必要があります。 

WhaTapは、新しい**Featureプロジェク**方法で**_KAFKA_**モニタリングを提供します。 KAFKAクラスターの性能と状態を追跡し、問題を早期に検出し、解決するのに役立ちます。

- **メトリクスモニタリング**: KAFKAブローカー、トピック、パーティション、プロデューサー、コンシューマーの様々なメトリクスをリアルタイムでモニタリングします。

- **カスタマイズされたダッシュボード**: カスタマイズされたダッシュボードにより、メトリクスを効率的に照会できます。

- **通知設定**: 設定した条件を検知時、リアルタイムで通知を送信してユーザーが問題に迅速に対応できます。

WhaTap**_KAFKA_**モニタリングを通じてKAFKAの複雑な運営環境を効果的に管理してみてください。

## インストール

WhaTapのKAFKAモニタリングサービス利用のための基本設置方法をご案内します。 

WhaTapモニタリングサービスを使用するには、[会員登録](https://www.whatap.io/ja/signup/)後、プロジェクトを作成し、ターゲットサーバーにエージェントをインストールする必要があります。 会員登録に関する詳細は、[次の文書](../account/account-manage)を参照してください。 

:::note 

**サポート環境**<ScrollToLink anchor='kafka-supported-env' />

WhaTapのKAFKAモニタリングエージェントをインストールする前に、サポート環境を確認してください。 

- **Kafka**: Apache Kafka 3.x以降

- **Ubuntu**: Ubuntu 12.04以降

- **OS**: Red Hat 6 or equivalent(CentOS, Rocky Linux, Amazon Linux)

- **OSアーキテクチャ**: Amd64/X86_64, Arm64/Aarch64

:::

### Featureプロジェクトを作成する

import Createprojectintrov2 from "../getting-started/_create-project-v2.mdx";

<Createprojectintrov2 />

### KAFKAエージェントのインストール

<InstallFeature name='KAFKAエージェントインストール' />

## メインメニュー

### カスタマイズされたダッシュボード

홈 화면 > **Featureプロジェク**(<code class='Features'>Features</code>)選択 > **_KAFKA_** > **_KAFKA ダッシューボード_**

WhaTapのKAFKAモニタリングは、KAFKAクラスターの性能と状態など、全体の現況を一目で把握できるよう、KAFKAブローカー、トピック、パーティション、プロデューサー、コンシューマーの様々なメトリクスをリアルタイムでモニタリングします。 各メトリクスを定期的に確認して、クラスターが最適な状態を維持するように管理できます。

WhaTapが提供するKAFKA**カスタマイズされたダッシュボード**は、次の3つのプリセットで構成されています。 

- **_Kafka Default_**

  **クラスター機能の動作有無**が把握できる基本ダッシュボードです。 KAFKAクラスターの全体的な状態をリアルタイムでモニタリングし、性能の低下や障害を事前に検知できるようにします。

  <details>
  <summary>ダッシュボードのメトリクス案内</summary>

  ##### Kafka Overview

  - **_Active Controller Count_**: 現在アクティブなコントローラーの数です。 コントローラーはKafkaクラスターでパーティションㅡリーダーとレプリケーションを管理します。 通常、1つのアクティブコントローラーが存在します。

  - **_Brokers Online_**: オンライン状態のブローカーの数です。 ブローカーは、メッセージを保存し、クライアントのリクエストを処理する役割を果たします。

  - **_Online Partitions_**: オンライン状態のパーティション数です。 各トピックは複数のパーティションに分けられ、各パーティションは複数のブローカーにわたって保存されます。

  - **_Preferred Replica Imbalance_**: 好まれるレプリカの不均衡を示します。 この値が高いと、特定のブローカーにレプリカが集中していることを意味します。

  - **_Under Replicated Partitions_**: レプリケートされていないパーティションの数です。 この値がゼロでない場合、データ損失のリスクがあります。

  - **_Leader Count per Broker_**: 各ブローカーごとのリーダーパーティションの数を示します。 リーダーパーティションは、クライアントのリクエストを直接処理するパーティションです。

  - **_Unclean Leader Elections_**: 異常なリーダー選出の数です。 この値が高いと、クラスターの安定性に問題がある可能性があります。

  - **_Under min ISR Partitions_**: 最小ISR(同期されたレプリカ) 以下のパーティション数です。 ISRはデータの耐久性を保障します。

  - **_Offline Partitions Count_**: オフライン状態のパーティション数です。 パーティションがオフラインの場合、そのパーティションのデータにアクセスできません。

  - **_Broker Network Throughput_** `BytesOutPerSec`/`BytesInPerSec`: ブローカーのネットワーク処理量を示します。 1秒あたりの送信/受信バイト数をグラフで表示します。

  ##### Java Virtual Machine

  - **_CPU Usage_**: JVMのCPU使用率を示します。 CPU使用率が高いと、性能に影響を及ぼす可能性があります。

  - **_JVM Memory Used_**: JVMが使用中のメモリ量を示します。 周期的にメモリが増加し、Garbage Collection(GC) 後に減少するパターンを示します。

  - **_Time Spent in GC_**: Garbage Collection(GC)に費やされた時間を示します。 GC時間の増加が性能低下につながる可能性があります。

  ##### Linux Disk I/O

  - **_Linux Disk Read Bytes_**: ディスク読み取りバイト数を示します。 ディスクの読み取り/書き込み量が高いと、I/Oのボトルネックが生じる可能性があります。

  - **_Linux Disk Write Bytes_**: ディスク書き込みバイト数を示します。 読み取りと同様に、書き込み量が高いと、性能に影響を及ぼす可能性があります。

  </details>

- **_Kafka Request_**

  **コンシューマーとプロデューサーに関連する処理性能**が確認できるダッシュボードです。 Kafkaクラスターの様々な性能メトリクスをリアルタイムでモニタリングし、システムの状態を把握し、潜在的な問題を早期に検知できるようにします。

  <details>
  <summary>ダッシュボードのメトリクス案内</summary>

  ##### Processing Performance

  - **_Messages In_**: クラスター全体で1秒あたりに受信されるメッセージの数を示します。

  - **_Messages In per Broker_**: 各ブローカーごとに1秒あたりに受信されるメッセージの数を示します。

  - **_Bytes In_**: クラスター全体で1秒あたりに受信されるバイト数を示します。

  - **_Bytes In per Broker_**: 各ブローカーごとに1秒あたりに受信されるバイトの数を示します。

  - **_Request Queue Size_**: 現在処理されていないリクエストが、待機中のキューのサイズを示します。 キューのサイズが大きくなると、応答時間が長くなる可能性があります。

  - **_Response Queue Size_**: 応答待ちのリクエストが待機中のキューのサイズを示します。 キューのサイズが大きくなると、遅延が発生する可能性があります。

  - **_Network Processor Avg Usage Percent_**: ネットワークプロセッサの平均使用率を示します。 ネットワーク関連作業の負荷を示します。

  - **_Request Handler Avg Percent_**: リクエストプロセッサの平均使用率を示します。 リクエスト処理に対する負荷を示します。

  ##### Requests

  - **_Produce Request Per Sec_**: 1秒あたりに生成されるプロデューサーリクエストの数を示します。 高い値は、多くのデータがブローカーに送信されていることを意味します。

  - **_Consume Fetch Request Per Sec_**: 1秒あたりに生成されるコンシューマーのfetchリクエスト数を示します。 高い値は、多くのデータがコンシューマーに送信されていることを意味します。

  - **_Broker Fetch Request Per Sec_**: ブローカー間のfetchリクエスト数を示します。 データコピー用の内部トラフィックを表示します。

  - **_All Request Per Sec Across All Brokers_**: すべてのブローカーで処理される1秒あたりのリクエスト数を示します。 クラスター全体のリクエスト負荷を示します。

  ##### Errors

  - **_Errors Per Sec_**: 1秒あたりに発生するエラー数を示します。 エラー数が多い場合、システムの安定性に問題がある可能性があります。

  ##### Offset Commit

  - **_Offset Commit Request Per Sec_**: 1秒あたりにコミットされるオフセットリクエストの数を示します。 オフセットコミットは、コンシューマーグループがメッセージを処理した位置を示します。

  ##### Metadata

  - **_Metadata Request Per Sec_**: 1秒あたりのメタデータのリクエスト数を示します。 メタデータのリクエストは、ブローカーとパーティション情報に対するリクエストを意味します。

  ##### Topic

  - **_IsrShrinks per Sec_**: 1秒あたりのISR(同期化されたレプリカ) 縮小イベントの数を示します。 ISRが縮小されると、データの耐久性に問題が発生する可能性があります。

  - **_IsrExpands per Sec_**: 1秒あたりのISR拡張イベント数を示します。 ISRが拡張されると、データの耐久性が向上する可能性があります。

  - **_Log size per Topic_**: トピックごとのログサイズを示します。 トピックデータのサイズを示します。

  - **_Log size per Broker_**: ブローカーごとのログサイズを示します。 ブローカーに保存されているデータのサイズを示します。

  ##### Consume Lag

  - **_Lag_**: メッセージ消費の遅延を示します。 プロデューサーがメッセージを書き込む速度より、コンシューマーがメッセージを読み取る速度が遅い時に発生します。

  </details>

- **_Kafka Broker_** 

  **ブローカーの性能情報**が確認できるダッシュボードです。 Kafkaクラスターの性能状態をリアルタイムでモニタリングし、潜在的な問題を早期に検知できるようにします。

  <details>
  <summary>ダッシュボードのメトリクス案内</summary>

  ##### Broker Performance - Produce

  - **_Producer - RequestQueueTimeMs_**: プロデューサーのリクエストがキューに待機する時間をミリ秒(ms) 単位で表示します。 キューの待ち時間が長くなると、性能の低下が発生する可能性があります。

  - **_Producer - LocalTimeMs_**: プロデューサーリクエストがローカルのブローカーで処理される時間をミリ秒単位で表示します。

  - **_Producer - RemoteTimeMs_**: プロデューサーリクエストがリモートブローカーに送信され、処理される時間をミリ秒単位で表示します。

  - **_Producer - ResponseQueueTimeMs_**: プロデューサーリクエストの応答が、キューに待機する時間をミリ秒単位で表示します。

  - **_Producer - ResponseSendTimeMs_**: プロデューサーリクエストの応答がクライアントに送信される時間をミリ秒単位で表示します。

  ##### Broker Performance - Consume

  - **_Consumer - RequestQueueTimeMs_**: コンシューマーリクエストがキューに待機する時間をミリ秒単位で表示します。

  - **_Consumer - LocalTimeMs_**: コンシューマーリクエストがローカルブローカーで処理される時間をミリ秒単位で表示します。

  - **_Consumer - RemoteTimeMs_**: コンシューマーリクエストがリモートブローカーに送信され、処理される時間をミリ秒単位で表示します。

  - **_Consumer - ResponseQueueTimeMs_**: コンシューマーリクエストの応答がキューに待機する時間をミリ秒単位で表示します。

  - **_Consumer - ResponseSendTimeMs_**: コンシューマーリクエストの応答がクライアントに送信される時間をミリ秒単位で表示します。

  ##### Broker Performance - Fetch Follower

  - **_FetchFollower - RequestQueueTimeMs_**: フォロワーブローカーのfetchリクエストがキューに待機する時間をミリ秒単位で表示します。

  - **_FetchFollower - LocalTimeMs_**: フォロワーブローカーのfetchリクエストがローカルブローカーで処理される時間をミリ秒単位で表示します。

  - **_FetchFollower - RemoteTimeMs_**: フォロワーブローカーのfetchリクエストがリモートブローカーに送信され、処理される時間をミリ秒単位で表示します。

  - **_FetchFollower - ResponseQueueTimeMs_**: フォロワーブローカーのfetchリクエストの応答がキューに待機する時間をミリ秒単位で表示します。

  - **_FetchFollower - ResponseSendTimeMs_**: フォロワーブローカーのfetchリクエストの応答がクライアントに送信される時間をミリ秒単位で表示します。

  ##### ZooKeeper

  - **_ZooKeeper Request Latency_**: ZooKeeperリクエストの遅延時間を表示します。 高い遅延時間は、ZooKeeperの性能低下を示すことがあります。

  - **_ZooKeeper Connections per sec_**: 1秒あたりにZooKeeperに生成される接続数を表示します。

  - **_ZooKeeper Expired Connections per sec_**: 1秒あたりに満了したZooKeeper接続数を表示します。 接続のアクティブ期限は、セッションのタイムアウトなどで発生する可能性があります。

  - **_ZooKeeper auth failures per sec_**: 1秒あたりにZooKeeper認証の失敗回数を表示します。 認証の失敗が多い場合は、セキュリティや設定エラーに問題がある可能性があります。

  - **_ZooKeeper disconnects per sec_**: 1秒あたりのZooKeeper接続が切断された回数を表示します。 接続が頻繁に切れると、ネットワークやZooKeeperサーバーの性能に問題がある可能性があります。

  </details>

### アラート通知

<AlertFeature name='KAFKA' />
