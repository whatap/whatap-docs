---
id: nvidia-gpu
title: NVIDIA GPU対応
description: KubernetesエージェントのGPU収集方法を案内します。
keywords:
  - Kubernetes
  - Kubernetesモニタリング
  - サポート環境
  - GPU
---

## WhaTap KubernetesエージェントのGPUメトリクス収集方法

WhaTap Kubernetesノード エージェントは、データセンターGPU管理者(DCGM) Exporterを使って NVIDIA GPUの性能メトリクスを収集し、モニタリングします。 その過程は、サイドカー(Sidecar) パターンを活用して構成されます。

- **サイドカーパターン**

  DCGM Exporterは、主アプリケーションコンテナとともに同じPod内で実行される補助コンテナとして設定されます。 このサイドカーパターンは、DCGM ExporterがGPU状態情報を効率的に収集できるようにサポートします。

- **DCGM Exporter** 

  `dcgm-exporter`コンテナは、NVIDIAのデータセンターGPU管理者(DCGM)を通じてGPUの状態と性能関連指標を収集します。 

- **メトリクスの収集と転送** 

  `whatap-node-agent`コンテナは、`dcgm-exporter`のHTTPエンドポイントを通じてGPUメトリクスを要請し、これを収集します。 

  :::note 

  `dcgm-exporter`のHTTPエンドポイントは、通常、ポート9400を使用します。

  :::

## 収集メトリクス

以下は、DCGM Exporterを通じて収集される主なGPUメトリクスの項目です。 

- **DCGM_FI_DEV_GPU_UTIL** <span class='type'>Gauge</span> 

  - GPU使用率を表すメトリクスで、現在のGPUの使用量をパーセンテージで表示します。 

- **DCGM_FI_DEV_MEM_COPY_UTIL** <span class='type'>Gauge</span>

  - メモリ使用率を表すメトリクスで、GPUメモリ帯域幅の使用量をパーセントで提供します。 

- **DCGM_FI_DEV_POWER_USAGE** <span class='type'>Gauge</span>

  - 現在のGPUの電力消費量をワット(W) 単位で表示するメトリクスです。 

- **DCGM_FI_DEV_TOTAL_ENERGY_CONSUMPTION** <span class='type'>Counter</span>

  - システム起動後に蓄積されたGPUの総エネルギー消費量をミリジュール(mJ) 単位で測定します。 

- **DCGM_FI_DEV_FB_FREE及びDCGM_FI_DEV_FB_USED** <span class='type'>Gauge</span>

  - 使用可能なフレームバッファ(Frame Buffer) メモリの容量と現在使用中のフレームバッファメモリの容量をメビバイト(MiB) 単位で示します。 

- **DCGM_FI_DEV_SM_CLOCK及びDCGM_FI_DEV_MEM_CLOCK** <span class='type'>Gauge</span>

  - 各GPUのストリーミングマルチプロセッサ(SM) クロック周波数とメモリクロック周波数をMHz単位で示します。 

- **DCGM_FI_DEV_GPU_TEMP及びDCGM_FI_DEV_MEMORY_TEMP** <span class='type'>Gauge</span>

  - 各GPUの温度とメモリ温度を摂氏(C) 単位で測定します。
