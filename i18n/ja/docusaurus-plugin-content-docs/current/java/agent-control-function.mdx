---
id: agent-control-function
title: エージェント機能の制御
description: Javaアプリケーションサーバーのモニタリングのためのエージェント機能を細かく調整する方法を案内します。エージェントの活性化・非活性化、トランザクションと性能カウンターの追跡、OS情報収集などの機能を含み、各機能を制御する様々な設定オプションを確認できます。
keywords:
  - Java
  - アプリケーション
  - エージェント
---

Javaアプリケーションサーバーのモニタリングのためのエージェント機能を細かく調整する方法を案内します。エージェントの活性化・非活性化、トランザクションと性能カウンターの追跡、OS情報収集などの機能を含み、各機能を制御する様々な設定オプションを確認できます。

- **shutdown** <span class='type'>Boolean</span>

  既定値`false`

  `true`場合は、エージェントのすべての動作を停止し、サーバーとの接続を終了します。

- **enabled** <span class='type'>Boolean</span>

  既定値 `true`

  機能のすべてを有効にします。`false`の場合でも、サーバーと最小限の通信を維持するために情報が送信されます。

- **transaction_enabled** <span class='type'>Boolean</span>

  既定値 `true`

  トランザクション追跡機能を有効にします。ヒットマップに記録されるトランザクション情報に対応します。`enabled`オプションが`'false`の場合、無効にします。

- **counter_enabled** <span class='type'>Boolean</span>

  既定値 `true`

  パフォーマンスカウンターを追跡する機能を有効にします。アクティブトランザクション数およびユーザ数、JVMリソースの使用量、Process CPUの使用量、DB Poolの使用量情報などが含まれます。`enabled`オプションが`false`の場合、無効にします。

- **stat_enabled** <span class='type'>Boolean</span>

  既定値 `true`

  統計情報を追跡する機能を有効にします。5分単位で収集するトランザクション、SQL、HTTPCALL、UserAgent、Client IPなどの統計データなどが含まれます。`enabled`オプションが`false`の場合、無効にします。

- **sigar_enabled** <span class='type'>Boolean</span>

  既定値`false`

  sigarライブラリによるOS情報の収集を有効にします。sigarライブラリを通じて5秒単位で収集するCPU、Memory、DiskなどのOSリソースデータが含まれます。`enabled`オプションが`false`の場合、無効にします。

  :::note

  - whatap.agent.2.1.0バージョン以下では既定値は`true`です。whatap.agent.2.1.0バージョン以降では既定値は`false`です。

  - Java 1.6以下のバージョン環境では、`sigar_enabled=true`オプションを追加してsigarライブラリを有効にし、パフォーマンス指標を収集できます。

  :::

- **active_stack_enabled** <span class='type'>Boolean</span>

  既定値 `true`

  アクティブスタックの追跡を有効にします。スタックメニューのトップスタック、ユニークスタック、アクティブスタックが対象です。`enabled`または`counter_enabled`オプションが`false`の場合、無効にします。

- **license** <span class='type'>String</span>

  エージェントのインストール時にサーバーから付与されたアクセスキーを入力します。 アクセスキーは、エージェントが属するプロジェクトとセキュリティ通信のためのパスワードキーが含まれます。

- **cypher_level** <span class='type'>aes_bit [128, 256]</span>

  既定値`128`

  AESセキュリティアルゴリズムの暗号レベルを設定します。256ビットまで拡張できます。AES256暗号化の設定については、[次の文書](aes-256-encryption)を参照してください。

- **encrypt_level** <span class='type'>encrypt_level [1, 2, 3]</span>

  既定値`2`

  WhaTapエージェントは、サーバーにデータを送信する際、データ属性に基づいて選択的に暗号化します。高いセキュリティを維持しながらも、パフォーマンス上の利点を持っています。データ タイプに関係なく、一括した暗号化ポリシーを適用するには、次のオプションを参照してください。

  - `1`：暗号化送信機能を無効
  - `2`：SQLパラメータ、Plain Textなどの機密属性の暗号化された転送
  - `3`：すべての項目の暗号化送信

- **stat_ip_enabled** <span class='type'>Boolean</span>

  既定値 `true`

  プロジェクトのサイドメニューの中、<Cmdname sid="side_statistics" className="uitext" /> &gt; <Cmdname sid="side_statRemote" className="uitext" />のメニューでIP統計の使用有無を有効にします。

  :::note 

  [次の文書](/java/analysis-apm-trs#client_tx_stat)を参考にしてください。

  :::

- **stat_ipurl_enabled** <span class='type'>Boolean</span>

  既定値`false`

  プロジェクトサイドメニューの中で<Cmdname sid="side_statistics" className="uitext" /> &gt; <Cmdname sid="side_statIp" className="uitext" />統計の収集有無を設定します。 

  :::note 

  [次の文書](/java/analysis-apm-trs#statiptx)を参照してください。

  :::

- **realtime_user_enabled** <span class='type'>Boolean</span>

  既定値 `true`

  プロジェクトのサイドメニューの中、<Cmdname sid="side_dashboard" className="uitext" /> &gt; <Cmdname sid="side_appDashboard" className="uitext" />メニューで確認できる指標のうち、<Cmdname sid="dashboard_user" className="uitext" />指標の収集有無を設定します。

- **hook_direct_patch_classes** <span class='type'>ClassFile_FullPath</span>

    特定のクラスをロードタイムに置き換えるときに直接使用します。クラスをコンパイルしてから別のファイルを作成し、そのファイルの完全パスを設定します。

- **active_stack_second** <span class='type'>Seconds</span>

  既定値`10`

  アクティブスタックを追跡する間隔を設定します。

  :::caution

  指定された既定値を変更しないことをお勧めします。

  :::

- **boot_redefine_size** <span class='type'>Int</span>

  既定値`100`

  エージェントをAttach方式またはWatcher方式でインストールされている場合、すでにロードされているクラスの追跡のためにBCIを新たに実行します。このとき、同時にredefineするクラスの数を設定します。

- **trace_component_enabled** <span class='type'>Boolean</span>

  既定値 `true`

  プロジェクトのサイドメニューの中、<Cmdname sid="side_agentsConfiguration" className="uitext" /> &gt; <Cmdname sid="side_libraryVersion" className="uitext" />のメニュー機能を有効にします。

- **realtime_user_thinktime_max** / **wclient_thinktime_max** <span class='type'>MiliSeconds</span>

  既定値`300000`

  リアルタイムにブラウザのユーザー数を測定する場合、同じユーザーとして認識される呼び出し間隔の最大値を設定します。

  :::note

  Javaエージェント 2.2.0 バージョン以降の場合は、 `wclient_thinktime_max` オプションを使用します。

  :::

- **time_sync_interval_ms** <span class='type'>MiliSeconds</span>

  既定値`300000`

  エージェントとサーバー間で同期化する時間の間隔を設定します。同期しない場合は、`0`に設定します。

- **detect_deadlock_enabled** <span class='type'>Boolean</span>

  既定値`false`

  Javaスレッドがデッドロック(DeadLock)しているかどうかをチェックして検知する場合、イベントを発生させます。発生間隔は5秒単位です。同じDeadLockに対するイベントは1時間に1回だけ発生します。

- **text_reset** <span class='type'>Int</span>

  既定値`0`

  WhaTapエージェントは、送信されるテキストタイプのデータをhash処理するため、翌日まで再送信されません。以前の設定値と異なる値を入力する場合は、再度送信します。

  :::note

  トランザクションURL、SQL Stringなどがテキストタイプデータに対応します。

  :::
