---
id: agent-name
title: エージェント名の識別
description: モニタリング対象を識別するエージェント名を設定する方法を提供します。
tags:
  - Java
  - エージェント名
---

{@include: ../common-items/_apm-name-description.mdx}

{@include: ../common-items/_agent-name-warning.mdx}

:::note

-   WhaTapモニタリンサービスでは、モニタリング対象をオブジェクトまたはエージェントとして混在して使用できます。

:::

## デフォルト名の決定方法

JVMオプションで`whatap.oname`設定がない場合、エージェント名に次の優先順位で自動的に割り当てられます。

1.  `whatap.type`を特定します。
2.  `whatap.type`がサーブレットコンテナの場合、アプリケーションが使用するポートを識別します。
3.  ポートを特定できない場合は、process ID(PID)を検索します。
4.  識別された情報にIPv4アドレスの3番目と4 番目を追加して、最終的に名前を決定します。

例えば、IPアドレスが10.11.**12**.**13**のサーバーで**Tomcat**が**8080**番ポートで起動した場合、`TC-12-13-8080`名でエージェント名が自動的に割り振られます。

## エージェント名の変数

使用可能な名前の変数を次のように指定します。

| 変数     | 説明                                                                                                                           |
| ------ | ---------------------------------------------------------------------------------------------------------------------------- |
| 文字列    | 入力した文字列を使用します。                                                                                                               |
| {type} | コンテナタイプを自動的に識別して割り当てます。<br/>自動識別の対象：JAVA、 TOMCAT、 JBOSS、 RESIN、 SPRINGBOOT、 JETTY、 JEUS、 WEBLOGIC、 WEBSPHERE、 UNDERTOW、 PLAY |
| {ip0}  | IPv4アドレスのうち、1番目の単位を使用します。(例：**10**.11.12.13のうち**10**)                                                                        |
| {ip1}  | IPv4アドレスのうち、2番目の単位を使用します。(例：10.**11**.12.13のうち**11**)                                                                        |
| {ip2}  | IPv4アドレスのうち、3番目の単位を使用します。(例：10.11.**12**.13のうち**12**)                                                                        |
| {ip3}  | IPv4アドレスのうち、4番目の単位を使用します。(例：10.11.12.**13**のうち**13**)                                                                        |
| {pid}  | JavaのProcess ID(PID)を使用します。                                                                                                  |
| {port} | アプリケーションがListenするポートを使用します。                                                                                                  |

## エージェント名の設定

起動スクリプトにJVMオプションを追加して、自動的に指定する名前の代わりに独自の名前を設定することができます。

| プライオリティ  | オプション           | 設定位置        | 説明                                                                         |
| -------- | --------------- | ----------- | -------------------------------------------------------------------------- |
| 1        | \-Dwhatap.name  | JVM Options | アプリケーション名をパターンとして設定します。<br/>default: `{type}-{ip2}-{ip3}-{port}`           |
| 2        | \-Dwhatap.oname | JVM Options | アプリケーション名を固定値として設定します。<br/>`-Dwhatap.oname=front-{ip3}-{port}`             |

:::note

-   クラウドのScale Out環境では、VMをコピーして使用できます。したがって、オブジェクト名が自動的に付与されることが重要です。
-   2つのVPC環境を作成し、同じprivate IPを使用するようにネットワークを構成した場合、2つのVPCが重複しないようにする必要があります。例えば、別々のプロジェクトに分割したり、`-Dwhatap.name`オプションと名前変数を異なる方法で設定することができます。

:::

次は、_whatap.conf_ファイルにエージェント名で適用できるオプションです。

{@include: ../common-items/_java-agent-name.mdx}
