<InDoc product='aws-log'>

ホーム画面 > プロジェクト選択 > **_管理_** > **_ログ設定_**

</InDoc>

<InDoc product='log,postgresql,mysql'>

ホーム画面 > プロジェクト選択 > **_ログ_** > **_ログ設定_**

</InDoc>

**_ログ設定_**メニューで、ログモニタリング関連の設定を行うことができます。 上部のタブからエージェント設定の確認、ログモニタリングをアクティブにするかどうかの決定、ログデータの保存期間および検索パスワード設定、ログパーサー登録、クイックインデックス設定などのメニューが使用できます。

:::note

- **_ログモニタリング有効化_**機能を使用するには、**プロジェクト修正**権限が必要です。 

- **ログ編集**権限では、**_ログモニタリング有効化_**機能と**_ログ設定_**メニューを修正できます。

:::

## ログモニタリングを開始する{#log-getting-started}

<InDoc product='aws-log'>

<ImgLang img='log-getting-started-aws.png' desc='ログモニタリングの開始 sc'/>

</InDoc>

<InDoc product='log'>

<ImgLang img='log-getting-started.png' desc='ログモニタリングの開始 sc'/>

</InDoc>

<InDoc product='postgresql,mysql'>

<ImgLang img='log-getting-started-db.png' desc='ログモニタリングの開始'/>

</InDoc>

<Xclude product='postgresql,mysql'>

上部にある**_ログモニタリングを開始する_**タブを選択してください。 ![WhaTap Docsアイコン](/img/ic-guide.svg) **_ガイドを表示_**アイコンと**_料金プランを表示_**ボタンを選択すると、関連したガイド画面に移動します。 

</Xclude>

<InDoc product='postgresql,mysql'>

上部にある**_ログモニタリングを開始する_**タブを選択してください。 ![WhaTap Docsアイコン](/img/ic-guide.svg)**_ガイドを表示_**アイコンを選択すると、関連するガイド画面に移動します。 

</InDoc>

### エージェント設定とログモニタリングの有効化{#log-set-up}

<InDoc product='aws-log'>

![number 1](/img/number-01.png)領域の**_ログモニタリング有効化_**トグルボタンを使用してログモニタリングの有効化・無効化を設定してください。

<ImgLang img='log-start-aws.png' desc='ログモニタリングの開始'/>

- ![アイコン](/img/ic-toggle-on.svg)トグルボタンをオンにすると、ログモニタリンがアクティブになります。 アクティブ化した日から15日間無料で体験できます。
- ![アイコン](/img/ic-toggle-off.svg)トグルボタンをオフにすると、ログモニタリンが無効化されます。 これ以上ログを保存しません。 

</InDoc>

<InDoc product='log,postgresql,mysql'>

![number 1](/img/number-01.png)領域でエージェント設定を確認し**_ログモニタリングの有効化_**トグルボタンでログモニタリングの有効化・無効化を設定してください。

#### エージェント設定確認{#log-check-agent-settings}

<Xclude product='postgresql,mysql'>

ログモニタリングを開始するために、エージェントのバージョンと設定情報を確認してください。 **_エージェント設定確認_**メニューを選択して、説明通りにプロセスを進めてください。

- **アプリケーションモニタリング**

  **_適用する_**メニューの下にある固有のアプリケーション手順を確認してください。 次の説明書[Java](log-java)、[PHP](log-php)、[Python](log-python)、[Go](log-go) などを参照してください。

- **サーバーモニタリング**

  **_適用する_**メニューの下にある固有のアプリケーション手順を確認してください。 [次の文書](log-server)を参照してください。 指示に従って_whatap.conf_にログモニタリング対象ファイルの設定を追加してください。

- **Kubernetesモニタリング**

  **_適用する_**メニューの下にある固有のアプリケーション手順を確認してください。 [次の文書](log-k8s)を参照してください。 

</Xclude>

<InDoc product='postgresql,mysql'>

ログモニタリングを開始するために、エージェントのバージョンと設定情報を確認してください。 エージェント設定に関する詳細は[次の文書](log-db)を参照してください。

</InDoc>

#### ログモニタリングの有効化{#log-activate}

**_ログモニタリング有効化_**メニューを選択して、ログモニタリングの有効化または無効化を設定してください。

<Xclude product="postgresql,mysql">

<ImgLang img='log-start.png' desc='ログモニタリングを開始する'/>

</Xclude>

<InDoc product='postgresql,mysql'>

<ImgLang img='log-start-db.png' desc='ログモニタリングの開始'/>

</InDoc>

- ![アイコン](/img/ic-toggle-on.svg)トグルボタンをオンにすると、ログモニタリンがアクティブになります。 アクティブ化した日から15日間無料で体験できます。 
- ![アイコン](/img/ic-toggle-off.svg)トグルボタンをオフにすると、ログモニタリンが無効化されます。 これ以上ログを保存しません。 

</InDoc>

### ログモニタリングデータ設定{#log-data-setting}

![number 2](/img/number-02.png)領域で**_ログ使用量_**が確認できます。 また**_データ保持期間_**および**_ログ参照パスワード_**設定を変更できます。

#### データ保持期間{#data-retention}

共通に適用する基本(default) データ保持期間です。 未指定の場合、デフォルト値は1日です。 カテゴリごとのデータ保存期間を個別で設定しない場合は、このデータ保存期間がデフォルトとして適用されます。 カテゴリごとにデータ保存期間を設定し、 **_初期化_**ボタンを選択すると、基本データの保存期間が初期化されます。

#### カテゴリ別のデータ保存期間{#data-retention-per-category}

カテゴリごとのログ データ保持期間を指定できます。 **ログ数**は、その期間中に蓄積されたログ行数を意味します。 例えば、**_本日のログ数_**は、その日に蓄積されたログライン個数、**_予想ログ数_**は、データ保持日に本日のログ数を掛けたログライン個数を意味します。 

ログデータの保存期間を次のように指定できます。 期間指定により、古いデータを削除してスペースを確保できます。

- **トライアルプロジェクト**  

  データ保存期間として1日、2日、3日を選択できます。

- **有料プロジェクト**  

  データ保存期間として1日、2日、3日、4日、5日、6日、7日、10日、30日、40日を選択できます。

- **保存量基準課金**   

  データの保存期間によってコストが異なります。

  > 例えば、1日平均200万ログが蓄積され、データ保存期間を3日に指定した場合、平均600万ログ行が収集サーバーに保持され、課金の対象となります。

#### ログ参照パスワード{#log-lookup-pw}

セキュリティを強化するため、**_ログ参照パスワード_**を設定してください。 ログ検索パスワードの指定はオプションです。 ログ検索パスワードを使用中の場合は、ログ画面に入るときは必ずパスワードを入力してください。 

:::note

**パスワードの紛失**

**ログ編集**権限がある場合は、**_ログ設定_**メニューで新しいパスワードに変更できます。

:::

## ログ1次パーサー設定{#log-setting-parser-1st}

**_ログ設定_**メニューの上部にある**_ログ1次パーサー設定_**タブを選択してログパーサーを登録または修正ができます。 ログ1次パーサーは、**_GROK_**と**_JSON_**パーサーを提供します。 収集されたログを使用して、パターンの条件と一致するキー情報、つまり検索キーと検索値を抽出します。 構文解析されたログキーは、ログのタイプを分類するための用途および特定のログを検索するためのインデックス作成に使用します。 タイプ別ログ発生数を集計したり、特定のログをすばやく特定するために登録に必要なパーサーです。

- **_GROK_**：基本的には、正規表現ベースの構文解析に対応します。 予約キーワードベースの構文解析を提供します。

- JSON\*\*\*\*: JSON として出力されるログの部分のバッチ解析を提供します。

:::note 

**パーシングロジックが未登録時に検索可能なkey**

`category`, `oid`, `oname`, `okind`, `okineName`, `@txid`, `@login`, `httphost` 

:::

:::note

**パーサで登録のできない予約語**

次の予約語の場合、パーサを登録してもインデックスは作成されません。

`timestamp`, `message`, `pcode`, `category`, `content`, `logContent`

:::

:::note 

ログパーサの詳細については、[次の文書](log-parser)を参照してください。

:::

### 設定項目{#log-parser-comp}

| 設定値    | 説明                                                                                           | その他      |
| ------ | -------------------------------------------------------------------------------------------- | -------- |
| カテゴリ   | パターンを適用するカテゴリです。                                                                             | required |
| ログ検出条件 | フィルターとして適用する検索キー、検索値を入力します。 ログ検出条件を満たすログデータにパターンを適用します。 ログ検出条件を入力しない場合、すべてのログを対象にパターンを適用します。 | optional |
| パターン   | ログを構文解析(parsing)するパターンです。 作成したパターンに合わせて構文解析を行い、インデックスを作成します。 GROK、正規表現構文に対応します。              | required |

### パーサー一覧{#log-parser-list-1st}

<ImgLang img='log-1st-parser-list.png' desc='ログパーサー一覧'/>

**_ログ設定_**メニューの上部の**_ログ1次パーサー設定_**タブを選択すると、登録したパーサーが表示され、追加および編集が可能な**_パーサー一覧_**画面を確認できます。 

- 右上の**_+追加する_**ボタンを選択すると**_パーサー追加_**ウィンドウが表示されます。

- パーサー一覧**_適用順序_**カラムの![](/img/ic-drag-drop.svg)アイコンをドラッグしてパーサーの設定手順を変更できます。

- パーサー一覧![アイコン](/img/ic-toggle-on.svg) **_有効_**トグルでパーサーを有効の有無を指定できます。

- パーサー一覧![修正アイコン](/img/ico-edit.svg) **_修整_**及び![削除アイコン](/img/ico-trash-red.svg) **_削除_**アイコンで登録したパーサーを修正または削除できます。

### パーサー登録手順{#log-add-parser-1st}

**_ログ設定_**メニューの上部にある**_ログ1次パーサー設定_**タブを選択してログパーサーを登録または修正ができます。 次に、パーサー登録時の共通手順について説明します。

<ImgLang img='log-1st-parser-add.png' desc='ログパーサー sc 追加'/>

1. **_+追加する_**ボタンを選択すると**_パーサー追加_**ウィンドウが表示されます。

2. **_パーサー_**選択ウィンドウからパーサーを選択してください。 各パーサーおよびパターン登録の詳細については、次の文書を参照してください。

   - **_GROK_** [パーサーおよびパターン登録](#log-pattern-grok)

   - **_JSON_** [パーサーおよびパターン登録](#log-pattern-json)

3. **_カテゴリー_**選択ウィンドウからカテゴリを選択するか、直接入力してください。 

4. **_ログ検出条件_**として使用する**_検索キー_**と**_検索値_**を選択するか、直接入力してください。

  フィルター条件に合ったログデータのみパターンを適用します。 **_ログ検出条件_**を指定しない場合は、すべてのログにパターンを適用します。

1. **_パターン_**を入力してください。 

2. 登録したいパターンが正常な場合は、**_シミュレーション_**ボタンをクリックしてシミュレーション及びパターンのパフォーマンスを測定してください。

  シミュレーションと性能測定の詳細については、[次の文書](#parser-simulation)を参照してください。

1. シミュレーション結果が正常である場合は、**_追加_**ボタンを選択してパーサーを登録してください。

:::note

ログパーサ登録時、同じ**_カテゴリ_**のパーサを重複登録することはできません。

:::

### GROKパーサーパターン登録{#log-pattern-grok}

<ImgLang img='log-1st-grok.png' desc='GROKパターンパーサー'/>

基本文法は、`%{SYNTAX:SEMANTIC}`です。 GROKパーサの詳細は、[次の文書](log-parser#grok-parser-detail)を参照してください。

- **SYNTAX**

  GROK定義パターンです。

- **SEMANTIC**

  パーシングされたデータに割り当てるキーです。

  :::note 

  SEMANTICでは、予約語を使用しないように、組み合わせ語の使用を推奨しています。

  :::

### JSONフォーマットのパーサーパターン登録{#log-pattern-json}

<ImgLang img='log-1st-json.png' desc='JSONフォーマットパーサーパターン登録'/>

ログ全体または一部がJSON形式で出力される場合、JSONフォーマットのパーサーを使用して、JSONに出力された部分をパーシングすることができます。 ログのうちJSON形式として出力された部分を検出するために、**_Prefix_**、**_Postfix_**オプションを組み合わせてログのどの部分をJSONとして認識してパーシングするかを指定します。 JSONパーサーの詳細は、[次の文書](log-parser#json-parser-detail)を参照してください。

| オプション    | 説明                                                                                                             |
| -------- | -------------------------------------------------------------------------------------------------------------- |
| プレフィックス  | JSON文字列の先頭の前にある文字列を指定します。 未指定時、ログ出力文の先頭からJSON文字列として識別します。                                                      |
| ポストフィックス | JSON文字列の末尾部分の文字列を指定します。 未指定時、ログ出力文の末尾部分までJSON文字列として識別します。                                                      |
| 無視する     | JSON 出力のどのフィールドを除外するかを指定します。                                                                                   |

- **登録例**

  ```bash title='Log'
  [2022-10-25 10:15:34:145]...(改行)
  Request : {"key1":"value1","key2":"value2",...}(改行)
  Response : {"key3":"value3","key4":"value4",...}
  ```

  例のように受信ログでRequest JSON、Response JSONをすべてパーシングしたい場合は、次の2つのパターンを登録します。

  - Requestパーシング用のパターン  

    > "Request："と"Response"間の文字列`{"key1":"value1","key2":"value2",...}`を対象とします。

  - Reponseパーシング用のパターン

    > "Response："からログの末尾までの文字列`{"key3":"value3","key4":"value4",...}`を対象とします。
- **JSONカスタムパターンの登録**

  ログの一部がJSON形式で出力される場合、JSONで出力された部分を専用カスタムパーサーを使用してパーシングできます。 パターンを次のように入力してください。

  ```java
  io.whatap.logsink.parser.JsonFormatParser{}
  ```

  ログのうちJSON形式として出力された部分を検出するために、**_Prefix_**、**_Postfix_**オプションを組み合わせてログのどの部分をJSONとして認識してパーシングするかを指定してください。

  `JsonFormatParser{}`の`{}`にオプションを指定します。

  - **登録例**

    ```bash title='Log'
    [2022-10-25 10:15:34:145]...(改行)
    Request : {"key1":"value1","key2":"value2",...}(改行)
    Response : {"key3":"value3","key4":"value4",...}
    ```

    例のように受信ログでRequest JSON、Response JSONをすべてパーシングしたい場合は、次の2つのパターンを登録します。

    - Requestパーシング用のパターン  
      > "Request："と"Response"間の文字列`{"key1":"value1","key2":"value2",...}`を対象とします。

    ```java
    io.whatap.logsink.parser.JsonFormatParser {prefix:"Request : ",postfix:"Response"}
    ```

    - Reponseパーシング用のパターン
      > "Response："からログの末尾までの文字列`{"key3":"value3","key4":"value4",...}`を対象とします。

    ```java
    io.whatap.logsink.parser.JsonFormatParser {prefix: "Response : "}
    ```

### パーサーシミュレーション{#parser-simulation}

1. パーサー追加画面でパターンを入力した後**_シミュレーション_**ボタンを選択してください。 **_パーサーシミュレーション_**ウィンドウが表示されます。 

2. **_パーサーシミュレーション_**ウィンドウで**_ログ_**を入力してください。 

3. 入力した**_ログ_**と**_パターン_**を確認してください。

<ImgLang img='log-parser-simulation.png' desc='パーサーシミュレーション'/>

1. **_シミュレーション_**ボタンを選択して登録するパターンで、パーシングが成功するか確認してください。 

   - **シミュレーションの成功画面**

     <ImgLang img='log-simulation-success.png' desc='シミュレーションの成功'/>

   - **シミュレーションの失敗画面**

     <ImgLang img='log-simulation-fail.png' desc='シミュレーション失敗'/>

2. **_パターン適用_**ボタンをクリックすると、選択したパーサーに入力したパターンが適用されます。 

### パフォーマンス測定{#log-performance}

シミュレーションの成功後**_パフォーマンス測定_**ボタンを選択して、パーサーのパフォーマンスを測定できます。 シミュレーションを実行する文字列にパーサーの構文解析が繰り返される所要時間を測定した後、次のように測定結果を確認してください。

<ImgLang img='log-performance.png' desc='パフォーマンス測定'/>

### 構文解析の成功{#log-parsed}

構文解析ロジックを登録して**キー**(key)を生成すると、ログ検索時にキーで構文解析された値が追加されます。 次の**_ライブテール_**メニュー例のように、構文解析されたキーと値が追加されます。 

<ImgLang img='log-parsed.png' desc='パーシング成功'/>

パーシングされたキーは**_ライブテール_**、**_ログ検索_**、**_ログトレンド_**で確認できます。

## ログ2次パーサー設定{#log-setting-parser-2nd}

**_ログ設定_**メニューの上部にある**_ログ2次パーサー設定_**タブを選択して、ログパーサーを登録または修正できます。 **_4xx、5xxステータスコードパーサー_**と**_ステータスコード成功率パーサー_**を提供します。 ログ2次パーサーは、GROKまたはJSONのような1次パーサーが構文解析された場合に使用できるパーサーです。 1次パーサーで抽出した値を処理して統計データを生成します。 ウェブまたはAPIレスポンスログのHttp Status Codeに基づいて2次統計を抽出します。

- **_4xx、5xxステータスコードパーサー_**：異常レスポンスに関する件数情報を集計します。

- **_ステータスコード成功率パーサー_**：全体の件数に対する異常レスポンスの割合を抽出します。

:::note

ログの2次パーサーは、1次構文解析された結果に対して、専用の2次構文解析機能を提供します。 2次パーサーを使用するには、**1次パーサー**を**登録**する必要があります。

:::

### パーサー一覧{#log-parser-list-2nd}

<ImgLang img='log-2nd-parser-list.png' desc='ログ2次パーサー一覧'/>

**_ログ設定_**メニューの上部にある**_ログ2次パーサー設定_**タブを選択すると、登録したパーサーが表示され、追加および編集が可能な**_パーサー一覧_**画面を確認できます。 

- 右上の**_+追加する_**ボタンを選択すると**_パーサー追加_**ウィンドウが表示されます。

- パーサー一覧**_適用順序_**カラムの![](/img/ic-drag-drop.svg)アイコンをドラッグしてパーサーの設定手順を変更できます。

- パーサー一覧![アイコン](/img/ic-toggle-on.svg) **_有効_**トグルでパーサーを有効の有無を指定できます。

- パーサー一覧![修正アイコン](/img/ico-edit.svg) **_修整_**及び![削除アイコン](/img/ico-trash-red.svg) **_削除_**アイコンで登録したパーサーを修正または削除できます。

### パーサー登録手順{#log-add-parser-2nd}

**_ログ設定_**メニューの上部にある**_ログ2次パーサー設定_**タブを選択して、ログパーサーを登録または修正できます。 次に、パーサー登録時の共通手順について説明します。

<ImgLang img='log-2nd-parser-add.png' desc='ログ2次パーサ登録手順'/>

1. **_+追加する_**ボタンを選択すると**_パーサー追加_**ウィンドウが表示されます。

2. **_パーサー_**選択ウィンドウからパーサーを選択してください。 各パーサー設定項目および除外するステータスコード登録の詳細については、次の文書を参照してください。

   - **_4xx、5xxステータスコードパーサー_** [設定項目および除外するステータスコード登録](#4xx-5xx-status-parser)

   - **_ステータスコード成功率パーサー_** [設定項目および除外するステータスコード登録](#log-pattern-status)

3. **_カテゴリー_**選択ウィンドウからカテゴリを選択するか、直接入力してください。 

4. **_ログ検出条件_**を選択するか、直接入力してください。

5. **_除外するステータスコード_**を入力してください。 

6. **_追加_**ボタンを選択してパーサーを登録してください。

### 4xx、5xxステータスコードをパーサーから除外するステータスコードを登録{#4xx-5xx-status-parser}

<ImgLang img='log-2nd-4xx5xx.png' desc='4XX 5XXステータスコードパーサー'/>

**_4xx、5xxステータスコードパーサー_**は、statusが既に構文解析されている場合に使用できるパーサーです。 構文解析されたstatusを利用して追加で4xx、5xステータスコードを構文解析します。 構文解析したデータで4xx、5xx件数データを作成できます。 除外するステータスコードとして、4xx、5xxステータスコードを入力または選択できます。 入力されたステータスコードは、ログから4xx、5xxステータスコードを構文解析するときに除外されます。 

#### 設定項目{#log-parser-comp-4xx5xx}

| 設定値          | 説明                                                                                                    | その他      |
| ------------ | ----------------------------------------------------------------------------------------------------- | -------- |
| カテゴリ         | 4xx、5xxデータを生成するカテゴリです。                                                                                | required |
| ログ検出条件       | フィルターとして適用する検索キー、検索値を入力します。 ログ検出条件を満たすログデータに対してのみ、4xx、5xxデータを生成します。 ログ検出条件を入力しない場合は、すべてのログのデータを生成します。 | optional |
| 除外するステータスコード | 統計データの作成時に除外するステータスコードです。 未入力の場合は、4xx~5xxに対応するエラーステータスコード全体を対象に4xx、5xxデータを生成します。                      | optional |

#### statusパーサーの登録例

<ImgLang img='log-2nd-4xx5xx-status.png' desc='GROKパーサー - status構文解析パターン登録'/>

受信ログが`{"msg":"message","status":404}`で、例のようにGROKパーサーでstatusを構文解析する場合、`status: 404`のように構文解析されます。 statusが正しく構文解析されていることを確認したら、4XX、5XXステータスコードパーサーから除外するステータスコードを登録してください。     

#### データ参照

パーサーをすべて登録すると、**_Flexボード_**に移動して**_ログ4XX、5XX_**ウィジェットを作成してください。

<ImgLang img='log-flexboard-widget.png' desc='Log Flex board widget-4xx5xx'/>

ウィジェットを作成すると、次のようにデータを確認できます。

<ImgLang img='log-flexboard-widget-chart-4xx5xx.png'desc='Log Flex board widget chart - 4xx5xx'/>

- **_avg_**：参照期間データの平均値です。

- **max**：参照期間データの最大値です。

- **_recently_**：参照期間のデータの最後の値です。

### ステータスコードの成功率をパーサーから除外するステータスコード登録{#log-pattern-status}

<ImgLang img='log-2nd-status.png' desc='ステータスコード成功率パーサー'/>

**_ステータスコード成功率パーサー_**は、statusが既に構文解析されている場合に使用できるパーサーです。 status構文解析に関する内容は、[次の文書](#4xx-5xx-status-parser)を参照してください。 構文解析されたstatusを利用して追加で2xx、3xxステータスコードを構文解析します。 構文解析したデータを使用して、HTTPリクエスト成功率データを生成できます。 除外するステータスコードは、2xx、3xxステータスコードを入力または選択できます。 入力されたステータスコードは、ログから2xx、3xxステータスコードを構文解析するときに除外されます。 

#### 設定項目{#log-parser-comp-status}

| 設定値          | 説明                                                                                                | その他      |
| ------------ | ------------------------------------------------------------------------------------------------- | -------- |
| カテゴリ         | リクエスト成功率データを生成するカテゴリです。                                                                           | required |
| ログ検出条件       | フィルターとして適用する検索キー、検索値を入力します。 ログ検出条件を満たすログデータのみリクエスト成功率データを生成します。 ログ検出条件を入力しない場合は、すべてのログのデータを生成します。 | optional |
| 除外するステータスコード | リクエスト成功率データの作成時に除外するステータスコードです。 未入力のままにすると、全体的な成功状態コード 2xx~3xx の要求成功率データを生成します。                   | optional |

#### データ参照

パーサーをすべて登録したら、**_Flexボード_**に移動し、ログリクエスト成功率のウィジェットを作成してください。  

<ImgLang img='log-flexboard-widget-scs.png' desc='ログリクエスト成功率のウィジェットテンプレート'/>

ウィジェットを作成すると、次のようにデータを確認できます。

<ImgLang img='log-flexboard-widget-chart-scs.png'desc='Log Flex board widget chart request success rate widget chart - 4xx5xx'/>

チャート上のデータは、参照期間に関する統計を示します。 統計方法としては最近値、最大値、平均値などを選択できます。 最近は、値がデフォルトとして選択されています。

## 高速インデックス設定{#log-setting-index}

**_ログ設定_**メニューの上部にある**_クイックインデックス設定_**タブを選択してください。 大量のログを収集すると、ログ検索性能が著しく低下する可能性があります。 頻繁に使用する検索条件は、**インデックス**(index)で生成すると、ログ検索の性能が向上し、クイック ナビゲーションが可能になります。 設定項目は次のとおりです。

| 設定値                 | 必須の有無      | 説明                                    |
| ------------------- | ---------- | ------------------------------------- |
| カテゴリ                | 必須         | 高速クインデックスを設定するカテゴリ                    |
| 検索キー                | 必須         | 高速インデックスを設定する検索キー                     |
| 大文字と小文字を区別しない       | オプション      | 大文字と小文字を区別しますか                        |
| ルール                 | 必須         | `*` を少なくとも１つ以上を含める必要があります             |
| 活性                  | 必須         | アクティブ化または非アクティブ化の有無(デフォルト値`true`)     |

## ログ設定のインポート/エクスポート{#export-import-settings}

共通のパーサー設定及び<Cmdname sid="fast_index_setting" />の内容をJSONファイル形式で保存し、他のプロジェクトからJSONファイルをインポートして適用することができます。 プロジェクトごとに何度も繰り返し設定を作成する手間を省けます。

1. 1つのプロジェクトにパーサー設定および<Cmdname sid="fast_index_setting" />を追加してください。

2. 各設定タブで画面右上に**_JSON_**![エクスポートアイコン](/img/ico-export.svg)ボタンを選択してください。

3. <Cmdname sid="export_json" className="uitext" />ウィンドウが表示されると、画面右上にある<Cmdname sid="export" className="uitext" />ボタンを選択してください。

4. JSON設定ファイルがユーザーPCに保存されます。

5. 他のプロジェクトに移動してから、<Cmdname sid="log" className="uitext" />><Cmdname sid="log_setting" className="uitext" />メニューに移動してください。

6. まず、JSON設定ファイルをエクスポートした設定タブを選択し、![インポートアイコン](/img/ico-import.svg)ボタンを選択してください。

7. ファイル選択ウィンドウが表示されたら、ユーザーのPCに保存したJSON設定ファイルを選択してください。

8. <Cmdname sid="import_json" className="uitext" />ウィンドウが表示されたら、設定内容を確認しし、<Cmdname sid="add_to_list" className="uitext" />または <Cmdname sid="overwrite" className="uitext" />ボタンを選択してください。

9. 画面の右上にある<Cmdname sid="save" className="uitext" />ボタンを選択してください。

:::caution

JSON設定ファイルをインポートして、<Cmdname sid="save" className="uitext" />ボタンを選択しないと、インポートされた設定を保存することはできません。

:::

## ログ長期保存の統計設定{#log-long-term-archive}

**_ログ設定_**メニューの上部にある**_ログ長期保存の統計_**タブを選択してください。 ログデータは、非常に大容量のため、長期間保存することは困難です。 したがって、ログ統計データの設定機能を使用して**特定の条件を満たすログデータが5分ごとに何件収集されたかに関する情報を保存**することができます。 長期間に実際のログデータが削除されても、条件を満たすログがどれだけ収集されているかの推移を確認することができます。

<!-- 

>

![로그 장기 보관 통계](https://img.whatap.io/22/11/28/090932log_022_long_period_stat_config.png)

1. ***ログ長期保存の統計***タブで***+追加する***ボタンを選択してください。 ***ログ長期保存統計の追加***ウィンドウが表示されます。

1. ルールを適用する***カテゴリー***を選択してください。

1. ***データ保存期間***を選択してください。

1. ルールを満たすログ発生時に保存する***統計キー***を設定してください。 同じキーを重複設定することはできません。

1. ***ルール名***入力ウィンドウにルール名を入力してください。

1. ***タグ***を追加してください。

1. ***除外***にチェックを入れると、入力した条件を満たさない値に基づいて統計データが作成されます。

1. ***大文字・小文字の区分***にチェックされている場合、入力したルールの値で大文字と小文字の区分を指定します。

1. 生成ルールは、***-***アイコンで削除するか、***+追加する***ボタンで追加できます。

-->

### ログ長期保存統計の追加{#log-long-term-archive-add}

<ImgLang img='log-long-term-archive.png' desc='ログ長期保存の統計'/>

**_ログ長期保存統計_**タブで**_+追加する_**ボタンを選択すると**_ログ長期保存統計の追加_**ウィンドウが表示されます。 **_+追加する_**ボタンでルールを追加したり、作成したルールを**_-_**アイコンで削除できます。

#### 設定項目{#log-long-term-archive-comp}

| フィールド           | 説明                                                                                                                     |
| --------------- | ---------------------------------------------------------------------------------------------------------------------- |
| カテゴリ            | ルールが適用されるカテゴリです。                                                                                                       |
| 統計キー(key)       | 規則を満たすログが発生した場合、保存するキー値で同じキーを重複設定することはできません。                                                                           |
| ログ検出条件          | ログ統計データを生成する条件です。 この条件を満たすログが収集された数に基づいて統計データを生成します。                                                                   |
| 除外              | 除外をチェックすると、入力した条件を満たさない値で統計データを作成します。                                                                                  |
| 大小文字を区別する       | 入力したログ検出条件の値で大文字と小文字の区別有無を指定します。                                                                                       |
| 活性              | アクティブ化または非アクティブ化の有無(デフォルト値`true`)                                                                                      |

#### 例

次のように設定を追加した場合、収集されたログのうち、statusが`200`, `300`のログを対象に**_TotalCount_**のキー値で統計データを作成します。 

<ImgLang img='log-long-term-totalcount.png' desc='ログ長期保存統計の例'/>

### データ参照{#log-widget-statistics}

1. **_Flexボード_**の**_ウィジェットテンプレート_**で**_ログ長期保存統計_**を検索し、ウィジェットを作成してください。

   <ImgLang img='log-flexboard-widget-long-term.png' desc='長期保存統計ウィジェットテンプレート'/>

2. データを表示する**_カテゴリー_**と**_キー_**を指定して**_適用_**ボタンを選択します。

   <ImgLang img='log-flexboard-widget-setting-long-term.png' desc='長期保存統計ウィジェット - カテゴリおよびキーの選択'/>

3. 追加した設定で**_ログ長期保存統計_**データを次のように確認できます。

   <ImgLang img='log-flexboard-widget-chart-long-term.png' desc='長期保存統計ウィジェット'/>
