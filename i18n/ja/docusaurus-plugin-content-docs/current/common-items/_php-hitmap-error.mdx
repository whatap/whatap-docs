### 応答時間ヒートマップが表示されない

CPU とメモリのグラフは見えるが、応答時間分布図（ヒートマップ）が表示されない場合、以下の原因が考えられます。

* エージェントは収集サーバーに正常接続しているが、トレーサーが PHP 拡張モジュールに適用されていない
* 設定変更後に Apache または PHP-FPM を再起動していない

1. PHP モジュールの読み込みを確認します。

   * **Linux/FreeBSD**

   ```bash
   $ sudo php -m

   [PHP Modules]
   bz2
   calendar
   Core
   ctype
   curl
   date
   …
   whatap               # WhaTap モジュール読み込み確認
   …
   [Zend Modules]
   ```

   * **Windows**
   ```cmd
   php -m | findstr whatap
   ```

   * **正常出力例**
   ```
   whatap
   ```

2. Web サービスを再起動します。

   * **Windows**
   ```cmd
   REM Apache
   net stop Apache2.4 && net start Apache2.4

   REM IIS
   iisreset
   ```

3. 拡張モジュールの配置場所を確認します。

   * **Windows**
   ```cmd
   REM PHP 拡張ディレクトリ確認
   php -i | findstr extension_dir
   REM 出力例: extension_dir => C:\PHP\ext

   REM php_whatap.dll の存在確認
   dir "C:\PHP\ext\php_whatap.dll"
   ```

   ファイルが無い場合は手動でコピーします（確認した extension_dir を使用）。

   ```cmd
   REM PHP API バージョン確認
   php -i | findstr "PHP API"
   REM 例: PHP API => 20230831

   REM Thread Safety 確認
   php -i | findstr "Thread Safety"
   REM 例: Thread Safety => disabled

   REM 適切な DLL をコピー
   copy "C:\Program Files\WhaTap\PHP\modules\x64\php_whatap_20230831.dll" "C:\PHP\ext\php_whatap.dll"
   ```

4. PHP 設定ファイルを確認します。  
   *whatap.so* または *whatap.ini* のパスが PHP 環境と一致しているか確認します。

   * **Windows**
   ```cmd
   php --ini
   ```

5. ログを確認します。

   * **Windows**
   ```cmd
   REM インストールログ
   type "C:\Program Files\WhaTap\PHP\logs\whatap-install.log"

   REM 最新ブートログ
   dir "C:\Program Files\WhaTap\PHP\logs\whatap-boot-*.log" /O-D
   ```

:::note
以下の項目を確認してください：  
[PHP CLI パス](#check-php-cli-path)、  
[PHP 拡張モジュールパス](#check-php-extension-module)、  
[追加 ini パス](#php-ini-path)
:::
