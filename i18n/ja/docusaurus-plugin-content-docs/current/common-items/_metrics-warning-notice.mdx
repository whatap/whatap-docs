<Xclude product="npm">

ホーム画面 &gt; プロジェクト選択 &gt; <Cmdname sid="event_statistic" className="uitext" /> &gt; <Cmdname sid="event_setting" className="uitext" /> &gt; <Cmdname sid="metrics" className="uitext" />タブ選択

</Xclude>

<InDoc product="npm">

ホーム画面 &gt; プロジェクト選択 &gt; <Cmdname sid="event_statistic" className="uitext" /> &gt; <Cmdname sid="event_setting" className="uitext" />

</InDoc>

## メトリクスイベントとは

<Xclude product='npm,nms'>

メトリクスイベントは、基本イベント(アプリケーションイベント、サーバーイベントなど)より具体的で複雑なイベントを設定するために使用します。プロジェクトがリアルタイムで収集中のメトリクスデータに基づいてイベントを設定できます。使用状況に応じて、2つの設定方法のいずれかを選択してイベントを設定できます。

- メトリックスイベント
- 複合メトリクスイベント

</Xclude>

<InDoc product='npm,nms'>

メトリクスイベントは、基本イベント(アプリケーションイベント、サーバーイベントなど)より具体的で複雑なイベントを設定するために使用します。プロジェクトがリアルタイムで収集中のメトリクスデータに基づいてイベントを設定できます。

</InDoc>

<Xclude product="amazon-cloudwatch,amazon-ecs,azure,ncloud,oracle-cloud,nms">

:::note

- メトリクスの詳細については、[次の文書](metrics-intro)を参照してください。

- 新しいUIを適用してユーザーの利便性が強化された<Cmdname sid="side_eventSetting" className="uitext" /> <code class="newfunc">New</code>メニューでメトリクスイベントを追加できます。詳しい内容は、[次の文書](metric-warning-notice-new)を参照してください。

- <Cmdname sid="sms_alert_settings" className="b500" />権限のあるメンバーのみが利用できます。メンバー権限についての詳細は、[次の文書](../project/project-structure#project-auth)を参照してください。

:::

</Xclude>

<InDoc product="amazon-cloudwatch,amazon-ecs,azure,ncloud,oracle-cloud">

:::note

メトリクスの詳細については、[次の文書](metrics-intro)を参照してください。

:::

</InDoc>

{/* nms(Network Management System)의 경우 임시 */}

<InDoc product="nms">

:::note

<Cmdname sid="sms_alert_settings" className="b500" />権限のあるメンバーのみが利用できます。メンバー権限についての詳細は、[次の文書](../project/project-structure#project-auth)を参照してください。

:::

</InDoc>

## メトリックスイベント

<Xclude product="npm">

<Cmdname sid="event_statistic" className="uitext" /> &gt; <Cmdname sid="event_setting" className="uitext" />メニューから画面の上にある<Cmdname sid="metrics" className="uitext" />を選択します。画面の右上にある <Cmdname sid="add_notification" className="uitext" />を選択します。<Cmdname sid="metrics_event" className="uitext" />画面が表示されます。

</Xclude>

<InDoc product="npm">

<Cmdname sid="event_statistic" className="uitext" /> &gt; <Cmdname sid="event_setting" className="uitext" />メニューから画面の右上にある <Cmdname sid="add_notification" className="uitext" />を選択します。<Cmdname sid="metrics_event" className="uitext" />画面が表示されます。

</InDoc>

<ImgLang img='set-events-metrics.png' desc='メトリクスイベント' />

<InDoc product='kubernetes'>

:::note

メトリクスにイベントテンプレートの詳細については[次の文書](#template)を参照してください。

:::

</InDoc>

### 基本情報を入力{#basic-info}

- <Cmdname sid="event_name" className="uitext" />：追加するイベント名を入力します。

- <Cmdname sid="enable_events" className="uitext" />：イベントの活性化の有無を選択します。

- <Cmdname sid="template" className="uitext" />：作成されたテンプレートを選択して、簡単にイベントを設定できます。テンプレートを使用しない場合は、<Cmdname sid="metrics_option_disabled" className="uitext" />を選択します。

  <InDoc product='java,php,nodejs,python,golang,dotnet,postgresql,browser,npm'>

  :::note

  テンプレート一覧の詳細については[次の文書](#template)を参照してください。

  :::

  </InDoc>

- <Cmdname sid="category" className="uitext" />：メトリクス データを区切る単位です。メトリクスイベント設定時に必須の設定値です。

  <ImgLang img='set-event-select-category.png' desc='メトリクスイベント - カテゴリ' />

  - <Cmdname sid="category" className="uitext" />選択オプションは、<LinkImage img="number-01.png" className="ico" /> <Cmdname sid="name" className="uitext" />と<LinkImage img="number-02.png" className="ico" />データ収集間隔、<LinkImage img="number-03.png" className="ico" /> <Cmdname sid="key" className="uitext" />情報を表示します。イベントを設定する際には該当カテゴリのキーを使用します。

  - <Cmdname sid="category" className="uitext" />は、直近3時間以内にプロジェクトで収集されたメトリクスデータを照会し、一覧に表示します。<Cmdname sid="category" className="uitext" />選択オプションに収集間隔が表示されない場合は、<Cmdname sid="enter_category_self" className="uitext" />オプションを選択して、カテゴリキーを入力します。

- <Cmdname sid="level" className="uitext" />

  - イベント発生時の警告レベルを示します。<span class='vslow'>Critical</span>、<span class='slow'>Warning</span>、<span style={{color:'#757575'}}>Info</span>レベルで分けます。<span class='vslow'>Critical</span>、<span class='slow'>Warning</span>レベル設定時<Cmdname sid="CNT08320" className="uitext" />選択オプションが有効になります。

  - <Cmdname sid="CNT08320" className="uitext" /><ScrollToLink anchor='scrollTo-resolve-event' />: イベントの項目から発生した<Cmdname sid="CNT08320" className="uitext" />の送信可否を選択できます。トグルボタンを選択して機能をオンまたはオフできます。

- <Cmdname sid="message" className="uitext" />

  - イベント発生時に出力する通知メッセージを入力します。<code>&#36;&#123;Tag&#125;</code>または<code>&#36;&#123;Field&#125;</code>を入力してメッセージに変数を適用できます。変数に入力するキーは、選択したメトリクス データ<Cmdname sid="category" className="uitext" />に含まれる値である必要があります。<Cmdname sid="tag_count" className="uitext" />メニューで入力できるタグまたはフィールドキーを確認できます。

    <ImgLang img='event-config-message-example.png' desc='Message example' />

  - ![時間アイコン](/img/ico-timing.svg)ボタンをクリックすると、以前に入力したメッセージの履歴を確認できます。

- <Cmdname sid="alert_test" className="uitext" />

  必須項目である<Cmdname sid="event_name" className="uitext" />、<Cmdname sid="category" className="uitext" />、<Cmdname sid="level" className="uitext" />、<Cmdname sid="message" className="uitext" />情報に基づいて通知を発生させ、メッセージをチェックする機能です。

  :::note

  - テスト中は、実際のメトリクス値や変数への置換機能が機能しません。 

  - <Cmdname sid="TTL07415" className="uitext" />オプションで受信者タグが設定されているユーザーに限ってテスト通知を送信します。<Cmdname sid="ITM07419" className="uitext" />を選択した場合、すべてのユーザーにテスト通知を送信します。

  - 受信テストを利用するには、必須項目(<Cmdname sid="event_name" className="uitext" />、<Cmdname sid="category" className="uitext" />、<Cmdname sid="level" className="uitext" />、<Cmdname sid="message" className="uitext" />)に値を入力または選択する必要があります。

  :::

- <Cmdname sid="metrics_event_rules" className="uitext" /> <ScrollToLink anchor='eventcondition' />

  <ImgLang img='set-event-condition.png' desc='イベント発生条件' />

  ![指示線4](/img/number-04.png)フィールド、![指示線5](/img/number-05.png)演算子の選択、![指示線6](/img/number-06.png)しきい値を入力して、イベントが発生する条件を設定します。

- <Cmdname sid="alert_object_filtering" className="uitext" />

  <ImgLang img='set-event-filtering.png' desc='アラート通知対象のフィルタリング' />

  ![指示線7](/img/number-07.png)タグ、![指示線8](/img/number-08.png)演算子の選択、![指示線9](/img/number-09.png)フィルタリング値を入力して、ターゲットをフィルタリングします。入力がない場合は、全体エージェントにアラート通知を送信します。

:::note

- <Cmdname sid="metrics_event_rules" className="uitext" />と<Cmdname sid="alert_object_filtering" className="uitext" />で使用できる基本文法と演算子の一覧は、<Link to="#condition-guide">次の文書</Link>を参照してください。

- <Cmdname sid="metrics_event_rules" className="uitext" />と<Cmdname sid="alert_object_filtering" className="uitext" />オプションは、<Cmdname sid="metrics_rule_select" className="uitext" />または<Cmdname sid="metrics_rule_direct" className="uitext" />オプションを選択できます。

- イベント設定内容が保存された後は、そのオプション値は<Cmdname sid="metrics_rule_direct" className="uitext" />オプションで管理します。以降<Cmdname sid="metrics_rule_select" className="uitext" />オプションに切り替えると、オプション値が初期化される可能性があります。

- イベント発生条件と対象に、特殊文字(<code>~!@#$%^&\*()_+=-[]\`</code>)を入れるか、数字から始まるフィールド名を入力すると、エラーが発生する場合があります。その時は、<Cmdname sid="metrics_rule_direct" className="uitext" />オプションを選択し、次のように中括弧(<code>\$\{\}</code>)にくくって入力します。

  ```text
  ${4xxErrorType} == '401'
  ```

:::

### 通知設定 {#set-receive-event}

<ImgLang img='set-event-receive.png' desc='イベント受信設定' />

- <Cmdname sid="number_of_event" className="uitext" />：選択した時間の間に<Cmdname sid="metrics_event_rules" className="uitext" />で設定したイベントが入力した回数分発生すると、アラート通知が送信されます。

  :::note

  - 選択時間を<Cmdname sid="metrics_option_disabled" className="uitext" />に設定すると、入力した回数だけ連続して発生通知が送信されます。
  - <Cmdname sid="CNT08320" className="uitext" />オプションを有効にした場合、選択時間は、<Cmdname sid="metrics_option_disabled" className="uitext" />に選択することをお勧めします。
  - <Cmdname sid="category" className="uitext" />オプションで選択した項目のログ収集の周期は5秒です。

  :::

- <Cmdname sid="event_pause" className="uitext" /><ScrollToLink anchor='scrollTo-event-pause' />：過剰なアラート通知が発生しないようにするオプションです。最初のアラート通知の後、選択された時間にアラート通知は送信されません。 また、<Cmdname sid="event_history" className="uitext" />メニューに記録されません。

- <Cmdname sid="related_category" className="uitext" />：関連カテゴリを最大5つまで設定し、通知を閲覧するときに参照します。

- <Cmdname sid="event_tag" className="uitext" />：イベント受信タグを選択すると、そのタグを持つプロジェクトメンバーと3rd-partyプラグインに通知を送信できます。イベント受信タグを選択しない場合は、プロジェクトの全体メンバーにアラート通知を送信します。

  :::note

  <Cmdname sid="event_statistic" className="uitext" /> &gt; <Cmdname sid="event_receive_configuration" className="uitext" />メニューでプロジェクトメンバーと3rd-partyプラグインにタグを設定できます。

  :::

### イベントルールテスト

<ImgLang img='set-event-test.png' desc='アラート通知テスト' />

選択した時間の間に設定したイベント条件を実行して、何回の警告通知が発生したかを確認できます。<Cmdname sid="run" className="uitext" />ボタンを選択すると、右上に通知発生件数情報が表示されます。<Cmdname sid="metrics_event_rules" className="uitext" />で選択したフィールドとしきい値をチャート上に表示します。

:::note

- <Cmdname sid="metrics_event_rules" className="uitext" />についての詳細は、[次の文書](#eventcondition)を参照してください。

- <Cmdname sid="event_simulation_title" className="uitext" />機能は、最大24時間のデータに基づいてテストできます。

:::
