*xos*フォルダの配置ファイルでエージェントを実行します。

```bash
start.bat
```

画面に表示される実行ログにエラーがないことを確認し、実行を終了した後、次の手順に従ってサービスに登録します。

<InDoc product="postgresql,oracle,mysql,mssql,cubrid,altibase,db2">

:::note

**msvcp120.dll、msvcr120.dll欠落時の解決方法**

xosエージェント実行中*msvcp120.dll*と*msvcr120.dll*ファイルが欠落して実行できない場合は、Microsoft Visual C++ 2013 Redistributable 2013がインストールされていないか、損傷しているためです。 **Microsoft Visual C++ 2013 Redistributableパッケージ**をインストールして問題を解決できます。

次のリンクで自分のシステム環境に合ったパッケージをダウンロードしてインストールします。\
[Microsoft Visual C++ 2013 Redistributable (x86 & x64)](https://www.microsoft.com/ja-jp/download/details.aspx?id=40784)

- **vcredist_x86.exe**: 32ビットプログラム実行用
- **vcredist_x64.exe**: 64ビットプログラム実行用

:::

</InDoc>

- **サービスを登録**

  xosフォルダにある*install_WindowsService.bat*ファイルを次のように実行して、サービスに登録します。 もし`create`オプションの次に名前を入力しないと、**WhatapXOSAgent**名前でサービスに基本登録されます。

  ```bash
  install_WindowsService.bat create WhatapXOSAgent
  ```

- **サービスを削除**

  ```bash
  install_WindowsService.bat delete WhatapXOSAgent
  ```

:::note

DBXエージェントでモニタリングしたデータを転送するために`dbx_port`に設定したポート(default 3002)が開いている必要があります。 (**UDP Outbound**)

:::
