"use strict";(self.webpackChunkwhatap_docs=self.webpackChunkwhatap_docs||[]).push([["50277"],{30141:function(e,n,a){a.d(n,{Ay:()=>s,RM:()=>o});var t=a(74848),i=a(84429);let o=[{value:"Next steps",id:"next-steps",level:2}];function r(e){let n={a:"a",code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",section:"section",strong:"strong",ul:"ul",...(0,i.R)(),...e.components},{Cmdname:a}=n;return a||function(e,n){throw Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Cmdname",!0),(0,t.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,t.jsx)(n.h2,{id:"next-steps",children:"Next steps"}),(0,t.jsx)("div",{className:"nextstep",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Open source tracing"})}),"\n",(0,t.jsx)(n.p,{children:"Depending on the framework or open source library used in applications, you may need to add agent options. For example, when using spring-boot-3.x, feign-client-11, or okhttp3-4.4 with a framework or open source, set the options as follows:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"weaving=spring-boot-3.0,feign-11,okhttp3-4.4\n"})}),"\n",(0,t.jsxs)(n.p,{children:["For information on how to configure the framework or open source library that suits your application environment, see ",(0,t.jsx)(n.a,{href:"../agent-weaving",children:"the following"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Checking the installation"})}),"\n",(0,t.jsxs)(n.p,{children:["If you have created a project, installed an agent, and applied all JVM options, see the checklist in ",(0,t.jsx)(n.a,{href:"../install-check",children:"the following"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Installation troubleshooting"})}),"\n",(0,t.jsxs)(n.p,{children:["It provides various problems that may occur when installing the agent and specific instructions for resolving them. It provides solutions against various situations, including firewall configuration, SpringBoot and Tomcat JMX configuration, and server configuration using the OSGI framework. For more information, see ",(0,t.jsx)(n.a,{href:"../agent-troubleshooting",children:"the following"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Agent setting"})}),"\n",(0,t.jsxs)(n.p,{children:["It provides various features for monitoring by applying some options to the agent configuration file (",(0,t.jsx)(n.em,{children:"whatap.conf"}),"). It includes basic configuration, configuration for server connection and data transfer, how to manage the configuration files for multiple application servers, and transaction tracing, and more. For more information, see ",(0,t.jsx)(n.a,{href:"../set-agent",children:"the following"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Starting the monitoring"})}),"\n",(0,t.jsxs)(n.p,{children:["After all settings are made, restart the application server. The agent starts collecting data. First, check whether the monitoring data has been collected in ",(0,t.jsx)(a,{sid:"side_appDashboard",className:"uitext"}),". For more information about ",(0,t.jsx)(a,{sid:"side_appDashboard",className:"uitext"}),", see ",(0,t.jsx)(n.a,{href:"../dashboard",children:"the following"}),"."]}),"\n"]}),"\n"]})})]})}function s(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(r,{...e})}):r(e)}},8739:function(e,n,a){a.d(n,{Ay:()=>s,RM:()=>o});var t=a(74848),i=a(84429);let o=[];function r(e){let n={code:"code",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"In case of Java 17 or later, add the following options for reflection."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"\n--add-opens=java.base/java.lang=ALL-UNNAMED\n\n"})})]})}function s(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(r,{...e})}):r(e)}},77255:function(e,n,a){a.d(n,{Ay:()=>s,RM:()=>o});var t=a(74848),i=a(84429);let o=[{value:"Viewing the heap histogram",id:"viewing-the-heap-histogram",level:2}];function r(e){let n={admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",section:"section",ul:"ul",...(0,i.R)(),...e.components},{Cmdname:a}=n;return a||function(e,n){throw Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Cmdname",!0),(0,t.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,t.jsx)(n.h2,{id:"viewing-the-heap-histogram",children:"Viewing the heap histogram"}),(0,t.jsxs)(n.p,{children:["WhaTap's Java Monitoring provides the function to view the status of heap occupancy objects in the JVM memory (sizes for each object in heap memory). In ",(0,t.jsx)(a,{sid:"app_upper",className:"uitext"})," > ",(0,t.jsx)(a,{sid:"instance_performance_analysis",className:"uitext"}),", select the ",(0,t.jsx)(a,{sid:"heap_histogram",className:"uitext"})," tab."]}),(0,t.jsx)(n.p,{children:"Java versions 6 to 8 support basic functions without the JVM options. However, for some Java versions, the JVM options must be applied as follows:"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Java 9 to Java 15"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"-Djdk.attach.allowAttachSelf=true\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'title="example"',children:"java -javaagent:{WHATAP_HOME}/whatap.agent-X.Y.Z.jar -Djdk.attach.allowAttachSelf=true -jar {application.jar}\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Java 16 or later"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"-Djdk.attach.allowAttachSelf=true\n--add-opens=jdk.attach/sun.tools.attach=ALL-UNNAMED\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'title="example"',children:"java -javaagent:{WHATAP_HOME}/whatap.agent-X.Y.Z.jar -Djdk.attach.allowAttachSelf=true --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=jdk.attach/sun.tools.attach=ALL-UNNAMED -jar {application.jar}\n"})}),"\n"]}),"\n"]}),(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"It does not support Java 5 or earlier and IBM Java."})})]})}function s(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(r,{...e})}):r(e)}},12309:function(e,n,a){a.r(n),a.d(n,{metadata:()=>t,default:()=>m,frontMatter:()=>l,contentTitle:()=>d,toc:()=>p,assets:()=>h});var t=JSON.parse('{"id":"java/add-jvm-opt/docker","title":"Docker","description":"The step-by-step instructions on how to apply the WhaTap Java monitoring agent to Java applications in the Docker environment are provided. Users can add more Whatap Java agent settings to the existing Docker image to see the processes for building a new image, creating the whatap.conf file, writing a Dockerfile, and modifying JAVA_OPT. Additional JVM options for Java 17 or later and the method how to configure the heap histogram lookup for various Java versions are also provided.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/java/add-jvm-opt/docker.mdx","sourceDirName":"java/add-jvm-opt","slug":"/java/add-jvm-opt/docker","permalink":"/whatap-docs/java/add-jvm-opt/docker","draft":false,"unlisted":false,"editUrl":"undefined/docs/java/add-jvm-opt/docker.mdx","tags":[],"version":"current","frontMatter":{"id":"docker","title":"Docker","description":"The step-by-step instructions on how to apply the WhaTap Java monitoring agent to Java applications in the Docker environment are provided. Users can add more Whatap Java agent settings to the existing Docker image to see the processes for building a new image, creating the whatap.conf file, writing a Dockerfile, and modifying JAVA_OPT. Additional JVM options for Java 17 or later and the method how to configure the heap histogram lookup for various Java versions are also provided.","keywords":["Java","Docker","Application","Agent"],"isTranslationMissing":false},"sidebar":"javaSidebar","previous":{"title":"Elastic Beanstalk","permalink":"/whatap-docs/java/add-jvm-opt/elastic-beanstalk"},"next":{"title":"Batch application","permalink":"/whatap-docs/java/add-jvm-opt/batch-app"}}'),i=a(74848),o=a(84429),r=a(8739),s=a(77255),c=a(30141);let l={id:"docker",title:"Docker",description:"The step-by-step instructions on how to apply the WhaTap Java monitoring agent to Java applications in the Docker environment are provided. Users can add more Whatap Java agent settings to the existing Docker image to see the processes for building a new image, creating the whatap.conf file, writing a Dockerfile, and modifying JAVA_OPT. Additional JVM options for Java 17 or later and the method how to configure the heap histogram lookup for various Java versions are also provided.",keywords:["Java","Docker","Application","Agent"],isTranslationMissing:!1},d,h={},p=[{value:"Applying the agent",id:"applying-the-agent",level:2},{value:"Creating the Docker build directory",id:"creating-the-docker-build-directory",level:3},{value:"Creating the agent configuration file",id:"creating-the-agent-configuration-file",level:3},{value:"Creating the Dockerfile",id:"creating-the-dockerfile",level:3},{value:"Applying <code>JAVA_OPTS</code>",id:"applying-java_opts",level:3},{value:"Building the Docker",id:"building-the-docker",level:3},...r.RM,...s.RM,...c.RM];function g(e){let n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",p:"p",pre:"pre",section:"section",strong:"strong",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Docker is a container-based virtualization platform. When you run Java applications in a Docker container, you can adjust the application's performance and resource usage by adding JVM options. This document explains how to modify the Dockerfile to add JVM options."}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"The Docker must have been installed and the Docker images must be built for Java applications."})}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,i.jsx)(n.h2,{id:"applying-the-agent",children:"Applying the agent"}),(0,i.jsx)(n.p,{children:"Based on an existing Docker image, build an image with the WhaTap agent settings added."}),(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["This document covers only the installation of the Java agent. To apply with WhaTap Kubernetes monitoring, see ",(0,i.jsx)(n.a,{href:"../../kubernetes/install-docker-java",children:"the following"}),"."]})})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,i.jsx)(n.h3,{id:"creating-the-docker-build-directory",children:"Creating the Docker build directory"}),(0,i.jsx)(n.p,{children:"Create a Docker build directory."}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mkdir -p {Docker build dir}\n"})})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,i.jsx)(n.h3,{id:"creating-the-agent-configuration-file",children:"Creating the agent configuration file"}),(0,i.jsxs)(n.p,{children:["Create the ",(0,i.jsx)(n.em,{children:"whatap.conf"})," file."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-docker",metastring:"{3,5} showLineNumbers",children:"cat >{Docker build Dir}/whatap.conf <<EOL\n#Enter the access key.\nlicense=XXXXXXXXXXXXXX-XXXXXXXXXXXXXX-XXXXXXXXXXXXXX \n#Enter the collection server IP.\nwhatap.server.host=xx.xx.xx.xx/yy.yy.yy.yy \nEOL\n"})})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,i.jsx)(n.h3,{id:"creating-the-dockerfile",children:"Creating the Dockerfile"}),(0,i.jsxs)(n.p,{children:["To build an image, you can copy the jar files from the WhaTap image to the ",(0,i.jsx)(n.code,{children:"-javaagent"})," option."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-docker",children:"cat >/home/silver/whatap/docker/Dockerfile <<EOL\nFROM whatap/kube_mon as build\n## Create an actual image (Add the WhaTap image)\n## $Image_Name (image name)\nFROM $Image_Name\nRUN mkdir -p /whatap\nCOPY --from=build /data/agent/micro/whatap.agent-*.jar /whatap\nCOPY ./whatap.conf /whatap/\n#...\nEOL\n"})})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,i.jsxs)(n.h3,{id:"applying-java_opts",children:["Applying ",(0,i.jsx)(n.code,{children:"JAVA_OPTS"})]}),(0,i.jsxs)(n.p,{children:["Add the following to ",(0,i.jsx)(n.code,{children:"JAVA_OPT"}),":"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'WHATAP_HOME=/whatap\nWHATAP_JAR=ls ${WHATAP_HOME}/whatap.agent-*.jar | sort -V | tail -1\nexport JAVA_OPTS="-javaagent:${WHATAP_JAR} "\n'})})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,i.jsx)(n.h3,{id:"building-the-docker",children:"Building the Docker"}),(0,i.jsx)(n.p,{children:"Build the Docker."}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd docker\ndocker build -t $Image_Name\n"})}),(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(r.Ay,{})}),(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsxs)(n.p,{children:["You can modify the Java agent file name by using the ",(0,i.jsx)(n.code,{children:"Rename"})," function. Once the Java agent name has been modified, enter a new name in ",(0,i.jsx)(n.code,{children:"JAVA_OPTS"}),"."]}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example of how to modify the Java agent name"})}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"java -cp whatap.agent-X.Y.Z.jar whatap.agent.setup.Rename -from whatap.agent-X.Y.Z.jar -to whatap.agent.jar\n"})})]}),(0,i.jsx)(s.Ay,{}),(0,i.jsx)(c.Ay,{})]})]})}function m(e={}){let{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(g,{...e})}):g(e)}},84429:function(e,n,a){a.d(n,{R:()=>r,x:()=>s});var t=a(96540);let i={},o=t.createContext(i);function r(e){let n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);