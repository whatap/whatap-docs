"use strict";(self.webpackChunkwhatap_docs=self.webpackChunkwhatap_docs||[]).push([["96546"],{50959:function(e,t,n){n.r(t),n.d(t,{default:()=>h,frontMatter:()=>c,metadata:()=>r,assets:()=>l,toc:()=>o,contentTitle:()=>i});var r=JSON.parse('{"id":"golang/api-guide","title":"API \uAC00\uC774\uB4DC","description":"Go \uB77C\uC774\uBE0C\uB7EC\uB9AC\uB97C \uC774\uC6A9\uD574 \uC640\uD0ED \uC5D0\uC774\uC804\uD2B8\uC5D0 \uBAA8\uB2C8\uD130\uB9C1\uD560 \uB370\uC774\uD130\uB97C \uC804\uC1A1\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.","source":"@site/docs/golang/api-guide.mdx","sourceDirName":"golang","slug":"/golang/api-guide","permalink":"/whatap-docs/golang/api-guide","draft":false,"unlisted":false,"editUrl":"undefined/docs/golang/api-guide.mdx","tags":[],"version":"current","frontMatter":{"id":"api-guide","title":"API \uAC00\uC774\uB4DC","description":"Go \uB77C\uC774\uBE0C\uB7EC\uB9AC\uB97C \uC774\uC6A9\uD574 \uC640\uD0ED \uC5D0\uC774\uC804\uD2B8\uC5D0 \uBAA8\uB2C8\uD130\uB9C1\uD560 \uB370\uC774\uD130\uB97C \uC804\uC1A1\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.","keywords":["Go","API \uAC00\uC774\uB4DC","\uB77C\uC774\uBE0C\uB7EC\uB9AC"],"isTranslationMissing":false},"sidebar":"goSidebar","previous":{"title":"Docker \uD658\uACBD \uC124\uCE58","permalink":"/whatap-docs/golang/install-agent-docker"},"next":{"title":"\uC124\uCE58 \uC810\uAC80 \uC0AC\uD56D","permalink":"/whatap-docs/golang/install-check"}}'),a=n("85893"),s=n("50065");let c={id:"api-guide",title:"API \uAC00\uC774\uB4DC",description:"Go \uB77C\uC774\uBE0C\uB7EC\uB9AC\uB97C \uC774\uC6A9\uD574 \uC640\uD0ED \uC5D0\uC774\uC804\uD2B8\uC5D0 \uBAA8\uB2C8\uD130\uB9C1\uD560 \uB370\uC774\uD130\uB97C \uC804\uC1A1\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.",keywords:["Go","API \uAC00\uC774\uB4DC","\uB77C\uC774\uBE0C\uB7EC\uB9AC"],isTranslationMissing:!1},i=void 0,l={},o=[{value:"\uB2E4\uC6B4\uB85C\uB4DC",id:"\uB2E4\uC6B4\uB85C\uB4DC",level:2},{value:"\uC2DC\uC791\uD558\uAE30",id:"\uC2DC\uC791\uD558\uAE30",level:2},{value:"init, shutdown",id:"init-shutdown",level:3},{value:"Context",id:"context",level:3},{value:"\uD2B8\uB79C\uC7AD\uC158 \uC0DD\uC131",id:"\uD2B8\uB79C\uC7AD\uC158-\uC0DD\uC131",level:4},{value:"\uD2B8\uB79C\uC7AD\uC158 \uCD94\uC801",id:"\uD2B8\uB79C\uC7AD\uC158-\uCD94\uC801",level:2},{value:"\uC6F9 \uD2B8\uB79C\uC7AD\uC158 \uCD94\uC801",id:"\uC6F9-\uD2B8\uB79C\uC7AD\uC158-\uCD94\uC801",level:3},{value:"\uC77C\uBC18 \uD2B8\uB79C\uC7AD\uC158 \uCD94\uC801",id:"\uC77C\uBC18-\uD2B8\uB79C\uC7AD\uC158-\uCD94\uC801",level:3},{value:"API",id:"api",level:3},{value:"DB \uC5F0\uACB0 \uBC0F SQL \uCD94\uC801",id:"db-\uC5F0\uACB0-\uBC0F-sql-\uCD94\uC801",level:2},{value:"DB Connection",id:"db-connection",level:3},{value:"database/sql \uD328\uD0A4\uC9C0 \uC124\uC815",id:"databasesql-\uD328\uD0A4\uC9C0-\uC124\uC815",level:3},{value:"API",id:"api-1",level:3},{value:"HTTP \uC694\uCCAD \uCD94\uC801",id:"http-\uC694\uCCAD-\uCD94\uC801",level:2},{value:"http transport RoundTrip",id:"http-transport-roundtrip",level:3},{value:"API",id:"api-2",level:3},{value:"\uBA40\uD2F0 \uD2B8\uB79C\uC7AD\uC158 \uCD94\uC801(\uBD84\uC0B0 \uCD94\uC801)",id:"mtrace",level:2},{value:"\uC5D0\uC774\uC804\uD2B8 \uC124\uC815\uD558\uAE30",id:"\uC5D0\uC774\uC804\uD2B8-\uC124\uC815\uD558\uAE30",level:3},{value:"Request Header \uC804\uB2EC\uD558\uAE30",id:"request-header-\uC804\uB2EC\uD558\uAE30",level:3},{value:"HTTP \uC5F0\uACB0 \uC2DC Header \uC815\uBCF4 \uCD94\uAC00\uD558\uAE30",id:"http-\uC5F0\uACB0-\uC2DC-header-\uC815\uBCF4-\uCD94\uAC00\uD558\uAE30",level:3},{value:"\uC790\uB3D9\uC73C\uB85C Header \uCD94\uAC00\uD558\uAE30",id:"\uC790\uB3D9\uC73C\uB85C-header-\uCD94\uAC00\uD558\uAE30",level:3},{value:"\uD568\uC218 \uCD94\uC801",id:"\uD568\uC218-\uCD94\uC801",level:2},{value:"API",id:"api-3",level:3},{value:"Log",id:"log",level:2},{value:"\uC5D0\uC774\uC804\uD2B8 \uC124\uC815\uD558\uAE30",id:"\uC5D0\uC774\uC804\uD2B8-\uC124\uC815\uD558\uAE30-1",level:3},{value:"\uB85C\uADF8 \uB77C\uC774\uBE0C\uB7EC\uB9AC \uCD08\uAE30\uD654 \uC804",id:"\uB85C\uADF8-\uB77C\uC774\uBE0C\uB7EC\uB9AC-\uCD08\uAE30\uD654-\uC804",level:3},{value:"\uB85C\uADF8 \uB77C\uC774\uBE0C\uB7EC\uB9AC \uCD08\uAE30\uD654 \uD6C4",id:"\uB85C\uADF8-\uB77C\uC774\uBE0C\uB7EC\uB9AC-\uCD08\uAE30\uD654-\uD6C4",level:3},{value:"API",id:"api-4",level:3},{value:"log package",id:"log-package",level:4},{value:"go.uber.org/zap",id:"gouberorgzap",level:4},{value:"github.com/sirupsen/logrus",id:"githubcomsirupsenlogrus",level:4}];function d(e){let t={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",section:"section",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(t.p,{children:["\uC774 \uBB38\uC11C\uC5D0\uC11C \uAE30\uC220\uB41C \uC608\uC81C \uCF54\uB4DC\uB294 ",(0,a.jsx)(t.a,{href:"https://github.com/whatap/go-api-example",children:"github.com/whatap/go-api-example"})," \uC800\uC7A5\uC18C\uC5D0\uC11C \uD655\uC778\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4."]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h2",children:[(0,a.jsx)(t.h2,{id:"\uB2E4\uC6B4\uB85C\uB4DC",children:"\uB2E4\uC6B4\uB85C\uB4DC"}),(0,a.jsx)(t.p,{children:"\uD328\uC9C0\uD0A4 \uBC0F \uAD00\uB828 \uC885\uC18D\uC131(dependency)\uC744 \uB2E4\uC6B4\uB85C\uB4DC\uD558\uC138\uC694."}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"go get github.com/whatap/go-api\n"})})]}),"\n",(0,a.jsx)(t.section,{className:"remark-sectionize-h2",children:(0,a.jsx)(t.h2,{id:"\uC2DC\uC791\uD558\uAE30",children:"\uC2DC\uC791\uD558\uAE30"})}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"init-shutdown",children:"init, shutdown"}),(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"trace.Init()"})," \uD568\uC218\uB97C \uC774\uC6A9\uD574 \uBAA8\uB2C8\uD130\uB9C1 \uBAA8\uB4C8\uC744 \uC2DC\uC791\uD558\uC138\uC694. ",(0,a.jsx)(t.code,{children:"defer trace.Shutdown()"}),"\uC73C\uB85C \uBAA8\uB2C8\uD130\uB9C1 \uC885\uB8CC\uB97C \uBCF4\uC7A5\uD569\uB2C8\uB2E4."]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",metastring:'title="Go"',children:'import "github.com/whatap/go-api/trace"\n\nfunc main(){\n    trace.Init(nil)\n    //It must be executed before closing the app.\n    defer trace.Shutdown()\n\n    ...\n}\n\nfunc Init(m map[string]string)\n'})}),(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"map[string]string"})," \uD615\uC2DD\uC744 \uC560\uD50C\uB9AC\uCF00\uC774\uC158 \uCD08\uAE30\uC5D0 \uC124\uC815\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4. \uB610\uB294 ",(0,a.jsx)(t.em,{children:"whatap.conf"})," \uD30C\uC77C\uC5D0 \uC124\uC815\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4. \uC5D0\uC774\uC804\uD2B8\uC640 TCP \uC811\uC18D\uC774 \uC815\uC0C1\uC801\uC73C\uB85C \uC774\uB8E8\uC5B4\uC838\uC57C \uC131\uB2A5 \uC815\uBCF4\uB97C \uC640\uD0ED \uC218\uC9D1 \uC11C\uBC84\uB85C \uBCF4\uB0BC \uC218 \uC788\uC2B5\uB2C8\uB2E4. \uAE30\uBCF8 \uC811\uC18D \uC815\uBCF4\uB85C ",(0,a.jsx)(t.strong,{children:"127.0.0.1:6600"}),"\uC744 \uD1B5\uD574 TCP\uB85C \uD1B5\uC2E0\uD569\uB2C8\uB2E4."]}),(0,a.jsxs)(t.p,{children:["\uC811\uC18D \uC815\uBCF4\uB97C \uBCC0\uACBD\uD558\uB824\uBA74 ",(0,a.jsx)(t.code,{children:"Init"})," \uD568\uC218\uC5D0 \uC124\uC815\uC744 \uC804\uB2EC\uD558\uAC70\uB098 ",(0,a.jsx)(t.em,{children:"whatap.conf"})," \uD30C\uC77C\uC5D0 \uC124\uC815\uD558\uACE0 \uC560\uD50C\uB9AC\uCF00\uC774\uC158\uC744 \uC7AC\uC2DC\uC791\uD558\uC138\uC694."]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:'m := make(map[string]string)\nm["net_ipc_host"] = "127.0.0.1"\nm["net_ipc_port"] = "6601"\n\ntrace.Init(m)\n'})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ini",metastring:'title="whatap.conf"',children:"accesskey={\uC561\uC138\uC2A4 \uD0A4}\nwhatap.server.host={\uC218\uC9D1 \uC11C\uBC84 IP \uC8FC\uC18C}\nnet_ipc_host=127.0.0.1\nnet_ipc_host=6600\n"})})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"context",children:"Context"}),(0,a.jsxs)(t.p,{children:["\uC5D0\uC774\uC804\uD2B8\uB294 \uC131\uB2A5 \uC815\uBCF4\uB97C \uD2B8\uB79C\uC7AD\uC158 \uB2E8\uC704\uB85C \uC218\uC9D1\uD569\uB2C8\uB2E4. \uD2B8\uB79C\uC7AD\uC158\uC758 \uAD6C\uBD84\uC740 ",(0,a.jsx)(t.code,{children:"whatap context(trace.TraceCtx)"}),"\uAC00 \uD3EC\uD568\uB41C ",(0,a.jsx)(t.code,{children:"context"}),"\uB97C \uAE30\uC900\uC73C\uB85C \uD569\uB2C8\uB2E4. \uD2B8\uB79C\uC7AD\uC158\uC5D0 \uC5F0\uACC4\uB418\uC9C0 \uC54A\uB294 \uC131\uB2A5 \uC815\uBCF4\uB294 \uC218\uC9D1\uC744 \uBB34\uC2DC\uD558\uAC70\uB098 \uD1B5\uACC4 \uC815\uBCF4\uB85C\uB9CC \uC218\uC9D1\uD569\uB2C8\uB2E4."]})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h4",children:[(0,a.jsx)(t.h4,{id:"\uD2B8\uB79C\uC7AD\uC158-\uC0DD\uC131",children:"\uD2B8\uB79C\uC7AD\uC158 \uC0DD\uC131"}),(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"go-api/trace"})," \uBAA8\uB4C8\uC758 ",(0,a.jsx)(t.code,{children:"Start"}),", ",(0,a.jsx)(t.code,{children:"StartWithReqest"})," \uD568\uC218\uB85C ",(0,a.jsx)(t.code,{children:"whatap context"}),"\uB97C \uC0DD\uC131\uD569\uB2C8\uB2E4. ",(0,a.jsx)(t.code,{children:"context"})," \uB0B4\uBD80\uC5D0 ",(0,a.jsx)(t.code,{children:"whatap"})," \uD0A4\uB85C ",(0,a.jsx)(t.code,{children:"TraceCtx"})," \uC815\uBCF4\uB97C \uC124\uC815\uD569\uB2C8\uB2E4."]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:'var traceCtx *TraceCtx\ntraceCtx.Txid = keygen.Next()\nctx = context.WithValue(ctx, "whatap", traceCtx)\n'})}),(0,a.jsxs)(t.p,{children:["\uD2B8\uB79C\uC7AD\uC158, SQL, DBConnection, \uC678\uBD80 HTTP request, \uC77C\uBC18 \uD568\uC218 \uCD94\uC801 \uB4F1\uC758 API\uC5D0\uC11C \uC2DC\uC791 \uC2DC\uC810\uC5D0\uB294 \uBC18\uB4DC\uC2DC ",(0,a.jsx)(t.code,{children:"whatap"})," \uD0A4\uB85C ",(0,a.jsx)(t.code,{children:"TraceCtx"})," \uAC1D\uCCB4\uAC00 \uC874\uC7AC\uD558\uB294 ",(0,a.jsx)(t.code,{children:"Context"}),"\uAC00 \uD544\uC694\uD569\uB2C8\uB2E4."]})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h2",children:[(0,a.jsx)(t.h2,{id:"\uD2B8\uB79C\uC7AD\uC158-\uCD94\uC801",children:"\uD2B8\uB79C\uC7AD\uC158 \uCD94\uC801"}),(0,a.jsxs)(t.p,{children:["\uC6F9 \uC694\uCCAD\uACFC \uC751\uB2F5\uAE4C\uC9C0\uC758 \uD2B8\uB79C\uC7AD\uC158\uACFC \uC77C\uBC18\uC801\uC778 \uC791\uC5C5 \uB2E8\uC704\uC758 \uD2B8\uB79C\uC7AD\uC158\uC744 \uBAA8\uB450 \uCD94\uC801\uD569\uB2C8\uB2E4. \uC2DC\uC791 \uBC0F \uC885\uB8CC \uD568\uC218\uB85C \uAD6C\uC131\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4. \uD558\uB098\uC758 \uD2B8\uB79C\uC7AD\uC158\uC73C\uB85C \uC778\uC2DD\uB418\uC5B4 ",(0,a.jsx)(t.strong,{children:"\uD788\uD2B8\uB9F5"})," \uC704\uC82F\uC5D0\uC11C \uC0C1\uC138 \uBCF4\uAE30\uC640 TPS, \uC751\uB2F5\uC2DC\uAC04, \uD3C9\uADE0 \uC751\uB2F5\uC2DC\uAC04 \uB4F1\uC758 \uD1B5\uACC4 \uC9C0\uD45C\uB97C \uD655\uC778\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4."]}),(0,a.jsx)(t.p,{children:"\uC124\uC815\uC744 \uD1B5\uD574\uC11C HTTP \uD30C\uB77C\uBBF8\uD130, HTTP \uD5E4\uB354 \uC815\uBCF4\uB97C \uC218\uC9D1\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4."})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"\uC6F9-\uD2B8\uB79C\uC7AD\uC158-\uCD94\uC801",children:"\uC6F9 \uD2B8\uB79C\uC7AD\uC158 \uCD94\uC801"}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:'http.HandleFunc("/index", func(w http.ResponseWriter, r *http.Request) {\n    ctx, _ := trace.StartWithRequest(r)\n    defer trace.End(ctx, nil)\n}\n'})}),(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"trace.Func()"}),", ",(0,a.jsx)(t.code,{children:"trace.HandlerFunc()"})]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"net/http"}),"\uC758 Handle, HandFunc\uC744 \uB798\uD551\uD55C \uD568\uC218"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"trace.StartWithRequest"}),", ",(0,a.jsx)(t.code,{children:"trace.End"}),"\uB97C \uB3D9\uC77C\uD558\uAC8C \uC9C4\uD589\uD569\uB2C8\uB2E4."]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:"\uC6F9 \uD2B8\uB79C\uC7AD\uC158\uC758 \uC774\uB984\uC740 RequestURI\uB85C \uC124\uC815\uB429\uB2C8\uB2E4."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.code,{children:"trace.Step()"})}),"\n",(0,a.jsx)(t.p,{children:"\uC0AC\uC6A9\uC790\uAC00 \uC804\uB2EC\uD558\uB294 \uBB38\uC790\uC5F4\uC744 \uD504\uB85C\uD30C\uC77C \uC815\uBCF4\uC5D0 \uCD9C\uB825\uD558\uB294 \uAE30\uB2A5\uC744 \uC81C\uACF5\uD569\uB2C8\uB2E4."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:'http.HandleFunc("/wrapHandleFunc", trace.Func(func(w http.ResponseWriter, r *http.Request) {\n    ...\n}))\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:'http.Handle("/wrapHandleFunc1", trace.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    ...\n}))\n'})}),"\n"]}),"\n"]})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"\uC77C\uBC18-\uD2B8\uB79C\uC7AD\uC158-\uCD94\uC801",children:"\uC77C\uBC18 \uD2B8\uB79C\uC7AD\uC158 \uCD94\uC801"}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:'func main() {\n    ...\n\n    ctx := context.Background()\n    ctx, _ := trace.Start(ctx, "Custom Transaction")\n\n    ...\n\n    trace.End(ctx, nil)\n\n    ...\n}\n'})})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"api",children:"API"}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func Start(ctx context.Context, name string) (context.Context, error)\n"})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func End(ctx context.Context, err error) error\n"})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func StartWithRequest(r *http.Request) (context.Context, error)\n"})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func Step(ctx context.Context, title, message string, elapsed, value int) error\n"})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func HandlerFunc(handler func(http.ResponseWriter, *http.Request)) http.HandlerFunc\n"})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func Func(handler func(http.ResponseWriter, *http.Request)) func(http.ResponseWriter, *http.Request)\n"})})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h2",children:[(0,a.jsx)(t.h2,{id:"db-\uC5F0\uACB0-\uBC0F-sql-\uCD94\uC801",children:"DB \uC5F0\uACB0 \uBC0F SQL \uCD94\uC801"}),(0,a.jsx)(t.p,{children:"DB \uC5F0\uACB0 \uC815\uBCF4, sql \uAD6C\uBB38, error \uBC0F prepared \uAD6C\uBB38\uC744 \uC704\uD55C \uD30C\uB77C\uBBF8\uD130\uB97C API\uB85C \uC804\uB2EC\uD558\uBA74 \uC2E4\uD589 \uC2DC\uAC04 \uBC0F \uC624\uB958 \uC0AC\uD56D\uC744 \uC218\uC9D1\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4. SQL \uAD6C\uBB38\uC740 \uCD5C\uB300 32KB\uAE4C\uC9C0 \uC218\uC9D1\uD569\uB2C8\uB2E4. SQL Prepared \uAD6C\uBB38\uC744 \uC704\uD55C \uD30C\uB77C\uBBF8\uD130\uB294 \uCD5C\uB300 20\uAC1C, \uAC01\uAC01 256byte\uAE4C\uC9C0 \uC218\uC9D1\uD569\uB2C8\uB2E4."})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"db-connection",children:"DB Connection"}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:'import (\n    whatapsql "github.com/whatap/go-api/sql"\n)\n\nfunc main(){\n    trace.Init(nil)\n    //It must be executed before closing the app.\n    defer trace.Shutdown()\n    \n    ctx, _ := trace.Start(context.Background(), "Trace Open DB")\n    defer trace.End(ctx, nil)\n    \n    sqlCtx, _ := whatapsql.StartOpen(ctx, "id@tcp(x.x.x.x:3306)/test")\n    db, err := sql.Open("mysql", "id:pwd@tcp(x.x.x.x:3306)/test")\n    whatapsql.End(sqlCtx, err)\n    defer db.Close()\n}\n'})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:'import (\n    whatapsql "github.com/whatap/go-api/sql"\n)\n\nfunc main(){\n    trace.Init(nil)\n    //It must be executed before closing the app.\n    defer trace.Shutdown()\n    \n    ctx, _ := trace.Start(context.Background(), "Trace Query")\n    defer trace.End(ctx, nil)\n    \n    query = "select id, subject from tbl_faq limit 10"\n    sqlCtx, _ = whatapsql.Start(ctx, "id:pwd@tcp(x.x.x.x:3306)/test", query)\n    rows, err := db.QueryContext(ctx, query)\n    whatapsql.End(sqlCtx, err)\n}\n'})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:'import (\n    whatapsql "github.com/whatap/go-api/sql"\n)\n\nfunc main(){\n    trace.Init(nil)\n    //It must be executed before closing the app.\n    defer trace.Shutdown()\n    \n    ctx, _ := trace.Start(context.Background(), "Trace Prepared Statement")\n    defer trace.End(ctx, nil)\n    \n    // Prepared Statement \uC0DD\uC131\n    query = "select id, subject from tbl_faq where id = ? limit ?"\n    stmt, err := db.Prepare(query)\n    if err != nil {\n      return\n    }\n    defer stmt.Close()\n    \n    params := make([]interface{}, 0)\n    params = append(params, 8)\n    params = append(params, 1)\n    \n    sqlCtx, _ := whatapsql.StartWithParamArray(ctx, "id:pwd(x.x.x.x:3306)/test", query, params)\n    rows, err := stmt.QueryContext(ctx, params...)\n    whatapsql.End(sqlCtx, err)\n    \n\n    sqlCtx, _ = whatapsql.StartWithParam(ctx, "id:pwd(x.x.x.x:3306)/test", query, params...)\n    rows, err := stmt.QueryContext(ctx, params...)\n    whatapsql.End(sqlCtx, err)\n}\n'})})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"databasesql-\uD328\uD0A4\uC9C0-\uC124\uC815",children:"database/sql \uD328\uD0A4\uC9C0 \uC124\uC815"}),(0,a.jsxs)(t.p,{children:["database/sql \uD328\uD0A4\uC9C0\uC758 ",(0,a.jsx)(t.code,{children:"sql.Open"})," \uD568\uC218 \uB300\uC2E0 ",(0,a.jsx)(t.code,{children:"whatapsql.OpenContext"})," \uD568\uC218\uB97C \uC0AC\uC6A9\uD569\uB2C8\uB2E4. ",(0,a.jsx)(t.code,{children:"PrepareContext"}),", ",(0,a.jsx)(t.code,{children:"QueryContext"}),", ",(0,a.jsx)(t.code,{children:"ExecContext"})," \uB4F1 ",(0,a.jsx)(t.code,{children:"context"}),"\uB97C \uC804\uB2EC\uD558\uB294 \uD568\uC218\uB97C \uC774\uC6A9\uD558\uAE38 \uAD8C\uC7A5\uD569\uB2C8\uB2E4. \uC804\uB2EC\uD558\uB294 ",(0,a.jsx)(t.code,{children:"context"}),"\uB294 ",(0,a.jsx)(t.code,{children:"trace.Start()"}),"\uB97C \uD1B5\uD574\uC11C whatap TraceCtx \uC815\uBCF4\uAC00 \uC788\uC5B4\uC57C \uD569\uB2C8\uB2E4."]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:'\nimport (\n    _ "github.com/go-sql-driver/mysql"\n    "github.com/whatap/go-api/instrumentation/database/sql/whatapsql"\n)\n\nfunc main() {\n    config := make(map[string]string)\n    trace.Init(config)\n    defer trace.Shutdown()\n\n    // whataphttp.Func \uB0B4\uBD80\uC5D0\uC11C whatap TraceCtx\uB97C \uC0DD\uC131\uD569\uB2C8\uB2E4.\n    http.HandleFunc("/query", whataphttp.Func(func(w http.ResponseWriter, r *http.Request){\n      ctx := r.Context()\n    \n      // Use WhaTap Driver. whatap\uC758 TraceCtx\uAC00 \uC788\uB294 context \uB97C \uC804\uB2EC\uD569\uB2C8\uB2E4.\n      db, err := whatapsql.OpenContext(ctx, "mysql", dataSource)\n      if err != nil {\n        fmt.Println("Error whatapsql.Open ", err)\n        return\n      }\n      defer db.Close()\n      \n      ...\n      query := "select id, subject from tbl_faq limit 10"\n      \n      // whatap TraceCtx\uAC00 \uC788\uB294 context \uB97C \uC804\uB2EC\uD569\uB2C8\uB2E4.\n      if rows, err := db.QueryContext(ctx, query); err == nil {\n        ...\n      }\n    }\n    ...\n}\n'})})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"api-1",children:"API"}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func Start(ctx context.Context, dbhost, sql string) (*SqlCtx, error)\n"})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func StartOpen(ctx context.Context, dbhost string) (*SqlCtx, error)\n"})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func End(sqlCtx *SqlCtx, err error) error\n"})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func StartWithParam(ctx context.Context, dbhost, sql, param ...interface{}) (*SqlCtx, error)\n"})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func StartWithParamArray(ctx context.Context, dbhost, sql string, param []interface{}) (*SqlCtx, error)\n"})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func Trace(ctx context.Context, dbhost, sql, param string, elapsed int, err error) error\n"})})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h2",children:[(0,a.jsx)(t.h2,{id:"http-\uC694\uCCAD-\uCD94\uC801",children:"HTTP \uC694\uCCAD \uCD94\uC801"}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:'import (\n    "github.com/whatap/go-api/httc"\n)\n\nfunc main(){\n    trace.Init(nil)\n    //It must be executed before closing the app.\n    defer trace.Shutdown()\n\n    ctx, _ := trace.Start(context.Background(), "Trace Http Call")\n    defer trace.End(ctx, nil)\n\n    httpcCtx, _ := httpc.Start(ctx, callUrl)\n    resp, err := http.Get(callUrl)\n    if err == nil {\n        httpc.End(httpcCtx, resp.StatusCode, "", nil)\n    } else {\n        httpc.End(httpcCtx, 0, "", err)\n    }\n}\n'})})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"http-transport-roundtrip",children:"http transport RoundTrip"}),(0,a.jsx)(t.p,{children:"RoundTrip\uC744 \uC124\uC815\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4."}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:'import (\n    "github.com/whatap/go-api/instrumentation/net/http/whataphttp"\n)\n\nfunc main() {\n    config := make(map[string]string)\n    trace.Init(config)\n    defer trace.Shutdown()\n\n    ctx, _ := trace.Start(context.Background(), "Http call")\n    defer trace.End(ctx, nil)\n\n    callUrl := "http://aaa.com/xxx"\n    client := http.DefaultClient\n    // Use WhaTap RoundTrip. Passes the context with whatap\'s TraceCtx.\n    client.Transport = whataphttp.NewRoundTrip(ctx, http.DefaultTransport)\n    resp, err := client.Get(callUrl)\n    if err != nil {\n        ...\n    }\n    defer resp.Body.Close()\n    ...\n}\n'})})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"api-2",children:"API"}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func Start(ctx context.Context, url string) (*HttpcCtx, error)\n"})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func End(httpcCtx *HttpcCtx, status int, reason string, err error) error\n"})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func Trace(ctx context.Context, host string, port int, url string, elapsed int, status int, reason string, err error) error\n"})})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h2",children:[(0,a.jsx)(t.h2,{id:"mtrace",children:"\uBA40\uD2F0 \uD2B8\uB79C\uC7AD\uC158 \uCD94\uC801(\uBD84\uC0B0 \uCD94\uC801)"}),(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"\uBA40\uD2F0 \uD2B8\uB79C\uC7AD\uC158"}),"\uC740 \uB2E4\uB978 \uC5D0\uC774\uC804\uD2B8\uB098 \uD504\uB85C\uC81D\uD2B8\uC640 \uC5F0\uAD00\uB41C \uD2B8\uB79C\uC7AD\uC158\uC744 \uC758\uBBF8\uD569\uB2C8\uB2E4. \uC640\uD0ED \uD504\uB85C\uC81D\uD2B8\uC5D0 \uB4F1\uB85D\uB41C \uC560\uD50C\uB9AC\uCF00\uC774\uC158 \uC11C\uBE44\uC2A4 \uAC04\uC758 \uD638\uCD9C\uC744 \uCD94\uC801\uD558\uB294 \uAC83\uC774 ",(0,a.jsx)(t.strong,{children:"\uBA40\uD2F0 \uD2B8\uB79C\uC7AD\uC158 \uCD94\uC801"}),"\uC785\uB2C8\uB2E4."]}),(0,a.jsxs)(t.admonition,{type:"note",children:[(0,a.jsxs)(t.p,{children:["Go \uC5D0\uC774\uC804\uD2B8\uB294 \uC138 \uAC1C\uC758 HTTP \uD5E4\uB354 \uD0A4\uAC12(",(0,a.jsx)(t.code,{children:"x-wtap-po"}),", ",(0,a.jsx)(t.code,{children:"x-wtap-mst"}),", ",(0,a.jsx)(t.code,{children:"x-wtap-sp1"}),")\uC73C\uB85C \uBA40\uD2F0 \uD2B8\uB79C\uC7AD\uC158\uC744 \uCD94\uC801\uD569\uB2C8\uB2E4. \uAC8C\uC774\uD2B8\uC6E8\uC774\uB97C \uD1B5\uACFC\uD558\uB294 HTTP \uD2B8\uB79C\uC7AD\uC158\uC774 \uC5F0\uACC4 \uCD94\uC801\uB418\uC9C0 \uC54A\uB294\uB2E4\uBA74 HTTP \uD5E4\uB354 \uC870\uAC74\uC744 \uD655\uC778\uD558\uC138\uC694."]}),(0,a.jsx)(t.p,{children:"\uC624\uD508\uC18C\uC2A4 \uCD94\uC801\uC744 \uC704\uD574 TraceContext\uB97C \uC9C0\uC6D0\uD569\uB2C8\uB2E4. (traceparent \uD5E4\uB354 \uCD94\uC801)"})]})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"\uC5D0\uC774\uC804\uD2B8-\uC124\uC815\uD558\uAE30",children:"\uC5D0\uC774\uC804\uD2B8 \uC124\uC815\uD558\uAE30"}),(0,a.jsxs)(t.p,{children:["\uBA40\uD2F0 \uD2B8\uB79C\uC7AD\uC158 \uCD94\uC801\uC744 \uC704\uD574 \uC5D0\uC774\uC804\uD2B8 \uC124\uC815 \uD30C\uC77C(",(0,a.jsx)(t.em,{children:"whatap.conf"}),")\uC5D0 \uB2E4\uC74C\uACFC \uAC19\uC774 \uC635\uC158\uC744 \uC124\uC815\uD558\uC138\uC694."]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ini",metastring:'title="whatap.conf"',children:"# Activation option, Default: false\nmtrace_enabled=true\n\n# Sampling rate, Default: 10\nmtrace_rate=100\n"})})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"request-header-\uC804\uB2EC\uD558\uAE30",children:"Request Header \uC804\uB2EC\uD558\uAE30"}),(0,a.jsx)(t.p,{children:"\uBD84\uC0B0 \uCD94\uC801 \uC815\uBCF4(\uD5E4\uB354 \uC815\uBCF4)\uB97C \uD655\uC778\uD558\uB824\uBA74 Request Header\uB97C \uC804\uB2EC\uD574\uC57C \uD569\uB2C8\uB2E4."}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:'// import "github.com/whatap/go-api/trace"\nfunc UpdateMtrace(traceCtx *trace.TraceCtx, header http.Header) \n'})}),(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"trace.StartWithRequest"})," \uD568\uC218\uB294 \uB0B4\uBD80\uC801\uC73C\uB85C ",(0,a.jsx)(t.code,{children:"UpdateMtrace"})," \uD568\uC218\uB97C \uD638\uCD9C\uD569\uB2C8\uB2E4. ",(0,a.jsx)(t.code,{children:"trace.StartWithRequest"})," \uD568\uC218\uB97C \uC0AC\uC6A9\uD558\uC9C0 \uC54A\uB294\uB2E4\uBA74 \uC9C1\uC811 \uD638\uCD9C\uD558\uC5EC \uC804\uB2EC\uBC1B\uC740 \uD5E4\uB354 \uC815\uBCF4\uB97C \uBD84\uC11D\uD574\uC57C \uD569\uB2C8\uB2E4."]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:'// func GetTraceContext(ctx context.Context) (context.Context, *TraceCtx)\n// if v := ctx.Value("whatap"); v != nil {\n//      return ctx, v.(*TraceCtx)\n// }\nctx, traceCtx := trace.GetTraceContext(ctx);\nif traceCtx != nil {\n    trace.UpdateMtrace(traceCtx, header)\n}\n'})}),(0,a.jsxs)(t.admonition,{type:"note",children:[(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"trace.Start"})," \uD568\uC218 \uB0B4\uBD80 \uCF54\uB4DC \uCC38\uC870:"]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go" showLineNumbers {6}',children:"func Start(ctx context.Context, name string) (context.Context, error) {\n    ctx, traceCtx := NewTraceContext(ctx)\n    traceCtx.Name = name\n    traceCtx.StartTime = dateutil.SystemNow()\n    // update multi trace info\n    UpdateMtrace(traceCtx, http.Header{})\n\n    ...\n"})}),(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"trace.StartWithRequest"})," \uD568\uC218 \uB0B4\uBD80 \uCF54\uB4DC \uCC38\uC870:"]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go" showLineNumbers {6}',children:"func StartWithRequest(r *http.Request) (context.Context, error) {\n    ctx, traceCtx := NewTraceContext(r.Context())\n    traceCtx.Name = r.RequestURI\n    traceCtx.StartTime = dateutil.SystemNow()\n    // update multi trace info\n    UpdateMtrace(traceCtx, r.Header)\n\n    ...\n"})})]})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"http-\uC5F0\uACB0-\uC2DC-header-\uC815\uBCF4-\uCD94\uAC00\uD558\uAE30",children:"HTTP \uC5F0\uACB0 \uC2DC Header \uC815\uBCF4 \uCD94\uAC00\uD558\uAE30"}),(0,a.jsx)(t.p,{children:"\uC678\uBD80\uB85C HTTP \uC5F0\uACB0\uD560 \uB54C Request Header\uC5D0 \uCD94\uC801\uC744 \uC704\uD55C Header \uC815\uBCF4\uB97C \uCD94\uAC00\uD558\uC138\uC694."}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go" showLineNumbers',children:'import (\n    "github.com/whatap/go-api/trace"\n)\n\nfunc GetMTrace(ctx context.Context) http.Header\n'})}),(0,a.jsxs)(t.p,{children:["\uB2E4\uC74C\uC740 \uBD84\uC0B0 \uCD94\uC801\uC5D0 \uD544\uC694\uD55C Header\uB97C \uC870\uD68C\uD558\uB294 \uD568\uC218\uC785\uB2C8\uB2E4. \uBC18\uD658\uB418\uB294 Header\uB97C \uC678\uBD80 Request \uC694\uCCAD\uC5D0 \uCD94\uAC00\uD574\uC57C \uD569\uB2C8\uB2E4. context\uC5D0\uB294 'whatap' \uD56D\uBAA9\uC758 ",(0,a.jsx)(t.code,{children:"trace.TraceContext"})," \uC815\uBCF4\uAC00 \uD3EC\uD568\uB418\uC5B4 \uC788\uC5B4\uC57C \uD569\uB2C8\uB2E4. \uD574\uB2F9 \uC815\uBCF4\uB294 ",(0,a.jsx)(t.code,{children:"trace.Start"}),", ",(0,a.jsx)(t.code,{children:"StartWithRequest"}),", ",(0,a.jsx)(t.code,{children:"StartWithContext"})," \uD568\uC218\uB97C \uC0AC\uC6A9\uD560 \uB54C \uB0B4\uBD80\uC5D0 whatap context \uC815\uBCF4\uAC00 \uCD94\uAC00\uB429\uB2C8\uB2E4."]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Example code" showLineNumbers {1}',children:"headers := trace.GetMTrace(wCtx)\nfor key, _ := range headers {\n    // req *http.Request\n    // The Add function is also available.\n    req.Header.Set(key, headers.Get(key))\n}\n"})})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"\uC790\uB3D9\uC73C\uB85C-header-\uCD94\uAC00\uD558\uAE30",children:"\uC790\uB3D9\uC73C\uB85C Header \uCD94\uAC00\uD558\uAE30"}),(0,a.jsxs)(t.p,{children:["Whatap transport(RoundTrip)\uC5D0\uB294 \uB0B4\uBD80\uC801\uC73C\uB85C ",(0,a.jsx)(t.code,{children:"GetMTrace"}),"\uB97C \uC0AC\uC6A9\uD558\uB294 \uCF54\uB4DC\uAC00 \uC774\uBBF8 \uC874\uC7AC\uD569\uB2C8\uB2E4. \uC635\uC158\uB9CC \uD65C\uC131\uD654\uD558\uBA74 \uC790\uB3D9\uC73C\uB85C Header \uC815\uBCF4\uB97C \uCD94\uAC00\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4."]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Example code" showLineNumbers',children:'import (\n    "net/http"\n    "github.com/whatap/go-api/instrumentation/net/http/whataphttp"\n)\n\n...\n\n//client := http.DefaultClient\nclient := http.Client{\n    Timeout: timeout,\n}\nclient.Transport = whataphttp.NewRoundTrip(ctx, http.DefaultTransport)\nif resp, err := client.Get(callUrl); err == nil {\n    ...\n}\n'})}),(0,a.jsxs)(t.p,{children:["\uB2E4\uC74C\uC740 \uC5EC\uB7EC \uAC1C\uC758 Transport \uC0AC\uC6A9 \uC608\uC81C\uC785\uB2C8\uB2E4. context\uC5D0\uB294 'whatap' \uD56D\uBAA9\uC758 ",(0,a.jsx)(t.code,{children:"trace.TraceContext"})," \uC815\uBCF4\uAC00 \uD3EC\uD568\uB418\uC5B4 \uC788\uC5B4\uC57C \uD569\uB2C8\uB2E4."]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Exmple code" showLineNumbers',children:'import (\n    "net/http"\n    "github.com/whatap/go-api/instrumentation/net/http/whataphttp"\n)\n\n...\n\nclient := http.DefaultClient\nclient.Transport = NewAccessLogRoundTrip(whataphttp.NewRoundTrip(ctx, http.DefaultTransport))	\n\n...\n'})})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h2",children:[(0,a.jsx)(t.h2,{id:"\uD568\uC218-\uCD94\uC801",children:"\uD568\uC218 \uCD94\uC801"}),(0,a.jsx)(t.p,{children:"\uC0AC\uC6A9\uC790 \uD568\uC218 \uB610\uB294 \uC6D0\uD558\uB294 \uAD6C\uAC04\uC758 \uC2E4\uD589 \uC2DC\uAC04\uC744 \uCE21\uC815\uD558\uAE30 \uC704\uD55C API \uC785\uB2C8\uB2E4. \uD568\uC218 \uC2E4\uD589 \uC804, \uD6C4\uB85C API\uB97C \uC124\uC815\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4."}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:'import (\n    "github.com/whatap/go-api/method"\n)\nfunc main(){\n    trace.Init(nil)\n    //It must be executed before closing the app.\n    defer trace.Shutdown()\n  \n    ctx, _ := trace.Start(context.Background(), "Trace Method")\n    defer trace.End(ctx, nil)\n  \n    getUser(ctx)\n}\n\nfunc getUser(ctx context.Context) {\n    methodCtx, _ := method.Start(ctx, "getUser")\n    defer method.End(methodCtx, nil)\n    time.Sleep(time.Duration(1) * time.Second)\n}\n'})})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"api-3",children:"API"}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func Start(ctx context.Context, name string) (*MethodCtx, error)\n"})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func End(methodCtx *MethodCtx, err error) error\n"})}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="Go"',children:"func Trace(ctx context.Context, name string, elapsed int, err error) error\n"})})]}),"\n",(0,a.jsx)(t.section,{className:"remark-sectionize-h2",children:(0,a.jsx)(t.h2,{id:"log",children:"Log"})}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"\uC5D0\uC774\uC804\uD2B8-\uC124\uC815\uD558\uAE30-1",children:"\uC5D0\uC774\uC804\uD2B8 \uC124\uC815\uD558\uAE30"}),(0,a.jsxs)(t.p,{children:["\uC560\uD50C\uB9AC\uCF00\uC774\uC158 \uC2E4\uD589 \uC804\uC5D0 ",(0,a.jsx)(t.em,{children:"whatap.conf"})," \uD30C\uC77C\uC5D0 \uC5D0\uC774\uC804\uD2B8 \uC635\uC158\uC744 \uC124\uC815\uD558\uC138\uC694."]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ini",metastring:'title="whatap.conf"',children:"# Enable all log collection\nlogsink_enabled=true\n\n# Enable stdout collection\nlogsink_stdout_enabled=true\n\n# Enable stderr collection\nlogsink_stderr_enabled=true\n\n# Optional. This is a setting for compressing data. \nlogsin_zip_enabled=true\n"})})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"\uB85C\uADF8-\uB77C\uC774\uBE0C\uB7EC\uB9AC-\uCD08\uAE30\uD654-\uC804",children:"\uB85C\uADF8 \uB77C\uC774\uBE0C\uB7EC\uB9AC \uCD08\uAE30\uD654 \uC804"}),(0,a.jsxs)(t.p,{children:["\uB85C\uADF8 \uB77C\uC774\uBE0C\uB7EC\uB9AC \uCD08\uAE30\uD654 \uC804\uC5D0 ",(0,a.jsx)(t.code,{children:"trace.Init()"})," \uD568\uC218\uB97C \uD638\uCD9C\uD574\uC57C \uD569\uB2C8\uB2E4. \uB0B4\uBD80\uC801\uC73C\uB85C ",(0,a.jsx)(t.code,{children:"os.Stdout"}),", ",(0,a.jsx)(t.code,{children:"os.Stderr"}),"\uB97C \uB798\uD551\uD569\uB2C8\uB2E4. \uC774\uD6C4 \uB85C\uADF8 \uB77C\uC774\uBE0C\uB7EC\uB9AC\uAC00 ",(0,a.jsx)(t.code,{children:"os.Stdout"}),", ",(0,a.jsx)(t.code,{children:"os.Stderr"}),"\uB97C \uC124\uC815\uD558\uBA74 \uC790\uB3D9\uC73C\uB85C \uB85C\uADF8\uB97C \uC218\uC9D1\uD569\uB2C8\uB2E4."]})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"\uB85C\uADF8-\uB77C\uC774\uBE0C\uB7EC\uB9AC-\uCD08\uAE30\uD654-\uD6C4",children:"\uB85C\uADF8 \uB77C\uC774\uBE0C\uB7EC\uB9AC \uCD08\uAE30\uD654 \uD6C4"}),(0,a.jsxs)(t.p,{children:["\uB85C\uADF8 \uB77C\uC774\uBE0C\uB7EC\uB9AC \uCD08\uAE30\uD654 \uD6C4\uC5D0\uB294 \uBCC4\uB3C4\uC758 \uC124\uC815 \uD568\uC218\uB97C \uD1B5\uD574\uC11C \uB798\uD551\uD55C ",(0,a.jsx)(t.strong,{children:"io.Writer"}),"\uB97C \uC124\uC815\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4."]}),(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"logsink.GetWriterHookStdout()"}),": ",(0,a.jsx)(t.code,{children:"os.Stderr"}),"\uB97C \uB798\uD551\uD55C ",(0,a.jsx)(t.strong,{children:"io.Writer"}),"\uB97C \uBC18\uD658\uD569\uB2C8\uB2E4. ",(0,a.jsx)(t.code,{children:"os.Stdout"}),"\uC5D0 \uCD9C\uB825\uD558\uBA74\uC11C \uB3D9\uC2DC\uC5D0 \uD574\uB2F9 \uB85C\uADF8\uB97C \uC640\uD0ED \uB85C\uADF8\uB85C \uC218\uC9D1\uD569\uB2C8\uB2E4."]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"logsink.GetWriterHookStderr()"}),":  ",(0,a.jsx)(t.code,{children:"os.Stderr"}),"\uB97C \uB798\uD551\uD55C ",(0,a.jsx)(t.strong,{children:"io.Writer"}),"\uB97C \uBC18\uD658\uD569\uB2C8\uB2E4. \uB798\uD551\uD55C ",(0,a.jsx)(t.strong,{children:"io.Writer"}),"\uB294 ",(0,a.jsx)(t.code,{children:"os.Stderr"}),"\uC5D0 \uCD9C\uB825 \uD6C4 \uB85C\uADF8 \uB0B4\uC6A9\uC744 \uC640\uD0ED \uB85C\uADF8\uB85C \uC218\uC9D1\uD569\uB2C8\uB2E4."]}),"\n"]}),"\n"]})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h3",children:[(0,a.jsx)(t.h3,{id:"api-4",children:"API"}),(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"os.Stdout"}),"\uB97C \uB798\uD551\uD55C ",(0,a.jsx)(t.strong,{children:"io.Writer"}),"\uB97C \uBC18\uD658\uD569\uB2C8\uB2E4."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",children:"func GetWriterHookStdout() io.Writer\n"})}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"os.Stderr"}),"\uB97C \uB798\uD551\uD55C ",(0,a.jsx)(t.strong,{children:"io.Writer"}),"\uB97C \uBC18\uD658\uD569\uB2C8\uB2E4."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",children:"func GetWriterHookStderr() io.Writer\n"})}),"\n"]}),"\n"]}),(0,a.jsx)(t.p,{children:"\uB2E4\uC74C \uD328\uD0A4\uC9C0\uBCC4 \uCF54\uB4DC \uC608\uC81C\uB97C \uCC38\uC870\uD558\uC138\uC694."})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h4",children:[(0,a.jsx)(t.h4,{id:"log-package",children:"log package"}),(0,a.jsxs)(t.p,{children:["log \uD328\uD0A4\uC9C0\uB294 ",(0,a.jsx)(t.strong,{children:"import"})," \uC2DC\uC810(",(0,a.jsx)(t.code,{children:"init"})," \uD568\uC218)\uC5D0\uC11C ",(0,a.jsx)(t.code,{children:"os.Stderr"}),"\uB97C \uC124\uC815\uD569\uB2C8\uB2E4. ",(0,a.jsx)(t.code,{children:"trace.Init"})," \uD568\uC218\uB97C \uBA3C\uC800 \uD638\uCD9C\uD560 \uC218 \uC5C6\uAE30 \uB54C\uBB38\uC5D0 \uB798\uD551\uD55C ",(0,a.jsx)(t.strong,{children:"io.Writer"})," (",(0,a.jsx)(t.code,{children:"os.Stderr"}),")\uB97C ",(0,a.jsx)(t.code,{children:"log.SetOutput"})," \uD568\uC218\uB97C \uD1B5\uD574 \uC124\uC815\uD569\uB2C8\uB2E4."]}),(0,a.jsxs)(t.p,{children:["\uC774\uD6C4 \uC0AC\uC6A9\uB418\uB294 log \uD328\uD0A4\uC9C0\uC758 ",(0,a.jsx)(t.code,{children:"print"})," \uD568\uC218\uB97C \uC0AC\uC6A9\uD55C \uCD9C\uB825\uC740 \uB798\uD551\uD55C ",(0,a.jsx)(t.strong,{children:"io.Writer"}),"\uB97C \uD1B5\uD574\uC11C ",(0,a.jsx)(t.code,{children:"os.Stderr"}),"\uC5D0 \uCD9C\uB825\uC740 \uC720\uC9C0\uD558\uBA74\uC11C \uB3D9\uC2DC\uC5D0 \uB85C\uADF8 \uB0B4\uC6A9\uC744 \uC640\uD0ED \uB85C\uADF8\uB85C \uC218\uC9D1\uD569\uB2C8\uB2E4."]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="log package"',children:'import (\n    "log"\n    "github.com/whatap/go-api/logsink"\n)\n\n...\n\nif logsink.GetWriterHookStderr() != nil {\n    // set single writer\n    log.SetOutput(logsink.GetWriterHookStderr())	\n    \n    // set multi writer \n    multi := io.MultiWriter(file, logsink.GetWriterFromStderr())\n    log.SetOutput(logsink.GetWriterHookStderr())\n}\n\n// \nlog.Println("aaaaa")\n...\n'})})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h4",children:[(0,a.jsx)(t.h4,{id:"gouberorgzap",children:"go.uber.org/zap"}),(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"os.Stdout"}),"\uC744 \uC124\uC815\uD558\uAE30 \uC804\uC5D0 ",(0,a.jsx)(t.code,{children:"trace.Init()"})," \uD568\uC218\uB97C \uD638\uCD9C\uD558\uBA74 \uC790\uB3D9\uC73C\uB85C \uB85C\uADF8\uB97C \uC218\uC9D1\uD569\uB2C8\uB2E4. ",(0,a.jsx)(t.code,{children:"os.Stdout"})," \uCD9C\uB825\uC740 \uC720\uC9C0\uD558\uBA74\uC11C \uB3D9\uC2DC\uC5D0 \uC640\uD0ED \uB85C\uADF8\uB85C \uC218\uC9D1\uD569\uB2C8\uB2E4."]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="go.uber.org/zap"',children:'import (\n    "github.com/whatap/go-api/trace"\n    "github.com/whatap/go-api/logsink"\n    \n    "go.uber.org/zap"\n    "go.uber.org/zap/zapcore"\n)\n\nfunc main() {\n    trace.Init(nil)\n    //It must be executed before closing the app.\n    defer trace.Shutdown()\n\n    // fmt.Println("Logger stdout=", os.Stdout, zapcore.AddSync(os.Stdout))\n    consoleCore := zapcore.NewCore(\n        zapcore.NewConsoleEncoder(consoleEncoderConfig), \n        zapcore.AddSync(os.Stdout),                      \n        zap.InfoLevel,\n    )\n\n    // Menggabungkan core file dan console\n    core := zapcore.NewTee(consoleCore)\n    Log = zap.New(core, zap.AddCaller(), zap.AddStacktrace(zapcore.ErrorLevel))\n    Log.Info("logger started")\n\n    ...\n}\n'})})]}),"\n",(0,a.jsxs)(t.section,{className:"remark-sectionize-h4",children:[(0,a.jsx)(t.h4,{id:"githubcomsirupsenlogrus",children:"github.com/sirupsen/logrus"}),(0,a.jsxs)(t.p,{children:["\uB798\uD551\uD55C ",(0,a.jsx)(t.strong,{children:"io.Writer"}),"\uB97C \uC124\uC815\uD558\uBA74 ",(0,a.jsx)(t.code,{children:"os.Stderr"})," \uCD9C\uB825\uC740 \uC720\uC9C0\uD558\uBA74\uC11C \uB3D9\uC2DC\uC5D0 \uC640\uD0ED \uB85C\uADF8\uB85C \uC218\uC9D1\uD569\uB2C8\uB2E4."]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",metastring:'title="github.com/sirupsen/logrus"',children:'package main\n\nimport (\n    "time"\n\n    log "github.com/sirupsen/logrus"\n\n    "github.com/whatap/go-api/logsink"\n    "github.com/whatap/go-api/trace"\n)\n\nfunc main() {\n    trace.Init(nil)\n    defer trace.Shutdown()\n\n    //In WhaTap, set io.Writer wrapping os.Stderr as the output of logrus\n    if logsink.GetWriterHookStderr() != nil {\n        log.SetOutput(logsink.GetWriterHookStderr())\n    }\n\n    for i := 0; i < 100; i++ {\n        log.WithFields(log.Fields{\n            "animal":  "tiger",\n            "habitat": "mountain",\n        }).Info("Index:[", i, "] A tiger appears")\n\n        time.Sleep(100 * time.Millisecond)\n    }\n}\n'})})]})]})}function h(e={}){let{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},50065:function(e,t,n){n.d(t,{Z:function(){return i},a:function(){return c}});var r=n(67294);let a={},s=r.createContext(a);function c(e){let t=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);