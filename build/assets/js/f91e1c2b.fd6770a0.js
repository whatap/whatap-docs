"use strict";(self.webpackChunkWhaTap_Docs=self.webpackChunkWhaTap_Docs||[]).push([[92886],{33771:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>o});var i=t(74848),s=t(28453);const a={id:"openapi-mxql",title:"MXQL Open API",description:"It explains how to view the MXQL data by using the open API.",tags:["Open API","API","MXQL"]},r=void 0,l={id:"apidoc/openapi-mxql",title:"MXQL Open API",description:"It explains how to view the MXQL data by using the open API.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/apidoc/openapi-mxql.mdx",sourceDirName:"apidoc",slug:"/apidoc/openapi-mxql",permalink:"/apidoc/openapi-mxql",draft:!1,unlisted:!1,editUrl:"undefined/docs/apidoc/openapi-mxql.mdx",tags:[{inline:!0,label:"Open API",permalink:"/tags/open-api"},{inline:!0,label:"API",permalink:"/tags/api"},{inline:!0,label:"MXQL",permalink:"/tags/mxql"}],version:"current",frontMatter:{id:"openapi-mxql",title:"MXQL Open API",description:"It explains how to view the MXQL data by using the open API.",tags:["Open API","API","MXQL"]},sidebar:"openapiSidebar",previous:{title:"Viewing the short-term information",permalink:"/apidoc/openapi-call-short-stat"}},d={},o=[{value:"MXQL open API types",id:"mxql-open-api-types",level:2},{value:"Calling the MXQL open API",id:"calling-the-mxql-open-api",level:2},{value:"MXQL text API",id:"text-api",level:3},{value:"MXQL path API",id:"path-api",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",section:"section",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"The following explains how to view the MXQL data by using the open API."}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["For more information about MXQL, see ",(0,i.jsx)(n.a,{href:"../mxql/mxql-overview",children:"the following"}),"."]})}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,i.jsx)(n.h2,{id:"mxql-open-api-types",children:"MXQL open API types"}),(0,i.jsx)(n.p,{children:"You can use MXQL as follows."}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"How to write MXQL queries to retrieve data"}),"\n",(0,i.jsxs)(n.li,{children:["As in ",(0,i.jsx)(n.a,{href:"../mxql/mxql-guide#custom-query-saas",children:"the following"}),", the method how to retrieve data by the ",(0,i.jsx)(n.strong,{children:"predefined MXQL query list provided by the SaaS service"})]}),"\n"]}),(0,i.jsx)(n.p,{children:"Therefore, the API path used in each case differs."}),(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"How to use MXQL"}),(0,i.jsx)(n.th,{children:"API"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"In case of writing the MXQL queries"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#text-api",children:"MXQL text API"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:["In case of using the ",(0,i.jsx)(n.strong,{children:"predefined MXQL query list provided by the SaaS service"})," (see ",(0,i.jsx)(n.a,{href:"../mxql/mxql-guide#custom-query-saas",children:"the following"}),")"]}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#path-api",children:"MXQL path API"})})]})]})]})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,i.jsx)(n.h2,{id:"calling-the-mxql-open-api",children:"Calling the MXQL open API"}),(0,i.jsx)(n.p,{children:"The content included in the header upon open API call is as follows:"}),(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Key"}),(0,i.jsx)(n.th,{children:"Set value"}),(0,i.jsx)(n.th,{children:"Remarks"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{rowSpan:"2",children:"Header"}),(0,i.jsx)(n.td,{children:"x-whatap-token"}),(0,i.jsxs)(n.td,{children:["API Token ",(0,i.jsx)(n.code,{children:"{{PROJECT API TOKEN}}"})]}),(0,i.jsxs)(n.td,{children:["Project API Token: Select a project > ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Management"})})," > ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Project Management"})})," > ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Api Token"})})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"x-whatap-pcode"}),(0,i.jsxs)(n.td,{children:["Project code ",(0,i.jsx)(n.code,{children:"{{projectCode}}"})]}),(0,i.jsxs)(n.td,{children:["Project code: Select Project > ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Management"})})," > ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Project management"})})," > ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Project code"})})]})]})]})]}),(0,i.jsxs)(n.admonition,{type:"caution",children:[(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Constraints of the MXQL open API"})}),(0,i.jsx)(n.p,{children:"You can search up to 31 days in a single request."})]})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,i.jsx)(n.h3,{id:"text-api",children:"MXQL text API"}),(0,i.jsx)(n.p,{children:"The following image is an example of the MXQL execution result."}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://img.whatap.io/media/images/open_api_mxql_text_example.png",alt:"Example of MXQL execution result"})}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)("span",{class:"apitype",children:"POST"})," ",(0,i.jsx)(n.a,{href:"https://api.whatap.io/open/api/flush/mxql/text",children:"https://api.whatap.io/open/api/flush/mxql/text"})]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:"title='Request'",children:'curl --location \'https://api.whatap.io/open/api/flush/mxql/text\' \\\n-H \'x-whatap-token: {{PROJECT API TOKEN}}\' \\\n-H \'x-whatap-pcode: {{projectCode}}\' \\\n-H \'Content-Type: application/json\' \\\n-d \'{\n  "stime": 1639016640000,\n  "etime": 1639016940000,\n  "mql": "CATEGORY app_counter\\nOID [ $oidFirst, $oidSecond ]\\nTAGLOAD\\nSELECT\\nINJECT sortByOidDesc",\n  "limit": 2,\n  "pageKey": "mxql",\n  "inject": {\n    "sortByOidDesc": "ORDER {key : [oid],  sort :[desc]}"\n  },\n  "param": {\n    "$oidFirst": "1499132250",\n    "$oidSecond": "1670734023"\n  }\n}\'\n'})}),(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Key"}),(0,i.jsx)(n.th,{children:"Value"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"stime"}),(0,i.jsx)(n.td,{children:"Data lookup start time"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"etime"}),(0,i.jsx)(n.td,{children:"Data lookup end time"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"mql"}),(0,i.jsx)(n.td,{children:"Written MXQL query"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"limit"}),(0,i.jsx)(n.td,{children:"Maximum data query count"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"pageKey"}),(0,i.jsx)(n.td,{children:"The string MXQL's fixed value"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"inject"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)("span",{class:"api",children:"Optional"})," See ",(0,i.jsx)(n.a,{href:"../mxql/mxql-calculate#inject",children:"the following"}),(0,i.jsx)("br",{}),"e.g. ",(0,i.jsx)(n.code,{children:'{ "default": "ORDER {key : [oid],  sort : [desc] }"}'})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"param"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)("span",{class:"api",children:"Optional"})," See ",(0,i.jsx)(n.a,{href:"../mxql/mxql-guide#bind-parameter",children:"the following"}),(0,i.jsx)("br",{})," e.g. ",(0,i.jsx)(n.code,{children:'{ "$oidFirst": "520111224", "$oidSecond": "1031483086" }'})]})]})]})]}),(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"stime"}),", ",(0,i.jsx)(n.code,{children:"etime"}),", ",(0,i.jsx)(n.code,{children:"$oidFirst"}),", and ",(0,i.jsx)(n.code,{children:"$oidSecond"})," in the request statements must be applied as the time and oid values for the user environment."]})}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"In case of no queried data"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:"title='ResponseBody Example 1'",children:"[]\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"In case of any queried data"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:"title='ResponseBody Example 2'",children:'[\n  {\n    "time": 1639016640000,\n    "pcode": 101,\n    "pname": "Virtual",\n    "okind": -1085056726,\n    "onode": 334634079,\n    "oname": "22136-8075",\n    "okindName": "ote-virtual-1",\n    "onodeName": "node-1",\n    "host_ip": "192.168.1.57",\n    "container": "ote-8075.service",\n    "pid": 22206,\n    "type": "java",\n    "containerKey": 1876424218,\n    "tx_count": 58,\n    "tx_error": 0,\n    "tx_time": 1643.9138,\n    "apdex_satisfied": 41,\n    "apdex_tolerated": 16,\n    "apdex_total": 58,\n    "tx_dbc_time": 13.655172,\n    "tx_sql_time": 222.15517,\n    "tx_httpc_time": 717.4138,\n    "sql_count": 129,\n    "sql_error": 0,\n    "sql_time": 101.387596,\n    "sql_fetch_count": 37621,\n    "sql_fetch_time": 4.5187527E-4,\n    "httpc_count": 41,\n    "httpc_error": 0,\n    "httpc_time": 1073.4878,\n    "active_tx_count": 20,\n    "active_tx_0": 19,\n    "active_tx_3": 1,\n    "active_tx_8": 0,\n    "tps": 13.833333,\n    "resp_time": 1628,\n    "arrival_rate": 12.6,\n    "pack_dropped": 110,\n    "metering": 4,\n    "_clock_delta_": 180,\n    "oid": 1670734023\n  },\n  {\n    "time": 1639016640000,\n    "pcode": 101,\n    "pname": "Virtual",\n    "okind": -933992004,\n    "onode": 1693789385,\n    "oname": "22134-8074",\n    "okindName": "ote-virtual-0",\n    "onodeName": "node-0",\n    "host_ip": "192.168.1.57",\n    "container": "ote-8074.service",\n    "pid": 22202,\n    "type": "java",\n    "containerKey": 2024596057,\n    "tx_count": 56,\n    "tx_error": 0,\n    "tx_time": 1545.4464,\n    "apdex_satisfied": 37,\n    "apdex_tolerated": 18,\n    "apdex_total": 56,\n    "tx_dbc_time": 13.375,\n    "tx_sql_time": 209.01785,\n    "tx_httpc_time": 661.3214,\n    "sql_count": 125,\n    "sql_error": 0,\n    "sql_time": 77.808,\n    "sql_fetch_count": 41112,\n    "sql_fetch_time": 3.162094E-4,\n    "httpc_count": 39,\n    "httpc_error": 0,\n    "httpc_time": 1138.1538,\n    "active_tx_count": 18,\n    "active_tx_0": 14,\n    "active_tx_3": 4,\n    "active_tx_8": 0,\n    "tps": 10,\n    "resp_time": 2924,\n    "arrival_rate": 10.8,\n    "pack_dropped": 35,\n    "metering": 4,\n    "_clock_delta_": 128,\n    "oid": 1499132250\n  }\n]\n'})}),"\n"]}),"\n"]})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,i.jsx)(n.h3,{id:"path-api",children:"MXQL path API"}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)("span",{class:"apitype",children:"POST"})," ",(0,i.jsx)(n.a,{href:"https://api.whatap.io/open/api/flush/mxql/path",children:"https://api.whatap.io/open/api/flush/mxql/path"})]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:"title='Request'",children:'# Add the _pk_ column with INJECT; param is unavailable. \ncurl --location \'https://api.whatap.io/open/api/flush/mxql/path\' \\\n-H \'x-whatap-token: {{PROJECT API TOKEN}}\' \\\n-H \'x-whatap-pcode: {{projectCode}}\' \\\n-H \'Content-Type: application/json\' \\\n-d \'{\n  "stime": 1639016640000,\n  "etime": 1639016940000,\n  "mql": "/app/act_tx/agent_with_tx",\n  "limit": 2,\n  "pageKey": "mxql",\n  "inject": {\n    "default": "CREATE {key : _pk_, value : okindName}"\n  },\n  "param": {\n  }\n}\'\n'})}),(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Key"}),(0,i.jsx)(n.th,{children:"Value"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"stime"}),(0,i.jsx)(n.td,{children:"Data lookup start time"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"etime"}),(0,i.jsx)(n.td,{children:"Data lookup end time"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"mql"}),(0,i.jsxs)(n.td,{children:["See ",(0,i.jsx)(n.a,{href:"../mxql/mxql-guide#custom-query-saas",children:"the following"}),"."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"limit"}),(0,i.jsx)(n.td,{children:"Maximum data query count"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"pageKey"}),(0,i.jsx)(n.td,{children:"The string MXQL's fixed value"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"inject"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)("span",{class:"api",children:"Optional"})," See ",(0,i.jsx)(n.a,{href:"../mxql/mxql-calculate#inject",children:"the following"}),(0,i.jsx)("br",{}),"e.g. ",(0,i.jsx)(n.code,{children:'{ "default": "ORDER {key : [oid],  sort : [desc] }"}'})]})]})]})]}),(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"stime"})," and ",(0,i.jsx)(n.code,{children:"etime"})," in the request statement must be applied as the time for the user environment."]})}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"In case of no queried data"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:"title='ResponseBody Example 1'",children:"[]\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"In case of any queried data"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:"title='ResponseBody Example 1'",children:'[\n  {\n    "pcode": 101,\n    "pname": "Virtual",\n    "oid": -1348176005,\n    "oname": "22137-8071",\n    "otype": "ap",\n    "okind": -1085056726,\n    "okindName": "ote-virtual-1",\n    "onode": 334634079,\n    "onodeName": "node-1",\n    "type": "ap",\n    "subtype": "java",\n    "version": "2.1.0 20211207u",\n    "os_name": "Linux",\n    "ip": "192.168.1.57",\n    "container_id": 842770198,\n    "metering": 4,\n    "status": "ok",\n    "normal": 12,\n    "slow": 1,\n    "verySlow": 0,\n    "total": 13,\n    "_pk_": "okindName"\n  },\n  {\n    "pcode": 101,\n    "pname": "Virtual",\n    "oid": -883058050,\n    "oname": "22141-8070",\n    "otype": "ap",\n    "okind": -933992004,\n    "okindName": "ote-virtual-0",\n    "onode": 1693789385,\n    "onodeName": "node-0",\n    "type": "ap",\n    "subtype": "java",\n    "version": "2.1.0 20211207u",\n    "os_name": "Linux",\n    "ip": "192.168.1.57",\n    "container_id": 624997205,\n    "metering": 4,\n    "status": "ok",\n    "normal": 19,\n    "slow": 1,\n    "verySlow": 0,\n    "total": 20,\n    "_pk_": "okindName"\n  }\n]\n'})}),"\n"]}),"\n"]})]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>l});var i=t(96540);const s={},a=i.createContext(s);function r(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);