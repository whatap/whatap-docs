"use strict";(self.webpackChunkwhatap_docs=self.webpackChunkwhatap_docs||[]).push([["52586"],{62313:function(e,n,t){t.r(n),t.d(n,{metadata:()=>s,default:()=>h,frontMatter:()=>o,contentTitle:()=>a,toc:()=>c,assets:()=>r});var s=JSON.parse('{"id":"java/agent-log","title":"Agent log configuration","description":"The following explains how to manage log data generated in the Java application environment through the agent. It includes the configuration of the path and name of the log file, retention period setting, log monitoring, and how to enable custom log tracing. It also provides various options for log management to help manage system logs efficiently.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/java/agent-log.mdx","sourceDirName":"java","slug":"/java/agent-log","permalink":"/whatap-docs/en/java/agent-log","draft":false,"unlisted":false,"editUrl":"undefined/docs/java/agent-log.mdx","tags":[],"version":"current","frontMatter":{"id":"agent-log","title":"Agent log configuration","description":"The following explains how to manage log data generated in the Java application environment through the agent. It includes the configuration of the path and name of the log file, retention period setting, log monitoring, and how to enable custom log tracing. It also provides various options for log management to help manage system logs efficiently.","keywords":["Java","Application","Agent","Log"],"isTranslationMissing":false},"sidebar":"javaSidebar","previous":{"title":"Agent performance","permalink":"/whatap-docs/en/java/agent-performance"},"next":{"title":"Transactions","permalink":"/whatap-docs/en/java/agent-transaction"}}'),i=t(74848),l=t(84429);let o={id:"agent-log",title:"Agent log configuration",description:"The following explains how to manage log data generated in the Java application environment through the agent. It includes the configuration of the path and name of the log file, retention period setting, log monitoring, and how to enable custom log tracing. It also provides various options for log management to help manage system logs efficiently.",keywords:["Java","Application","Agent","Log"],isTranslationMissing:!1},a,r={},c=[{value:"Setting the path and name",id:"setting-the-path-and-name",level:2},{value:"Log management options",id:"log-management-options",level:2},{value:"LogSink",id:"logsink",level:2},{value:"Enabling the log monitoring function",id:"enabling-the-log-monitoring-function",level:3},{value:"Collecting framework logs",id:"collecting-framework-logs",level:3},{value:"Setting to exclude a specific log appender",id:"excludeappender",level:3}];function d(e){let n={admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",section:"section",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"The following explains how to manage log data generated in the Java application environment through the agent. It includes the configuration of the path and name of the log file, retention period setting, log monitoring, and how to enable custom log tracing. It also provides various options for log management to help manage system logs efficiently."}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,i.jsx)(n.h2,{id:"setting-the-path-and-name",children:"Setting the path and name"}),(0,i.jsxs)(n.p,{children:["The path and name of the agent log can be set in ",(0,i.jsx)(n.em,{children:"whatap.conf"}),". The default value of ",(0,i.jsx)(n.code,{children:"log_root"})," is the ",(0,i.jsxs)(n.em,{children:[(0,i.jsx)(n.code,{children:"${WHATAP_HOME}"}),"/logs"]})," path."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"log_root=whatap/logs\nlog_name=whatap\n"})})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,i.jsx)(n.h2,{id:"log-management-options",children:"Log management options"}),(0,i.jsxs)(n.p,{children:["By writing the log-related options in ",(0,i.jsx)(n.em,{children:"whatap.conf"}),", you can manage the log content."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"watchlog_enabled=true\nlog_rotation_enabled=true\nlog_oname_enabled=true\nlog_keep_days=7\n"})}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"watchlog_enabled"})," ",(0,i.jsx)("span",{class:"type",children:"Boolean"})]}),"\n",(0,i.jsxs)(n.p,{children:["Default ",(0,i.jsx)(n.code,{children:"false"})]}),"\n",(0,i.jsxs)(n.p,{children:["If the value is ",(0,i.jsx)(n.code,{children:"true"}),", the log monitoring is enabled."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"watchlog_check_interval"})," ",(0,i.jsx)("span",{class:"type",children:"Int"})]}),"\n",(0,i.jsxs)(n.p,{children:["Default ",(0,i.jsx)(n.code,{children:"2000"})]}),"\n",(0,i.jsx)(n.p,{children:"It is the interval for monitoring the logs. At every interval, it checks whether any record has been added to the log file."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"watchlog_read_count"})," ",(0,i.jsx)("span",{class:"type",children:"Int"})]}),"\n",(0,i.jsxs)(n.p,{children:["Default ",(0,i.jsx)(n.code,{children:"8"})]}),"\n",(0,i.jsxs)(n.p,{children:["It is the maximum count to read logs. It reads as many as ",(0,i.jsx)(n.code,{children:"watchlog_buffer_size"})," at a time."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"watchlog_buffer_size"})," ",(0,i.jsx)("span",{class:"type",children:"Int"})]}),"\n",(0,i.jsxs)(n.p,{children:["Default ",(0,i.jsx)(n.code,{children:"131072(128k)"})]}),"\n",(0,i.jsx)(n.p,{children:"Size for reading logs at a time."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"watchlog.LOGKEY"})}),"\n",(0,i.jsxs)(n.p,{children:["This is the setting to monitor a log file. Enter the ",(0,i.jsx)(n.code,{children:"file"})," name and set multiple ",(0,i.jsx)(n.code,{children:"words"})," with the delimiter, comma (,). It watches the logs at ",(0,i.jsx)(n.code,{children:"check_interval"})," and alerts you when any keywords are found. Once an alert has occurred, the occurrence of alert stops for the ",(0,i.jsx)(n.code,{children:"silent"})," period."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"watchlog.LOGKEY.enabled"})," ",(0,i.jsx)("span",{class:"type",children:"Boolean"})," Default ",(0,i.jsx)(n.code,{children:"true"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"watchlog.LOGKEY.file"})," ",(0,i.jsx)("span",{class:"type",children:"String"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"watchlog.LOGKEY.words"})," ",(0,i.jsx)("span",{class:"type",children:"String"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"watchlog.LOGKEY.silent"})," ",(0,i.jsx)("span",{class:"type",children:"Int"})," Default ",(0,i.jsx)(n.code,{children:"10000"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"watchlog.LOGKEY.check_interval"})," ",(0,i.jsx)("span",{class:"type",children:"Int"})," Default ",(0,i.jsx)(n.code,{children:"1000"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"log_root"})," ",(0,i.jsx)("span",{class:"type",children:"String"})]}),"\n",(0,i.jsxs)(n.p,{children:["Default ",(0,i.jsx)(n.code,{children:"${WHATAP_HOME}"}),"/logs"]}),"\n",(0,i.jsx)(n.p,{children:"Set the agent's log path."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"log_datasource_lookup_enabled"})," ",(0,i.jsx)("span",{class:"type",children:"Boolean"})]}),"\n",(0,i.jsxs)(n.p,{children:["Default ",(0,i.jsx)(n.code,{children:"true"})]}),"\n",(0,i.jsx)(n.p,{children:"The function to record the log is activated in case of DataSource upon InitialContext Lookup."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"log_rotation_enabled"})," ",(0,i.jsx)("span",{class:"type",children:"Boolean"})]}),"\n",(0,i.jsxs)(n.p,{children:["Default ",(0,i.jsx)(n.code,{children:"true"})]}),"\n",(0,i.jsxs)(n.p,{children:["The function to store agent log files by date is activated. The log file name is stored in the format of ",(0,i.jsx)(n.em,{children:"whatap-'yyyymmdd'.log"}),". If the value is ",(0,i.jsx)(n.code,{children:"false"}),", the log file name is stored in the format of ",(0,i.jsx)(n.em,{children:"whatap.log"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"log_keep_days"})," ",(0,i.jsx)("span",{class:"type",children:"Int"})]}),"\n",(0,i.jsxs)(n.p,{children:["Default ",(0,i.jsx)(n.code,{children:"7"})]}),"\n",(0,i.jsxs)(n.p,{children:["It sets the log file retention period. It works only when the ",(0,i.jsx)(n.code,{children:"log_rotation_enabled"})," value is ",(0,i.jsx)(n.code,{children:"true"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"log_oname_enabled"})," ",(0,i.jsx)("span",{class:"type",children:"Boolean"})]}),"\n",(0,i.jsxs)(n.p,{children:["Default ",(0,i.jsx)(n.code,{children:"false"})]}),"\n",(0,i.jsxs)(n.p,{children:["If the value is ",(0,i.jsx)(n.code,{children:"true"}),", add agent names for each log."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(42316).A+"",width:"1500",height:"282"})}),"\n"]}),"\n"]})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,i.jsx)(n.h2,{id:"logsink",children:"LogSink"}),(0,i.jsx)(n.p,{children:"In whatap.agent-2.1.0 or later, the LogSink function is provided for integrated monitoring of the application server."}),(0,i.jsx)(n.admonition,{type:"caution",children:(0,i.jsx)(n.p,{children:"The LogSink option is available in whatap.agent-2.1.0 or later."})})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,i.jsx)(n.h3,{id:"enabling-the-log-monitoring-function",children:"Enabling the log monitoring function"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"logsink_enabled"})," ",(0,i.jsx)("span",{class:"type",children:"Boolean"})]}),"\n",(0,i.jsxs)(n.p,{children:["Default ",(0,i.jsx)(n.code,{children:"false"})]}),"\n",(0,i.jsx)(n.p,{children:"It enables the log monitoring function."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"logsink_trace_enabled"})," ",(0,i.jsx)("span",{class:"type",children:"Boolean"})]}),"\n",(0,i.jsxs)(n.p,{children:["Default ",(0,i.jsx)(n.code,{children:"false"})]}),"\n",(0,i.jsx)(n.p,{children:"Set whether or not to expose the log tab of the transaction trace by inserting the transaction ID into the logs."}),"\n"]}),"\n"]})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,i.jsx)(n.h3,{id:"collecting-framework-logs",children:"Collecting framework logs"}),(0,i.jsxs)(n.p,{children:["To monitor logs collected from the framework, add the setting and plugin to intercept logs from the module. Set the default category name for logs collected in the framework to ",(0,i.jsx)(n.code,{children:"AppLog"}),". The default value is the same as in the ",(0,i.jsx)(n.code,{children:"hooklog_enabled"})," option."]}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"hooklog_enabled"})," ",(0,i.jsx)("span",{class:"type",children:"Boolean"})]}),"\n",(0,i.jsxs)(n.p,{children:["Default ",(0,i.jsx)(n.code,{children:"logsink_enabled"})]}),"\n",(0,i.jsx)(n.p,{children:"Set whether or not to enable the log tracing."}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"In Java Agent 2.2.4 or later, the changed options can be applied without restarting the application."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["If the ",(0,i.jsx)(n.code,{children:"hooklog_enabled"})," value has been changed, restarting is required for Java agent versions less than 2.2.4. The default value of ",(0,i.jsx)(n.code,{children:"hooklog_enabled"})," is ",(0,i.jsx)(n.code,{children:"logsink_enabled"}),". Accordingly, if ",(0,i.jsx)(n.code,{children:"logsink_enabled=true"})," is set and the Java application is restarted, ",(0,i.jsx)(n.code,{children:"hooklog_enabled"})," is set to ",(0,i.jsx)(n.code,{children:"true"}),"."]}),"\n"]}),"\n"]})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"hooklog_custom_methods"})," ",(0,i.jsx)("span",{class:"type",children:"String"})]}),"\n",(0,i.jsx)(n.p,{children:"Register a custom log. An arbitrary log framework content is delivered. Use this to trace logs of the log module created on the website."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:"title='Java'",children:"package io.home.test;\n\npublic class MyLog {  \n  public void customLog(String log) { ... }\n}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"hooklog_custom_methods=io.home.test.MyLog.customLog\n"})}),"\n"]}),"\n"]})]}),"\n",(0,i.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,i.jsx)(n.h3,{id:"excludeappender",children:"Setting to exclude a specific log appender"}),(0,i.jsx)(n.p,{children:"It provides agent options to exclude specific log appenders. The following agent options are provided to exclude specific appenders from monitoring."}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"ignore_logback_appender_set"})," ",(0,i.jsx)("span",{class:"type",children:"String"})," ",(0,i.jsx)("code",{className:"my",children:"Java Agent v2.2.28 or later"})]}),"\n",(0,i.jsxs)(n.p,{children:["It is the agent option to exclude specific appenders when tracing logback-1.2.8. For example, to exclude ",(0,i.jsx)(n.code,{children:"CONSOLE"})," and ",(0,i.jsx)(n.code,{children:"ACCESS_APPENDER"}),", see the following example."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",metastring:'title="whatap.conf"',children:"weaving=logback-1.2.8\n# example: ignore 'CONSOLE', 'ACCESS_APPENDER' appender\nignore_logback_appender_set=CONSOLE,ACCESS_APPENDER\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["If you apply this agent option, you must additionally apply the ",(0,i.jsx)(n.code,{children:"weaving=logback-1.2.8"})," option."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"ACCESS_APPENDER"})," is an example value. Specify an appender name that matches your environment."]}),"\n"]}),"\n"]})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"ignore_log4j_appender_set"})," ",(0,i.jsx)("span",{class:"type",children:"String"})," ",(0,i.jsx)("code",{className:"my",children:"Java Agent v2.2.28 or later"})]}),"\n",(0,i.jsxs)(n.p,{children:["It is the agent option to exclude specific appenders when tracing log4j-2.17. For example, to exclude ",(0,i.jsx)(n.code,{children:"CONSOLE"})," and ",(0,i.jsx)(n.code,{children:"ACCESS_APPENDER"}),", see the following example."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",metastring:'title="whatap.conf"',children:"weaving=log4j-2.17\n# example: ignore 'CONSOLE', 'ACCESS_APPENDER' appender\nignore_log4j_appender_set=CONSOLE,ACCESS_APPENDER\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["When applying this agent option, you must additionally apply the ",(0,i.jsx)(n.code,{children:"weaving=log4j-2.17"})," option."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"ACCESS_APPENDER"})," is an example value. Specify an appender name that matches your environment."]}),"\n"]}),"\n"]})}),"\n"]}),"\n"]})]})]})}function h(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},42316:function(e,n,t){t.d(n,{A:()=>s});let s=t.p+"assets/images/java-agent-log-oname-9873bf818d3db89a259e9272d79a0d74.png"},84429:function(e,n,t){t.d(n,{R:()=>o,x:()=>a});var s=t(96540);let i={},l=s.createContext(i);function o(e){let n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);