"use strict";(self.webpackChunkwhatap_docs=self.webpackChunkwhatap_docs||[]).push([["93226"],{23663:function(e,n,t){t.r(n),t.d(n,{metadata:()=>a,default:()=>m,frontMatter:()=>r,contentTitle:()=>l,toc:()=>c,assets:()=>i});var a=JSON.parse('{"id":"kubernetes/k8s-collection-server-ip","title":"Changing the Kubernetes collection server\'s IP","description":"The following explains how to change the IP of the Kubernetes product\'s collection server.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/kubernetes/k8s-collection-server-ip.mdx","sourceDirName":"kubernetes","slug":"/kubernetes/k8s-collection-server-ip","permalink":"/whatap-docs/en/kubernetes/k8s-collection-server-ip","draft":false,"unlisted":false,"editUrl":"undefined/docs/kubernetes/k8s-collection-server-ip.mdx","tags":[],"version":"current","frontMatter":{"id":"k8s-collection-server-ip","title":"Changing the Kubernetes collection server\'s IP","description":"The following explains how to change the IP of the Kubernetes product\'s collection server.","keywords":["Collection server IP"],"isTranslationMissing":false}}'),s=t(74848),o=t(84429);let r={id:"k8s-collection-server-ip",title:"Changing the Kubernetes collection server's IP",description:"The following explains how to change the IP of the Kubernetes product's collection server.",keywords:["Collection server IP"],isTranslationMissing:!1},l,i={},c=[{value:"Based on the Yaml file",id:"based-on-the-yaml-file",level:2},{value:"Example",id:"example",level:3},{value:"Based on the Helm chart",id:"based-on-the-helm-chart",level:2}];function h(e){let n={code:"code",em:"em",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",ul:"ul",...(0,o.R)(),...e.components},{TabItem:t,Tabs:a}=n;return t||d("TabItem",!0),a||d("Tabs",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"The following provides a guide on how to change the collection server's IP for the customers who are using the Kubernetes monitoring service. To change the collection server's IP in a specific environment after configuring the Kubernetes monitoring, follow the steps below."}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsxs)(t,{value:"cs-yaml",label:"Yaml",default:!0,children:[(0,s.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,s.jsx)(n.h2,{id:"based-on-the-yaml-file",children:"Based on the Yaml file"}),(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Change the ",(0,s.jsx)(n.code,{children:"whatap_host"})," value in the following location."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.em,{children:"yaml"})," file, change the ",(0,s.jsx)(n.code,{children:"WHATAP_HOST"})," value among the ",(0,s.jsx)(n.code,{children:"env"})," items under the ",(0,s.jsx)(n.code,{children:"whatap-master-agent"})," container to ",(0,s.jsx)(n.code,{children:"61.109.237.237/61.109.238.166"}),"\n."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.em,{children:"yaml"})," file, change the ",(0,s.jsx)(n.code,{children:"WHATAP_HOST"})," value among the ",(0,s.jsx)(n.code,{children:"env"})," items under the ",(0,s.jsx)(n.code,{children:"whatap-node-agent"})," container to ",(0,s.jsx)(n.code,{children:"61.109.237.237/61.109.238.166"}),"\n."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Apply the modified ",(0,s.jsx)(n.em,{children:"yaml"})," file to the Kubernetes cluster."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"yaml file name changed by kubectl apply -f.yaml\n"})}),"\n"]}),"\n"]})]}),(0,s.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,s.jsx)(n.h3,{id:"example",children:"Example"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:"title='Yaml' showLineNumbers{22-23,121-122}",children:'apiVersion: "apps/v1"\nkind: "Deployment"\nmetadata:\n  name: "whatap-master-agent"\n  namespace: "whatap-monitoring"\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: "whatap-master-agent"\n  template:\n    metadata:\n      labels:\n        name: "whatap-master-agent"\n    spec:\n      containers:\n      - command:\n        - "/bin/entrypoint.sh"\n        env:\n        - name: "WHATAP_LICENSE"\n          value: "x22gg93735j9v-z63jpk29lgtn68-x52sdl202an6h"\n        - name: "WHATAP_HOST"\n          value: "61.109.237.237/61.109.238.166"\n        - name: "WHATAP_PORT"\n          value: "6600"\n        - name: "WHATP_MEM_LIMIT"\n          valueFrom:\n            resourceFieldRef:\n              containerName: "whatap-master-agent"\n              resource: "limits.memory"\n        image: "whatap/kube_mon"\n        name: "whatap-master-agent"\n        ports:\n        - containerPort: 6600\n        resources:\n          limits:\n            cpu: "200m"\n            memory: "350Mi"\n          requests:\n            cpu: "100m"\n            memory: "300Mi"\n        volumeMounts:\n        - mountPath: "/bin/entrypoint.sh"\n          name: "start-script-volume"\n          readOnly: true\n          subPath: "entrypoint.sh"\n        - mountPath: "/whatap_conf"\n          name: "whatap-config-volume"\n      serviceAccount: "whatap"\n      volumes:\n      - configMap:\n          defaultMode: 448\n          name: "master-start-script"\n        name: "start-script-volume"\n      - emptyDir: {}\n        name: "whatap-config-volume"\n---\napiVersion: "apps/v1"\nkind: "DaemonSet"\nmetadata:\n  labels:\n    name: "whatap-node-agent"\n  name: "whatap-node-agent"\n  namespace: "whatap-monitoring"\nspec:\n  selector:\n    matchLabels:\n      name: "whatap-node-agent"\n  template:\n    metadata:\n      labels:\n        name: "whatap-node-agent"\n    spec:\n      containers:\n      - command:\n        - "/data/agent/node/cadvisor_helper"\n        - "-port"\n        - "6801"\n        env:\n        - name: "NODE_NAME"\n          valueFrom:\n            fieldRef:\n              fieldPath: "spec.nodeName"\n        image: "whatap/kube_mon"\n        name: "whatap-node-helper"\n        ports:\n        - containerPort: 6801\n          name: "helperport"\n        resources:\n          limits:\n            cpu: "200m"\n            memory: "350Mi"\n          requests:\n            cpu: "100m"\n            memory: "100Mi"\n        volumeMounts:\n        - mountPath: "/rootfs"\n          name: "rootfs"\n          readOnly: true\n        - mountPath: "/sys"\n          name: "hostsys"\n          readOnly: true\n        - mountPath: "/dev/disk"\n          name: "hostdiskdevice"\n          readOnly: true\n        - mountPath: "/var/run/docker.sock"\n          name: "dockerdomainsocket"\n      - command:\n        - "/bin/entrypoint.sh"\n        env:\n        - name: "NODE_IP"\n          valueFrom:\n            fieldRef:\n              fieldPath: "status.hostIP"\n        - name: "NODE_NAME"\n          valueFrom:\n            fieldRef:\n              fieldPath: "spec.nodeName"\n        - name: "WHATAP_LICENSE"\n          value: "x22gg93735j9v-z63jpk29lgtn68-x52sdl202an6h"\n        - name: "WHATAP_HOST"\n          value: "61.109.237.237/61.109.238.166"\n        - name: "WHATAP_PORT"\n          value: "6600"\n        - name: "HOST_PREFIX"\n          value: "/rootfs"\n        - name: "WHATP_MEM_LIMIT"\n          valueFrom:\n            resourceFieldRef:\n              containerName: "whatap-node-agent"\n              resource: "limits.memory"\n        image: "whatap/kube_mon"\n        name: "whatap-node-agent"\n        ports:\n        - containerPort: 6600\n          name: "nodeport"\n        resources:\n          limits:\n            cpu: "200m"\n            memory: "350Mi"\n          requests:\n            cpu: "100m"\n            memory: "300Mi"\n        volumeMounts:\n        - mountPath: "/rootfs"\n          name: "rootfs"\n          readOnly: true\n        - mountPath: "/bin/entrypoint.sh"\n          name: "start-script-volume"\n          readOnly: true\n          subPath: "entrypoint.sh"\n        - mountPath: "/whatap_conf"\n          name: "whatap-config-volume"\n      initContainers:\n      - command:\n        - "/data/agent/tools/whatap_debugger"\n        - "run"\n        image: "whatap/kube_mon"\n        name: "whatap-node-debug"\n        volumeMounts:\n        - mountPath: "/rootfs"\n          name: "rootfs"\n          readOnly: true\n      serviceAccount: "whatap"\n      tolerations:\n      - effect: "NoSchedule"\n        key: "node-role.kubernetes.io/master"\n      - effect: "NoSchedule"\n        key: "node-role.kubernetes.io/control-plane"\n      volumes:\n      - hostPath:\n          path: "/"\n        name: "rootfs"\n      - hostPath:\n          path: "/sys"\n        name: "hostsys"\n      - hostPath:\n          path: "/dev/disk"\n        name: "hostdiskdevice"\n      - configMap:\n          defaultMode: 448\n          name: "node-start-script"\n        name: "start-script-volume"\n      - emptyDir: {}\n        name: "whatap-config-volume"\n      - hostPath:\n          path: "/var/run/docker.sock"\n        name: "dockerdomainsocket"\n      - hostPath:\n          path: "/var/lib/docker"\n        name: "hostdocker"\n'})})]})]}),(0,s.jsx)(t,{value:"cs-helm",label:"Helm Chart",default:!0,children:(0,s.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,s.jsx)(n.h2,{id:"based-on-the-helm-chart",children:"Based on the Helm chart"}),(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If the Kubernetes agent is released via the Helm chart, modify the following items in ",(0,s.jsx)(n.em,{children:"values.yaml"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:"title='Helm' showLineNumbers{3}",children:'whatap:\n  license: # <license-key>\n  host: "61.109.237.237/61.109.238.166" # <whatap-server-host>\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Apply the modified Helm chart."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"helm upgrade whatap-kube-agent whatap/kube -f values.yaml\n"})}),"\n"]}),"\n"]})]})})]})]})}function m(e={}){let{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}function d(e,n){throw Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},84429:function(e,n,t){t.d(n,{R:()=>r,x:()=>l});var a=t(96540);let s={},o=a.createContext(s);function r(e){let n=a.useContext(o);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(o.Provider,{value:n},e.children)}}}]);