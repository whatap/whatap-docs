"use strict";(self.webpackChunkwhatap_docs=self.webpackChunkwhatap_docs||[]).push([["67328"],{25641:function(e,n,t){t.r(n),t.d(n,{metadata:()=>a,default:()=>h,frontMatter:()=>r,contentTitle:()=>s,toc:()=>c,assets:()=>l});var a=JSON.parse('{"id":"kubernetes/foreign-project","title":"External project integration and configuration","description":"The following provides a guide to external project integration.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/kubernetes/foreign-project.mdx","sourceDirName":"kubernetes","slug":"/kubernetes/foreign-project","permalink":"/whatap-docs/en/kubernetes/foreign-project","draft":false,"unlisted":false,"editUrl":"undefined/docs/kubernetes/foreign-project.mdx","tags":[],"version":"current","frontMatter":{"id":"foreign-project","title":"External project integration and configuration","description":"The following provides a guide to external project integration.","keywords":["Kubernetes","Kubernetes Monitoring","Dashboard","External project"],"toc_max_heading_level":2,"isTranslationMissing":false},"sidebar":"kubeSidebar","previous":{"title":"Container map metrics and status","permalink":"/whatap-docs/en/kubernetes/container-status"},"next":{"title":"Container Map Detailed Analysis","permalink":"/whatap-docs/en/kubernetes/container-map-detail-mode"}}'),o=t(74848),i=t(84429);let r={id:"foreign-project",title:"External project integration and configuration",description:"The following provides a guide to external project integration.",keywords:["Kubernetes","Kubernetes Monitoring","Dashboard","External project"],toc_max_heading_level:2,isTranslationMissing:!1},s,l={},c=[{value:"External project integration",id:"external-project-integration",level:2},{value:"External project configuration",id:"external-project-configuration",level:2},{value:"Agent CONFIG.",id:"agent-config",level:3},{value:"Example",id:"example",level:4},{value:"Configuring the Pod to be linked",id:"configuring-the-pod-to-be-linked",level:3},{value:"Example",id:"example-1",level:4},{value:"Checking the external project to link to",id:"checking-the-external-project-to-link-to",level:2}];function d(e){let n={admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",section:"section",strong:"strong",ul:"ul",...(0,i.R)(),...e.components},{Cmdname:t,Column:a,Columns:r,ImgLang:s}=n;return t||m("Cmdname",!0),a||m("Column",!0),r||m("Columns",!0),s||m("ImgLang",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["Home > Select Project > ",(0,o.jsx)(t,{sid:"dashboard",className:"uitext"})," > ",(0,o.jsx)(t,{sid:"side_containerMap",className:"uitext"})]}),"\n",(0,o.jsxs)(n.admonition,{type:"note",children:[(0,o.jsx)(n.mdxAdmonitionTitle,{}),(0,o.jsx)(n.p,{children:"The WhaTap Kubernetes agent 1.7.16 or later is required."})]}),"\n",(0,o.jsxs)(n.p,{children:["WhaTap provides various monitoring services on a project basis. The ",(0,o.jsx)(n.strong,{children:"External project integration"})," feature allows you to integrate external projects related to Pods in the Kubernetes projects."]}),"\n",(0,o.jsx)(n.p,{children:"To link to an external project, you need to configure the Kubernetes agent and a Pod to link to. Build an integrated monitoring scheme by linking the Kubernetes projects with external projects."}),"\n",(0,o.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,o.jsx)(n.h2,{id:"external-project-integration",children:"External project integration"}),(0,o.jsx)(n.p,{children:"When the external project integration feature is enabled, the project logo appears on the linked containers and Pods as follows. This makes it easy to visually see which external projects are linked. You can also navigate to the project via the button within the Summary View panel by clicking the block."}),(0,o.jsx)("p",{align:"center",children:(0,o.jsx)(s,{img:"k8s-foreign-project-container-map.png",desc:"Container map from external project examples"})})]}),"\n",(0,o.jsx)(n.section,{className:"remark-sectionize-h2",children:(0,o.jsx)(n.h2,{id:"external-project-configuration",children:"External project configuration"})}),"\n",(0,o.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,o.jsx)(n.h3,{id:"agent-config",children:"Agent CONFIG."}),(0,o.jsxs)(n.p,{children:["You must change the whatap-node-agent DaemonSet setting of the whatap-monitoring namespace in the ",(0,o.jsx)(n.em,{children:"YAML"})," file for installation of the Kubernetes agent. In particular, you must add the following environment variables into the env section of the whatap-node-agent container."]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'- name: "collect_foreign_project"\n  value: "true"\n'})})]}),"\n",(0,o.jsxs)(n.section,{className:"remark-sectionize-h4",children:[(0,o.jsx)(n.h4,{id:"example",children:"Example"}),(0,o.jsxs)(n.p,{children:["Below is an example of the ",(0,o.jsx)(n.em,{children:"YAML"})," file with environment variables added. Because there may be significant differences from the ",(0,o.jsx)(n.em,{children:"YAML"})," file in the operation environment, see the example and then modify only the required parts before use. The highlighted lines are environment variables added."]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",metastring:"{75,76}",children:'apiVersion: "apps/v1"\nkind: "DaemonSet"\nmetadata:\n  labels:\n    name: "whatap-node-agent"\n  name: "whatap-node-agent"\n  namespace: "whatap-monitoring"\nspec:\n  selector:\n    matchLabels:\n      name: "whatap-node-agent"\n  template:\n    metadata:\n      labels:\n        name: "whatap-node-agent"\n    spec:\n      containers:\n      - command:\n        - "/data/agent/node/cadvisor_helper"\n        - "-port"\n        - "6801"\n        env:\n        - name: "NODE_NAME"\n          valueFrom:\n            fieldRef:\n              fieldPath: "spec.nodeName"\n        image: "whatap/kube_mon_dev:foreign-2"\n        name: "whatap-node-helper"\n        ports:\n        - containerPort: 6801\n          name: "helperport"\n        resources:\n          limits:\n            cpu: "200m"\n            memory: "350Mi"\n          requests:\n            cpu: "100m"\n            memory: "100Mi"\n        volumeMounts:\n        - mountPath: "/rootfs"\n          name: "rootfs"\n          readOnly: true\n        - mountPath: "/sys"\n          name: "hostsys"\n          readOnly: true\n        - mountPath: "/dev/disk"\n          name: "hostdiskdevice"\n          readOnly: true\n        - mountPath: "/run/containerd/containerd.sock"\n          name: "containerddomainsocket"\n      - command:\n        - "/bin/entrypoint.sh"\n        env:\n        - name: "NODE_IP"\n          valueFrom:\n            fieldRef:\n              fieldPath: "status.hostIP"\n        - name: "NODE_NAME"\n          valueFrom:\n            fieldRef:\n              fieldPath: "spec.nodeName"\n        - name: "WHATAP_LICENSE"\n          value: "x6050rs80f4eg-x1g0egm9rjb3mg-z7p9533a2ea87e"\n        - name: "WHATAP_HOST"\n          value: "13.124.11.223/13.209.172.35"\n        - name: "WHATAP_PORT"\n          value: "6600"\n        - name: "HOST_PREFIX"\n          value: "/rootfs"\n        - name: "WHATP_MEM_LIMIT"\n          valueFrom:\n            resourceFieldRef:\n              containerName: "whatap-node-agent"\n              resource: "limits.memory"\n        - name: "collect_foreign_project"\n          value: "true"\n        image: "whatap/kube_mon_dev:foreign-2"\n        name: "whatap-node-agent"\n        ports:\n        - containerPort: 6600\n          name: "nodeport"\n        resources:\n          limits:\n            cpu: "200m"\n            memory: "350Mi"\n          requests:\n            cpu: "100m"\n            memory: "300Mi"\n        volumeMounts:\n        - mountPath: "/rootfs"\n          name: "rootfs"\n          readOnly: true\n        - mountPath: "/bin/entrypoint.sh"\n          name: "start-script-volume"\n          readOnly: true\n          subPath: "entrypoint.sh"\n        - mountPath: "/whatap_conf"\n          name: "whatap-config-volume"\n      initContainers:\n      - command:\n        - "/data/agent/tools/whatap_debugger"\n        - "run"\n        image: "whatap/kube_mon_dev:foreign-2"\n        name: "whatap-node-debug"\n        volumeMounts:\n        - mountPath: "/rootfs"\n          name: "rootfs"\n          readOnly: true\n      serviceAccount: "whatap"\n      tolerations:\n      - effect: "NoSchedule"\n        key: "node-role.kubernetes.io/master"\n      - effect: "NoSchedule"\n        key: "node-role.kubernetes.io/control-plane"\n      volumes:\n      - hostPath:\n          path: "/"\n        name: "rootfs"\n      - hostPath:\n          path: "/sys"\n        name: "hostsys"\n      - hostPath:\n          path: "/dev/disk"\n        name: "hostdiskdevice"\n      - configMap:\n          defaultMode: 448\n          name: "node-start-script"\n        name: "start-script-volume"\n      - emptyDir: {}\n        name: "whatap-config-volume"\n      - hostPath:\n          path: "/run/containerd/containerd.sock"\n        name: "containerddomainsocket"\n'})})]}),"\n",(0,o.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,o.jsx)(n.h3,{id:"configuring-the-pod-to-be-linked",children:"Configuring the Pod to be linked"}),(0,o.jsx)(n.p,{children:"Modify the settings of the Pod to link to. For example, in order to integrate the Redis Pod, add the following environment variables to the env section of the Redis container."}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'- name: "license"\n  value: "here_is_whatap_license"\n- name: "whatap_platform"\n  value: "redis"\n'})}),(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"here_is_whatap_license "}),": Enter the license information of the external project."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"whatap_platform"}),": Enter the platform of the external project to link to."]}),"\n"]}),"\n"]}),(0,o.jsxs)(n.admonition,{type:"note",children:[(0,o.jsx)(n.p,{children:"The platforms that currently support integration with external projects are as follows: When entering on the platform, you can enter it without case sensitive."}),(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Redis"}),", ",(0,o.jsx)(n.strong,{children:"Java"}),", ",(0,o.jsx)(n.strong,{children:"Node.js"}),", ",(0,o.jsx)(n.strong,{children:"Python"}),", ",(0,o.jsx)(n.strong,{children:"PHP"})]}),"\n"]})]})]}),"\n",(0,o.jsxs)(n.section,{className:"remark-sectionize-h4",children:[(0,o.jsx)(n.h4,{id:"example-1",children:"Example"}),(0,o.jsxs)(n.p,{children:["Below is an example of the ",(0,o.jsx)(n.em,{children:"YAML"})," file in which environment variables are added to the Redis Pod configuration. The highlighted lines are environment variables added."]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",metastring:"{31-34}",children:'apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-cluster\n  namespace: backend\nspec:\n  serviceName: redis-cluster-svc\n  replicas: 6\n  selector:\n    matchLabels:\n      app: redis-cluster\n  template:\n    metadata:\n      labels:\n        app: redis-cluster\n    spec:\n      containers:\n      - name: redis\n        image: redis:5.0.1-alpine\n        ports:\n        - containerPort: 6379\n          name: client\n        - containerPort: 16379\n          name: gossip\n        command: ["/conf/update-node.sh", "redis-server", "/conf/redis.conf"]\n        env:\n        - name: POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: license\n          value: x6050s081i709-z2lhh7gpi3bdr4-x7jovr61kumi5k\n        - name: whatap_platform\n          value: redis\n        volumeMounts:\n        - name: conf\n          mountPath: /conf\n          readOnly: false\n        - name: data\n          mountPath: /data\n          readOnly: false\n'})})]}),"\n",(0,o.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,o.jsx)(n.h2,{id:"checking-the-external-project-to-link-to",children:"Checking the external project to link to"}),(0,o.jsxs)(n.p,{children:[(0,o.jsx)(t,{sid:"side_analysis",className:"uitext"})," > ",(0,o.jsx)(t,{sid:"side_metricsSearch",className:"uitext"})]}),(0,o.jsxs)(r,{children:[(0,o.jsx)(a,{className:"text--left width--50",children:(0,o.jsx)(s,{img:"k8s-foreign-project-check.png",desc:"Check external project application"})}),(0,o.jsxs)(a,{className:"text--left",children:[(0,o.jsxs)(n.p,{children:["After configuring an external project integration, go to the ",(0,o.jsx)(t,{sid:"side_metricsSearch",className:"uitext"})," menu. Click ",(0,o.jsx)(n.em,{children:(0,o.jsx)(n.strong,{children:"Select Category"})})," as shown in the example image."]}),(0,o.jsx)(n.p,{children:"If the following category appears, it indicates that the integration has been made successfully."}),(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"container_foreign_project_mapping"})}),"\n"]})]})]})]})]})}function h(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}function m(e,n){throw Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},84429:function(e,n,t){t.d(n,{R:()=>r,x:()=>s});var a=t(96540);let o={},i=a.createContext(o);function r(e){let n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);