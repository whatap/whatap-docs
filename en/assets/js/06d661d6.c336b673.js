"use strict";(self.webpackChunkwhatap_docs=self.webpackChunkwhatap_docs||[]).push([["62499"],{31651:function(e,n,r){r.r(n),r.d(n,{metadata:()=>t,default:()=>d,frontMatter:()=>a,contentTitle:()=>o,toc:()=>l,assets:()=>c});var t=JSON.parse('{"id":"software-proxy","title":"Software proxy","description":"You can block direct access to the external network from the monitored servers and allow external access through a single channel.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/software-proxy.mdx","sourceDirName":".","slug":"/software-proxy","permalink":"/whatap-docs/en/software-proxy","draft":false,"unlisted":false,"editUrl":"undefined/docs/software-proxy.mdx","tags":[],"version":"current","frontMatter":{"id":"software-proxy","title":"Software proxy","description":"You can block direct access to the external network from the monitored servers and allow external access through a single channel.","keywords":["Java","Application Monitoring","Software proxy"],"isTranslationMissing":false},"sidebar":"referSidebar","previous":{"title":"OpenMetrics Cardinality","permalink":"/whatap-docs/en/openmetrics_cardinality"},"next":{"title":"License","permalink":"/whatap-docs/en/license/licenses"}}'),s=r(74848),i=r(84429);let a={id:"software-proxy",title:"Software proxy",description:"You can block direct access to the external network from the monitored servers and allow external access through a single channel.",keywords:["Java","Application Monitoring","Software proxy"],isTranslationMissing:!1},o,c={},l=[{value:"Software proxy",id:"software-proxy",level:2},{value:"Agent Installation",id:"agent-installation",level:3},{value:"Agent CONFIG.",id:"agent-config",level:3},{value:"Public Subnet",id:"public-subnet",level:4},{value:"Private Subnet",id:"private-subnet",level:4},{value:"Running the agent",id:"running-the-agent",level:3},{value:"Ending the software proxy",id:"ending-the-software-proxy",level:3},{value:"HAProxy",id:"haproxy",level:2},{value:"Private Subnet",id:"private-subnet-1",level:3},{value:"Public Subnet",id:"public-subnet-1",level:3},{value:"Nginx reverse proxy",id:"nginx-reverse-proxy",level:2},{value:"Private Subnet",id:"private-subnet-2",level:3},{value:"Public Subnet",id:"public-subnet-2",level:3},{value:"Checking the agent installation",id:"checking-the-agent-installation",level:2}];function h(e){let n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",p:"p",pre:"pre",section:"section",strong:"strong",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"To block direct access to the external network from the monitored servers and allow external access through a single channel, you can configure a TCP/UDP proxy server to send data to the WhaTap server."}),"\n",(0,s.jsxs)(n.p,{children:["If it is difficult for you to configure a proxy server, you can use the software-based ",(0,s.jsx)(n.strong,{children:"WhatTap software proxy"})," provided by WhaTap.\nThis allows you to control multiple servers indirectly via ",(0,s.jsx)(n.strong,{children:"WhatTap software proxy"})," to the external network. You can also use the general-purpose proxy such as ",(0,s.jsx)(n.a,{href:"https://www.haproxy.org",children:"HAProxy"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:r(33316).A+"",width:"1408",height:"604"})}),"\n",(0,s.jsx)(n.section,{className:"remark-sectionize-h2",children:(0,s.jsx)(n.h2,{id:"software-proxy",children:"Software proxy"})}),"\n",(0,s.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,s.jsx)(n.h3,{id:"agent-installation",children:"Agent Installation"}),(0,s.jsxs)(n.p,{children:["You can download the proxy installation file from ",(0,s.jsx)(n.a,{href:"https://repo.whatap.io/agent_proxy/whatap_agent_proxy.zip",children:"https://repo.whatap.io/agent_proxy/whatap_agent_proxy.zip"}),".\nAfter extracting the file, store it on a server that can communicate with the WhaTap collection server."]}),(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsx)(n.p,{children:"To set the port number to pass through a proxy when installing the server agent in a Windows environment, execute the following command."}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:"whatap_infra.exe /SILENT /SERIAL={Access key} /PROXYIP={Proxy server IP} /PROXYPORT=6600\n"})})]})]}),"\n",(0,s.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,s.jsx)(n.h3,{id:"agent-config",children:"Agent CONFIG."}),(0,s.jsxs)(n.p,{children:["In this document, the bandwidth of the server where the agent has been located is called ",(0,s.jsx)(n.strong,{children:"Private Subnet"}),", and the bandwidth of the server where the software proxy has been located is called ",(0,s.jsx)(n.strong,{children:"Public Subnet"}),"."]})]}),"\n",(0,s.jsxs)(n.section,{className:"remark-sectionize-h4",children:[(0,s.jsx)(n.h4,{id:"public-subnet",children:"Public Subnet"}),(0,s.jsxs)(n.p,{children:["After copying the ",(0,s.jsxs)(n.em,{children:["whatap.agent.proxy-",(0,s.jsx)(n.code,{children:"X.Y.Z"}),".jar"]})," file to an appropriate path, create a ",(0,s.jsx)(n.em,{children:"proxy.conf"})," file to set the WhaTap collection server IP and port. The path where the ",(0,s.jsxs)(n.em,{children:["whatap.agent.proxy-",(0,s.jsx)(n.code,{children:"X.Y.Z"}),".jar"]})," file has been located is ",(0,s.jsx)(n.code,{children:"$PROXY_HOME"}),"."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",metastring:"title='$PROXY_HOME/proxy.conf'",children:"whatap.server.host=52.78.209.94/52.78.224.235 ## Address of the WhaTap application monitoring collection server\nlisten_port=6600 ## Port to which the proxy listens\n"})})]}),"\n",(0,s.jsxs)(n.section,{className:"remark-sectionize-h4",children:[(0,s.jsx)(n.h4,{id:"private-subnet",children:"Private Subnet"}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"$WHATAP_HOME"})," is the path where the agent has been installed. In ",(0,s.jsx)(n.code,{children:"$WHATAP_HOME"}),(0,s.jsx)(n.em,{children:"/whatap.conf"}),", change ",(0,s.jsx)(n.code,{children:"whatap.server.host"})," to the IP of the ",(0,s.jsx)(n.strong,{children:"Public Subnet"})," server."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",metastring:"title='$WHATAP_HOME/whatap.conf'",children:"whatap.server.host={Public Subnet proxy server IP}\n"})}),(0,s.jsxs)(n.p,{children:["For stability, you can configure multiple proxies on ",(0,s.jsx)(n.strong,{children:"Public Subnets"}),". Enter forward slash (/) as the delimiter."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",metastring:"title='$WHATAP_HOME/whatap.conf'",children:"whatap.server.host={Public Subnet proxy server IP #1}/{Public Subnet proxy server IP #2} \n"})})]}),"\n",(0,s.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,s.jsx)(n.h3,{id:"running-the-agent",children:"Running the agent"}),(0,s.jsxs)(n.p,{children:["Run the software proxy through the ",(0,s.jsx)(n.code,{children:"java"})," command or by creating a ",(0,s.jsx)(n.em,{children:"proxy.sh"})," (",(0,s.jsx)(n.em,{children:"proxy.bat"}),") file."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",metastring:"title='java command'",children:"java -jar whatap.agent.proxy-X.Y.Z.jar &\n"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",metastring:"title='proxy.sh (Windows: proxy.bat)'",children:"#!/usr/bin/env bash \nEXE_JAR=`ls *.proxy* | sort -V | tail -1` \n${JAVA_HOME}/bin/java ${JAVA_OPTS} -jar $EXE_JAR\n"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sh proxy.sh &\n"})}),(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["When creating and running the ",(0,s.jsx)(n.em,{children:"proxy.sh"})," (",(0,s.jsx)(n.em,{children:"proxy.bat"}),") file, grant execution role with the ",(0,s.jsx)(n.code,{children:"$ chmod +x proxy.sh"})," command."]})})]}),"\n",(0,s.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,s.jsx)(n.h3,{id:"ending-the-software-proxy",children:"Ending the software proxy"}),(0,s.jsxs)(n.p,{children:["If a software proxy is running, it creates ",(0,s.jsxs)(n.em,{children:[(0,s.jsx)(n.code,{children:"$PROXY_HOME"}),"/",(0,s.jsx)(n.code,{children:"{PID}"}),".proxy.run"]})," files. If you delete this file, the software proxy is ended."]})]}),"\n",(0,s.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,s.jsx)(n.h2,{id:"haproxy",children:"HAProxy"}),(0,s.jsxs)(n.p,{children:["It explains how to build a proxy server by using ",(0,s.jsx)(n.strong,{children:"HAProxy"}),"."]})]}),"\n",(0,s.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,s.jsx)(n.h3,{id:"private-subnet-1",children:"Private Subnet"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",metastring:"title='$WHATAP_HOME/whatap.conf'",children:"license=<project access key>\nwhatap.server.host=192.168.203.60 ## Proxy server IP\n"})})]}),"\n",(0,s.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,s.jsx)(n.h3,{id:"public-subnet-1",children:"Public Subnet"}),(0,s.jsxs)(n.p,{children:["See the following to configure the ",(0,s.jsx)(n.em,{children:"haproxy.cfg"})," file."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",metastring:"title='/etc/haproxy/haproxy.cfg'",children:"frontend proxy_in\n  mode              tcp\n  bind              *:6600\n  default_backend   proxy_out\n  log               global\n  option            httplog\n\nbackend proxy_out\n  mode      tcp\n  server    server1 13.124.11.223:6600 maxconn 32 \n  server    server2 13.209.172.35:6600 maxconn 32\n"})}),(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"13.124.11.223:6600 and 13.209.172.35:6600 are the WhaTap application monitoring collection server's IP address and port."})})]}),"\n",(0,s.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,s.jsx)(n.h2,{id:"nginx-reverse-proxy",children:"Nginx reverse proxy"}),(0,s.jsxs)(n.p,{children:["It explains how to build a proxy server by using ",(0,s.jsx)(n.strong,{children:"Nginx reverse proxy"}),"."]})]}),"\n",(0,s.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,s.jsx)(n.h3,{id:"private-subnet-2",children:"Private Subnet"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",metastring:"title='$WHATAP_HOME/whatap.conf'",children:"license=<project access key>\nwhatap.server.host=192.168.203.60 ## Proxy server IP\n"})})]}),"\n",(0,s.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,s.jsx)(n.h3,{id:"public-subnet-2",children:"Public Subnet"}),(0,s.jsxs)(n.p,{children:["See the following to configure the ",(0,s.jsx)(n.em,{children:"nginx.conf"})," file."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-apacheconf",metastring:"title='/etc/nginx/nginx.conf'",children:"stream {\n  upstream tcp_proxy {\n    server 13.124.11.223:6600;\n    server 13.209.172.35:6600;\n  }\n  server {\n    listen 6600;\n    proxy_pass tcp_proxy;\n  }\n}\n"})}),(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"13.124.11.223:6600 and 13.209.172.35:6600 are the WhaTap application monitoring collection server's IP address and port."})})]}),"\n",(0,s.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,s.jsx)(n.h2,{id:"checking-the-agent-installation",children:"Checking the agent installation"}),(0,s.jsxs)(n.p,{children:["If there is a connection between the server where the agent has been installed and the collection server, you can check it at ",(0,s.jsx)(n.a,{href:"https://service.whatap.io",children:"Whatap Monitoring Service"}),"."]})]})]})}function d(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},33316:function(e,n,r){r.d(n,{A:()=>t});let t=r.p+"assets/images/software-proxy-1842a16e6c8e9c6c67edf1515cc82c07.png"},84429:function(e,n,r){r.d(n,{R:()=>a,x:()=>o});var t=r(96540);let s={},i=t.createContext(s);function a(e){let n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);