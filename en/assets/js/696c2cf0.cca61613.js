"use strict";(self.webpackChunkwhatap_docs=self.webpackChunkwhatap_docs||[]).push([["57919"],{53566:function(e,n,t){t.r(n),t.d(n,{metadata:()=>i,default:()=>h,frontMatter:()=>r,contentTitle:()=>l,toc:()=>c,assets:()=>d});var i=JSON.parse('{"id":"release-notes/java/java-2_2_0","title":"Java Agent v2.2.0","description":"Release date: 2022-11-01","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/release-notes/java/java-2.2.0.mdx","sourceDirName":"release-notes/java","slug":"/release-notes/java/java-2_2_0","permalink":"/whatap-docs/en/release-notes/java/java-2_2_0","draft":false,"unlisted":false,"editUrl":"undefined/docs/release-notes/java/java-2.2.0.mdx","tags":[],"version":"current","frontMatter":{"id":"java-2_2_0","title":"Java Agent v2.2.0","toc_max_heading_level":2,"displayed_sidebar":"releaseSidebar","isTranslationMissing":false},"sidebar":"releaseSidebar"}'),a=t(74848),s=t(84429);t(31377),t(4344);let r={id:"java-2_2_0",title:"Java Agent v2.2.0",toc_max_heading_level:2,displayed_sidebar:"releaseSidebar",isTranslationMissing:!1},l,d={},c=[{value:"New features",id:"new-features",level:2},{value:"Change (update)",id:"change-update",level:2},{value:"Fixed (bug fixing)",id:"fixed-bug-fixing",level:2}];function o(e){let n={code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",section:"section",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"Release date: 2022-11-01"}),"\n",(0,a.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,a.jsx)(n.h2,{id:"new-features",children:"New features"}),(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Added the function to generate the logsink data in the virtual application."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Added the function to connect the stdout log of the logsink with txid information."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Added the data collection function for 2 seconds."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"fast_perf_enabled=false\nfast_perf_interval=2000\nfast_perf_gc_enabled=true\nfast_perf_os_enabled=true\ndebug_fast_perf_enabled=false\n"})}),"\n",(0,a.jsx)(n.p,{children:"Collection data"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Elapsed time"}),"\n",(0,a.jsx)(n.li,{children:"Active Transaction"}),"\n",(0,a.jsx)(n.li,{children:"gc information: number of gc cases, gc elapsed time, number of old generation gc cases, old generation gc elapsed time"}),"\n",(0,a.jsx)(n.li,{children:"OS info"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Added the function to send notifications based on the number of active transactions."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"# Whether the active transaction alerts have been set\ntoo_many_actx_alert_enabled=false\n\n# Ignorance time for active transaction alerts (ms)\ntoo_many_actx_alert_silent_time=30000\n\n# Number of active transaction alerts\ntoo_many_actx_alert_count=50\n\n# Number of displayed active transaction alert messages\ntoo_many_actx_alert_msg_url_count=5\n\n# Time for active transaction alerts\ntoo_many_actx_alert_over_time=30000\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["The number of active transactions is determined by ",(0,a.jsx)(n.code,{children:"too_many_actx_alert_count = (too_many_actx_alert_over_time / 5000)"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["When the number of active transactions equals to or exceeds the threshold, notifications are sent by adding URL as many as ",(0,a.jsx)(n.code,{children:"too_many_actx_alert_msg_url_count"})," to the alert message."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Profile Debug option: Added the function to check the stack in the profile and agent log when a debug target pattern is registered."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"hook_method_debug_enabled=true\nhook_method_debug_patterns=\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Adding the plug-in using class"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Added the ",(0,a.jsx)(n.code,{children:"HashTable"})," class to be used in the ",(0,a.jsxs)(n.em,{children:[(0,a.jsx)(n.code,{children:"{AGENT_HOME}"}),"/plugin/",(0,a.jsx)(n.code,{children:"{...}"}),".x"]})," file."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["If ",(0,a.jsx)(n.code,{children:"whatap.agent.api.Ref.h"})," is used, ",(0,a.jsx)(n.code,{children:"HashTable"})," can be used."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",metastring:"title='Example'",children:"Class hashTable = (Class) whatap.agent.api.Ref.h;\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Adding the dedicated classes for TTA BMT: Can be used to demonstrate the Java agent."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",metastring:"title='Java Class'",children:"# map\nbmt.m.MyMap\n\n# datasource\nbmt.ds.MyDataSource\nbmt.ds.MyConnection\n\n# jdbc\nbmt.jdbc.Config\nbmt.jdbc.FakeBlob\nbmt.jdbc.FakeClob\nbmt.jdbc.FakeConnection\nbmt.jdbc.FakeDatabaseMetaData\nbmt.jdbc.FakeDriver\nbmt.jdbc.FakeCallableStatement\nbmt.jdbc.FakePreparedStatement\nbmt.jdbc.FakeResultSet\nbmt.jdbc.FakeStatement\nbmt.jdbc.FakeSocket\nbmt.jdbc.Lock\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",metastring:"title='Tracing'",children:'// Connection Pool tracing\n// ConnectionPoolASM\ntarget.put("bmt/ds/MyDataSource", MyDataSource.className);\n\n// Connection Pool tracing\n// DBConCountCollectorThread\nadd(new MyDataSource());\n\n// JDBC Connection tracing\n// JDBCConnectionOpenASM\nAsmUtil.add(reserved, "bmt/ds/MyDataSource", "getConnection()Ljava/sql/Connection;");\n\n// JDBC Statement tracing\n// JDBCStatementASM\ntarget.add("bmt/jdbc/FakeStatement");\n\n// JDBC PreparedStatement tracing\n// JDBCPreparedStatementASM \ntarget.add("bmt/jdbc/FakePreparedStatement");\n\n// JDBC ResultSet tracing\n// JDBCResultSetASM\ntarget.add("bmt/jdbc/FakeResultSet");\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Error step"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Added the function to add the error step to the profile."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Added the step to display error-related data in the profile by adding settings."}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"profile_error_step_enabled=false\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Adding the JMX setting: Added the function to additionally view the JMX data."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"perfx_tomcat_enabled=false\nperfx_jmx_value_limit=100\nperfx_jmx_tag_from_objectname_enabled=false\n"})}),"\n",(0,a.jsx)(n.p,{children:"By collecting the JMX data of tomcat, the settings for checking with test1 and test2 in metrics lookup are as follows:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"perfx_jmx_enabled=true\nperfx_jmx@test1=Catalina:type=Connector,*\nperfx_jmx@test2=java.lang:type=GarbageCollector,*\nperfx_jmx_ignore@test2=LastGcInfo\n# perfx_debug_enabled=true\n# perfx_jmx_tag_from_objectname_enabled=false\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Using the OSHI library, added the function to trace the proc_mem_rss data of the process."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"oshi_proc_mem_enabled=false\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Added the JDBC statement tracing function in ",(0,a.jsx)(n.code,{children:"org.edb.jdbc.PgCallableStatement"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Function to trace SQL parameters in the Oracle procedure"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Added the function to trace SQL parameters in Oracle procedures."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Added the function to trace SQL parameters in CallableStatement."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["In case of calling HTTP from Weblogic to ",(0,a.jsx)(n.code,{children:"HttpURLConnection"}),", added the function to trace ",(0,a.jsx)(n.code,{children:"weblogic.net.http.HttpURLConnection"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"HttpURLConnection_weblogic=true\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Added the function to collect the native memory data (proc_mem_rss) of the process by using the sigar library."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Added the function to collect TPS data collected with the 30-second average, in the 5-second average."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"service_metrics_spike_enabled=false\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Added the compressed transfer function for the profile data."}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Profile data is sent when the profile data exceeds the size of ",(0,a.jsx)(n.code,{children:"profile_zip_max_buffer_size"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Profile data is sent when data is accumulated in the queue or the value of ",(0,a.jsx)(n.code,{children:"profile_zip_max_wait_time"})," is exceeded."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["When the profile data is transmitted, the data is compressed except when the profile data in the queue is less than ",(0,a.jsx)(n.code,{children:"profile_zip_min_size"}),"."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"# Whether the profile data is compressed\n profile_zip_enabled=true\n\n # Queue size that has the profile data\n # ZipProfileThread.java determines the request queue size\n profile_zip_queue_size=1000\n\n # Waiting time for profile data transfer\n # If 1000 ms is exceeded, the profile data is sent.\n profile_zip_max_wait_time=1000\n\n # Buffer size of the profile data\n # If the profile data exceeds 1 MB, data is transferred.\n profile_zip_max_buffer_size=1024*1024\n\n # Minimum size to determine whether or not to compress the profile data\n # If the profile data is less than 100 bytes, compression is not followed.\n profile_zip_min_size=100\n\n # Whether or not to debug the profile data compression\n # Outputs the data related to profile data transmission (ZipPack status, recordCount, buffer size, profile data queue size) to the agent log\n debug_profile_zip_enabled=false\n\n # Output interval for profile data compression debug log\n # When the PROFIAL data compression debug option is turned on, the information about profile data transmission is output to the agent log at an interval of 5000 ms. \n debug_profile_zip_interval=5000\n"})}),"\n"]}),"\n"]})]}),"\n",(0,a.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,a.jsx)(n.h2,{id:"change-update",children:"Change (update)"}),(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Modified the option name from ",(0,a.jsx)(n.code,{children:"max_wait_time"})," that is the logsink data transfer cycle, to ",(0,a.jsx)(n.code,{children:"logsink_max_wait_time"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Replaced the CustomCounter function collected by the plug-in with CustomTaskLoader instead of CustomCounterTask."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"custom_task_enabled=true\ncustom_task_jarfile={full_path}\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Added the function to output logs when the server time difference between the agent and proxy is 10 seconds or more."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Measuring the elapsed time"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Modified to use the JVM time rather than the system time when measuring the elapsed times for transactions and profiles."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["When measuring the elapsed time, modified to use ",(0,a.jsx)(n.code,{children:"System.nanoTime()"})," in ",(0,a.jsx)(n.code,{children:"System.currentTimeMillis()"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Modified to display the time difference between servers seen in the agent log when there is a difference in the server time between the agent and proxy."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",metastring:"title='Agent log'",children:'# In case the time difference is 30 seconds or more \n"fatal warning time-reverse (time difference) ms"\n\n# In case the time difference is less than 30 seconds\n"warning time-reverse (time difference) ms"\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Modified the options for user counting in the form of wclient_xxx. The previous option names can be used but new option names are recommended, starting from v2.2.0."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"# Replacement\ntrace_user_method=IP\nwclient_trace_type=IP\n\n# Replacement\ntrace_user_jsession_key=JSESSIONID\nwclient_jsession_key=JSESSIONID\n\n# Replacement\ntrace_user_header_key=token\nwclient_header_key=token\n\n# Replacement\ntrace_user_cookie_limit=4000\nwclient_cookie_limit=4000\n\n# Replacement\ntrace_user_cookie_domain=\nwclient_cookie_domain=\n\n# Replacement\nrealtime_user_thinktime_max=300000\nwclient_thinktime_max=300000\n\n# Replacement\ntrace_user_using_ip=true\nwclient_using_ip=true\n\n# Replacement\nuser_header_ticket=\nwclient_header_ticket=\n\n# Replacement\nwclient_max_count=70000\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Recompiled the embedded weaving component by applying the count settings related to the number of users."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Modified to use ",(0,a.jsx)(n.code,{children:"System.nanoTime()"})," when calculating the CounterPack elapsed time."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Included the release version in the log output logo."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",metastring:"title='Logo'",children:"  _       ____  ______           \n| |     / / /_/_  __/___ _____   ___  ___ \n| | /| / / __ \\/ / / __ `/ __ \\ | _ \\|_  ) \n| |/ |/ / / / / / / /_/ / /_/ / |   / / /\n|__/|__/_/ /_/_/  \\__,_/ .___/  |_|_\\/___|\n                      /_/                    \nThe Best Observability in Java\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Modified the default value for the Java agent\u2019s statistics collection from 5000 to 10000, checking every 2 seconds when sending statistics data."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"stat_tx_max_count=10000\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Updated the version of the OSHI library that collects performance metrics from oshi-core-5.4.1 to oshi-core-6.1.6."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Changed the library folder name of ",(0,a.jsx)(n.code,{children:"{AGENT_HOME}"})," that collects performance metrics."]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Renamed the SIGAR library folder: lib -> lib3."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Renamed the OSHI library folder: lib2 -> lib4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]}),"\n",(0,a.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,a.jsx)(n.h2,{id:"fixed-bug-fixing",children:"Fixed (bug fixing)"}),(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Fixed a bug that occurred when adding headers related to multi-transaction to the read-only HttpHeaders of the Webflux weaving plug-in, an embedded Java agent plug-in."}),"\n",(0,a.jsx)(n.p,{children:"Applied to webflux-5.1, webflux-5.2, and webflux-5.3."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Fixed the bug that occurred when the elapsed time of transactions and steps was less than 0."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Fixed the bug where the elapsed time is displayed as 0, when the elapsed time of transactions and steps is less than 0."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Fixed the ",(0,a.jsx)(n.code,{children:"blocking_detect_count"})," handling bug."]}),"\n"]}),"\n"]})]})]})}function h(e={}){let{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},31377:function(e,n,t){t.d(n,{A:()=>a}),t(96540);var i=t(74848);function a({children:e,priority:n}){return n?(0,i.jsx)("code",{className:e,type:n,children:e}):(0,i.jsx)("code",{className:e,children:e})}},4344:function(e,n,t){t.d(n,{A:()=>a}),t(96540);var i=t(74848);function a({children:e}){return(0,i.jsx)("span",{className:"uitext",children:e})}},84429:function(e,n,t){t.d(n,{R:()=>r,x:()=>l});var i=t(96540);let a={},s=i.createContext(a);function r(e){let n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);