"use strict";(self.webpackChunkwhatap_docs=self.webpackChunkwhatap_docs||[]).push([["40871"],{61372:function(e,n,t){t.d(n,{Ay:()=>c,RM:()=>i});var s=t(74848),r=t(84429);let i=[];function o(e){let n={code:"code",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"The following explains how to configure the network to transmit the data collected by agents from the application servers to the server. The major configuration options are the collection server host, port, timeout value, network transfer size, and data transfer queue size, which are important to ensure the agent's efficient data management and reliable server communication."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"whatap_server_host"})," ",(0,s.jsx)("span",{class:"type",children:"ip_address"})]}),"\n",(0,s.jsxs)(n.p,{children:["Default ",(0,s.jsx)(n.code,{children:"127.0.0.1,127.0.0.1"})]}),"\n",(0,s.jsx)(n.p,{children:"Specify the server to transfer the data collected by the agent. If there are multiple IP addresses for collection server redundancy, use comma (,) as the delimiter. The proxy of the collection server must be in listening state for the set IP address."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"whatap_server_port"})," ",(0,s.jsx)("span",{class:"type",children:"tcp_port"})]}),"\n",(0,s.jsxs)(n.p,{children:["Default ",(0,s.jsx)(n.code,{children:"6600"})]}),"\n",(0,s.jsxs)(n.p,{children:["Set the collection server port. Because only one port can be set, the collection servers set in the ",(0,s.jsx)(n.code,{children:"whatap_server_host"})," option must use the same port."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"tcp_so_timeout"})," ",(0,s.jsx)("span",{class:"type",children:"MiliSecond"})]}),"\n",(0,s.jsxs)(n.p,{children:["Default ",(0,s.jsx)(n.code,{children:"60000"})]}),"\n",(0,s.jsx)(n.p,{children:"Set the socket time out of the TCP session that communicates with the collection server."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"tcp_connection_timeout"})," ",(0,s.jsx)("span",{class:"type",children:"MiliSecond"})]}),"\n",(0,s.jsxs)(n.p,{children:["Default ",(0,s.jsx)(n.code,{children:"5000"})]}),"\n",(0,s.jsx)(n.p,{children:"Set the connection time out of the TCP session that communicates with the collection server."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"net_send_max_bytes"})," ",(0,s.jsx)("span",{class:"type",children:"Byte"})]}),"\n",(0,s.jsxs)(n.p,{children:["Default ",(0,s.jsx)(n.code,{children:"5242880"})]}),"\n",(0,s.jsx)(n.p,{children:"Maximum data size in bytes the agent can collect and transfer over the network at a time."}),"\n"]}),"\n"]})]})}function c(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},3419:function(e,n,t){t.r(n),t.d(n,{metadata:()=>s,default:()=>p,frontMatter:()=>c,contentTitle:()=>a,toc:()=>l,assets:()=>d});var s=JSON.parse('{"id":"nodejs/agent-network","title":"Agent communication settings","description":"It describes the connection settings between the agent and the server.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/nodejs/agent-network.mdx","sourceDirName":"nodejs","slug":"/nodejs/agent-network","permalink":"/whatap-docs/en/nodejs/agent-network","draft":false,"unlisted":false,"editUrl":"undefined/docs/nodejs/agent-network.mdx","tags":[],"version":"current","frontMatter":{"id":"agent-network","title":"Agent communication settings","description":"It describes the connection settings between the agent and the server.","keywords":["Node.js","Communication","Network"],"isTranslationMissing":false},"sidebar":"nodejsSidebar","previous":{"title":"Control of agent functions","permalink":"/whatap-docs/en/nodejs/agent-control-function"},"next":{"title":"Agent log configuration","permalink":"/whatap-docs/en/nodejs/agent-log"}}'),r=t(74848),i=t(84429),o=t(61372);let c={id:"agent-network",title:"Agent communication settings",description:"It describes the connection settings between the agent and the server.",keywords:["Node.js","Communication","Network"],isTranslationMissing:!1},a,d={},l=[{value:"Network &amp; security",id:"network--security",level:2},{value:"Collection server address and port",id:"collection-server-address-and-port",level:3},{value:"Communication connectivity and security",id:"communication-connectivity-and-security",level:3},{value:"Agent communication buffer",id:"agent-communication-buffer",level:3},{value:"Reconnecting the agent",id:"reconnecting-the-agent",level:3},{value:"Network configuration options",id:"network-configuration-options",level:2},...o.RM];function h(e){let n={admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,r.jsx)(n.h2,{id:"network--security",children:"Network & security"}),(0,r.jsx)(n.p,{children:"WhaTap transfers monitoring data after TCP connection between the server and the agent."}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://img.whatap.io/media/agent_node/agent_net.png",alt:"WhaTap Agent Network"})}),(0,r.jsx)(n.p,{children:"The agent handles data transfer and server control requests through a single TCP session. The node agent does not use UDP communication. Open the firewall from the node agent to the WhaTap collection server."})]}),"\n",(0,r.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,r.jsx)(n.h3,{id:"collection-server-address-and-port",children:"Collection server address and port"}),(0,r.jsx)(n.p,{children:"WhaTap servers are divided into data region servers, front servers, and Eureka. The data regions include Proxy, Yard, Keeper, etc. Among them, the agent communicates with the proxy server."}),(0,r.jsx)(n.p,{children:"Set the proxy server address of the Whatap server in the Node agent (e.g. whatap.server.host=10.0.3.1/10.0.3.2). When setting the server address, enter as many addresses as the proxy server count. WhaTap server can use one or multiple proxy servers depending on the installation method."}),(0,r.jsx)(n.p,{children:"WhaTap Proxy server listens on the port 6600. If there is no separate setting in the agent, the agent attempts to connect the port 6600."}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ini",metastring:"title='whatap.conf'",children:"whatap.server.port=6600\n"})}),(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"wo proxy servers cannot use different ports. When using multiple proxy servers, the listening port must be the same."})})]}),"\n",(0,r.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,r.jsx)(n.h3,{id:"communication-connectivity-and-security",children:"Communication connectivity and security"}),(0,r.jsx)(n.p,{children:"WhaTap is designed on the premise of collecting monitoring data from public networks. Accordingly, all monitoring data is encrypted and transmitted to the server. When lots of encrypted data is sent, it may cause overhead. WhaTap selectively encrypts data. The communication procedure between agents and the server is as follows:"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Generate and copy the ",(0,r.jsx)(n.strong,{children:"access key"})," from the project creation menu."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"access key"})," includes the private key. Be careful not to be disclosed."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Restart the Node.js application server."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"The WhaTap agent establishes the TCP session with the server."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Request a security key for a new session by encrypting data with the private key for communication included in the ",(0,r.jsx)(n.strong,{children:"access key"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"The server creates a new security key for the session requested by the agent and sends it down to the agent."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"After that, the agent encrypts data such as text and numbers and sends it to the server."}),"\n"]}),"\n"]})]}),"\n",(0,r.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,r.jsx)(n.h3,{id:"agent-communication-buffer",children:"Agent communication buffer"}),(0,r.jsx)(n.p,{children:"The agent may cause failures when TCP connection between servers is delayed. Accordingly, the collected performance data is not transmitted directly to the network."}),(0,r.jsx)(n.p,{children:"The agent has two internal communication buffers for communication."}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ini",children:"net_send_queue1_size=512\nnet_send_queue2_size=1024\n"})}),(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Queue1"})," buffers most of the performance data that is especially sent on a regular basis, and ",(0,r.jsx)(n.strong,{children:"Queue2"})," separately buffers the transaction trace (ProfilePack) and ActiveStackPack."]}),(0,r.jsx)(n.p,{children:"The agent communicates with the server based on queues. When the server is down, part of the memory is consumed by the agent. No more problems occur."})]}),"\n",(0,r.jsxs)(n.section,{className:"remark-sectionize-h3",children:[(0,r.jsx)(n.h3,{id:"reconnecting-the-agent",children:"Reconnecting the agent"}),(0,r.jsx)(n.p,{children:"If the agent is disconnected from the server, it attempts to reconnect 3 times every 5-10 seconds. After that, reconnection attempt is not made."})]}),"\n",(0,r.jsxs)(n.section,{className:"remark-sectionize-h2",children:[(0,r.jsx)(n.h2,{id:"network-configuration-options",children:"Network configuration options"}),(0,r.jsx)(o.Ay,{}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"net_send_queue1_size"})," ",(0,r.jsx)("span",{class:"type",children:"Int"})]}),"\n",(0,r.jsxs)(n.p,{children:["Default ",(0,r.jsx)(n.code,{children:"512"})]}),"\n",(0,r.jsx)(n.p,{children:"It sets the size of the queue to be used for data transmission except for trace data."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"net_send_queue2_size"})," ",(0,r.jsx)("span",{class:"type",children:"Int"})]}),"\n",(0,r.jsxs)(n.p,{children:["Default ",(0,r.jsx)(n.code,{children:"1024"})]}),"\n",(0,r.jsx)(n.p,{children:"It sets the size of the queue to be used for trace data transmission."}),"\n"]}),"\n"]})]})]})}function p(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},84429:function(e,n,t){t.d(n,{R:()=>o,x:()=>c});var s=t(96540);let r={},i=s.createContext(r);function o(e){let n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);